dplyr::mutate(random_fact = as.factor(paste(Replicate, pH, sep = '_')))
Ply_CR_914_Means <- df_total.914 %>%
dplyr::group_by(pCO2) %>%
dplyr::filter(Ply_mL.hr.mmlength > 0) %>% # ommit negative values
dplyr::summarise(
Ply_meanCR = mean(Ply_mL.hr.mmlength),
Ply_sdCR   = sd(Ply_mL.hr.mmlength),
Ply_seCR   = sd(Ply_mL.hr.mmlength) / sqrt(length(Ply_mL.hr.mmlength)),
n = n())
print(Ply_CR_914_Means)
Chaet_CR_914_Means <- df_total.914 %>%
dplyr::group_by(pCO2) %>%
dplyr::filter(Chaet_mL.hr.mmlength > 0) %>% # ommit negative values
dplyr::summarise(
Ply_meanCR = mean(Chaet_mL.hr.mmlength),
Ply_sdCR   = sd(Chaet_mL.hr.mmlength),
Ply_seCR   = sd(Chaet_mL.hr.mmlength) / sqrt(length(Chaet_mL.hr.mmlength)),
n = n())
print(Chaet_CR_914_Means)
Seston_CR_914_Means <- df_total.914 %>%
dplyr::group_by(pCO2) %>%
dplyr::filter(Seston_mL.hr.mmlength > 0) %>% # ommit negative values
dplyr::summarise(
Ply_meanCR = mean(Seston_mL.hr.mmlength),
Ply_sdCR   = sd(Seston_mL.hr.mmlength),
Ply_seCR   = sd(Seston_mL.hr.mmlength) / sqrt(length(Seston_mL.hr.mmlength)),
n = n())
print(Seston_CR_914_Means)
# Data
Ply_FR_914_df      <- df_total.914 %>% filter(Ply_mL.hr.mmlength > 0) %>% mutate(type = 'ply') %>%
dplyr::rename(CR_mL.hr.mmlength = Ply_mL.hr.mmlength) %>% dplyr::select(!c('Chaet_mL.hr.mmlength','Seston_mL.hr.mmlength'))
Seston_FR_914_df   <- df_total.914 %>% filter(Seston_mL.hr.mmlength > 0) %>% mutate(type = 'seston') %>%
dplyr::rename(CR_mL.hr.mmlength = Seston_mL.hr.mmlength) %>% dplyr::select(!c('Chaet_mL.hr.mmlength','Ply_mL.hr.mmlength'))
# Ply - Linear Mixed Effects Model
Ply_LMEmod_0914 <-lme(CR_mL.hr.mmlength ~ pH, random=~1|random_fact, data=Ply_FR_914_df)
# |     &nbsp;      | numDF | denDF | F-value |  p-value  |
# |:---------------:|:-----:|:-----:|:-------:|:---------:|
# | **(Intercept)** |   1   |   8   |  61.6   | 5.011e-05 |
# |     **pH**      |   1   |   6   | 0.1432  |  0.7181   |
pander(anova(Ply_LMEmod_0914), style='rmarkdown') # anova table of lmer
# Chaet - Linear Mixed Effects Model
Chaet_LMEmod_0914 <-lme(CR_mL.hr.mmlength ~ pH, random=~1|random_fact, data=Chaet_FR_914_df)
# |     &nbsp;      | numDF | denDF | F-value |  p-value  |
# |:---------------:|:-----:|:-----:|:-------:|:---------:|
# | **(Intercept)** |   1   |  15   |  64.57  | 8.153e-07 |
# |     **pH**      |   1   |   6   |  4.102  |  0.08924  |
pander(anova(Chaet_LMEmod_0914), style='rmarkdown') # anova table of lmer
# Chaet - Linear Mixed Effects Model
Chaet_LMEmod_0914 <-lme(CR_mL.hr.mmlength ~ pH, random=~1|random_fact, data=Chaet_FR_914_df)
Ply_FR_914_df      <- df_total.914 %>% filter(Ply_mL.hr.mmlength > 0) %>% mutate(type = 'ply') %>%
dplyr::rename(CR_mL.hr.mmlength = Ply_mL.hr.mmlength) %>% dplyr::select(!c('Chaet_mL.hr.mmlength','Seston_mL.hr.mmlength'))
Chaet_FR_914_df    <- df_total.914 %>% filter(Chaet_mL.hr.mmlength > 0) %>% mutate(type = 'chaet') %>%
dplyr::rename(CR_mL.hr.mmlength = Chaet_mL.hr.mmlength) %>% dplyr::select(!c('Ply_mL.hr.mmlength','Seston_mL.hr.mmlength'))
Seston_FR_914_df   <- df_total.914 %>% filter(Seston_mL.hr.mmlength > 0) %>% mutate(type = 'seston') %>%
dplyr::rename(CR_mL.hr.mmlength = Seston_mL.hr.mmlength) %>% dplyr::select(!c('Chaet_mL.hr.mmlength','Ply_mL.hr.mmlength'))
# Chaet - Linear Mixed Effects Model
Chaet_LMEmod_0914 <-lme(CR_mL.hr.mmlength ~ pH, random=~1|random_fact, data=Chaet_FR_914_df)
# |     &nbsp;      | numDF | denDF | F-value |  p-value  |
# |:---------------:|:-----:|:-----:|:-------:|:---------:|
# | **(Intercept)** |   1   |  15   |  64.57  | 8.153e-07 |
# |     **pH**      |   1   |   6   |  4.102  |  0.08924  |
pander(anova(Chaet_LMEmod_0914), style='rmarkdown') # anova table of lmer
# Seston - Linear Mixed Effects Model
Seston_LMEmod_0914 <-lme(CR_mL.hr.mmlength ~ pH, random=~1|random_fact, data=Seston_FR_914_df)
# |     &nbsp;      | numDF | denDF | F-value |  p-value  |
# |:---------------:|:-----:|:-----:|:-------:|:---------:|
# | **(Intercept)** |   1   |  15   |  48.89  | 4.339e-06 |
# |     **pH**      |   1   |   6   |  1.496  |  0.2672   |
pander(anova(Seston_LMEmod_0914), style='rmarkdown') # anova table of lmer
Master_914_plotting      <- rbind(Chaet_FR_914_df, Ply_FR_914_df, Seston_FR_914_df)
Master_914_plotting$pHxfood <- paste(Master_914_plotting$pH, Master_914_plotting$Fed_Unfed, sep = '_')
CR_914_boxplot <- Master_914_plotting %>%
ggplot(aes(pCO2 , CR_mL.hr.mmlength , fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("white","grey50")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=10)) +
stat_summary(fun.y=mean, geom="point", shape=18, size=4, color="black", fill="white") +
ggtitle("Clearance rate, F1 Scallops 20210914") +
facet_wrap(~type)
CR_914_boxplot
V = 25 # V == Volume of the vessel (in mL as 25 ml)
df_total.930<- data.frame() # start dataframe
for (i in 1:nrow(loop_930)) {
dat <- ClearanceRate_Master.930 %>%
dplyr::filter(uniq_Identifier == loop_930[i,]) %>%
dplyr::mutate(Date_pH = paste(Date, pH, sep = '_')) %>%
dplyr::arrange(time)
t_end      <- nrow(dat)
t_end_min1 <- nrow(dat) - 1
blanks <- meanBLANKS.Summary %>% dplyr::filter(Date_pH %in% dat$Date_pH[1])
# ply
A.ply               <- blanks$meanBlank[blanks$Type == 'Ply']
C0_Ply              <- if ( (max(c(dat[1,]$PLY_cell.ml, dat[2,]$PLY_cell.ml))) < (1.25*  (min(c(dat[1,]$PLY_cell.ml, dat[2,]$PLY_cell.ml)))) )  {
C0_Ply <-  (max(c(dat[1,]$PLY_cell.ml, dat[2,]$PLY_cell.ml)))
} else (C0_Ply <-  (min(c(dat[1,]$PLY_cell.ml, dat[2,]$PLY_cell.ml)))) # C0 for the ply
Cend_Ply            <- (min(c(dat[t_end_min1,]$PLY_cell.ml, dat[t_end,]$PLY_cell.ml)))
t0_Ply              <- dat$time[dat$PLY_cell.ml==C0_Ply]
t_Ply               <- max((dat$time[dat$PLY_cell.ml==Cend_Ply]) - t0_Ply) # call max becasue (although unlikely) there can be a case of the same count - calling multiple values
ClearanceRate.Ply   <- (V * ((ln( C0_Ply / Cend_Ply )/(t_Ply/60)) - A.ply)) / (dat$Length_um[1] / 1000) # Tetraselmis cells mL-1  hr-1 mm shell length-1
# chaet
A.chaet             <- blanks$meanBlank[blanks$Type == 'Chaet']
C0_Chaet            <- if ( (max(c(dat[1,]$Chaet_cell.ml, dat[2,]$Chaet_cell.ml))) < (1.25*  (min(c(dat[1,]$Chaet_cell.ml, dat[2,]$Chaet_cell.ml)))) )  {
C0_Chaet <-  (max(c(dat[1,]$Chaet_cell.ml, dat[2,]$Chaet_cell.ml)))
} else (C0_Chaet <-  (min(c(dat[1,]$Chaet_cell.ml, dat[2,]$Chaet_cell.ml)))) # C0 for the ply
Cend_Chaet          <- (min(c(dat[t_end_min1,]$Chaet_cell.ml, dat[t_end,]$Chaet_cell.ml)))
t0_Chaet            <- dat$time[dat$Chaet_cell.ml==C0_Chaet]
t_Chaet             <- max((dat$time[dat$Chaet_cell.ml==Cend_Chaet]) - t0_Chaet) # call max becasue (although unlikely) there can be a case of the same count - calling multiple values
ClearanceRate.Chaet <- (V * ((ln( C0_Chaet / Cend_Chaet )/(t_Chaet/60)) - A.chaet)) / (dat$Length_um[1] / 1000) # Chaetoceros cells mL-1  hr-1 mm shell length-1
# low chl a (seston)
A.Seston             <- blanks$meanBlank[blanks$Type == 'Seston']
C0_Seston            <- if ( (max(c(dat[1,]$Low_chlorophyll_cell.ml, dat[2,]$Low_chlorophyll_cell.ml))) < (1.25*  (min(c(dat[1,]$Low_chlorophyll_cell.ml, dat[2,]$Low_chlorophyll_cell.ml)))) )  {
C0_Seston <-  (max(c(dat[1,]$Low_chlorophyll_cell.ml, dat[2,]$Low_chlorophyll_cell.ml)))
} else (C0_Seston <-  (min(c(dat[1,]$Low_chlorophyll_cell.ml, dat[2,]$Low_chlorophyll_cell.ml)))) # C0 for the ply
Cend_Seston          <- (min(c(dat[t_end_min1,]$Low_chlorophyll_cell.ml, dat[t_end,]$Low_chlorophyll_cell.ml)))
t0_Seston            <- dat$time[dat$Low_chlorophyll_cell.ml==C0_Seston]
t_Seston             <- max((dat$time[dat$Low_chlorophyll_cell.ml==Cend_Seston]) - t0_Seston) # call max becasue (although unlikely) there can be a case of the same count - calling multiple values
ClearanceRate.Seston <- (V * ((ln( C0_Seston / Cend_Seston )/(t_Seston/60)) - A.Seston)) / (dat$Length_um[1] / 1000) # seston cells mL-1  hr-1 mm shell length-1
dat2 <- dat[1,] %>%
dplyr::select(c('Date','pH', 'Replicate', 'Fed_Unfed','Run', 'Plate', 'Number', 'Length_um')) %>%
mutate(Chaet_mL.hr.mmlength = ClearanceRate.Chaet) %>%
mutate(Ply_mL.hr.mmlength = ClearanceRate.Ply) %>%
mutate(Seston_mL.hr.mmlength = ClearanceRate.Seston)
if (nrow(dat2) > 0) {
FeedRate.table           <- data.frame(matrix(nrow = nrow(dat2), ncol = 12)) # create dataframe to save cumunalitively during for loop
colnames(FeedRate.table) <- c('Date', 'ID', 'pH', 'Replicate', 'Fed_Unfed','Run', 'Plate', 'Number', 'Length_um', 'Chaet_mL.hr.mmlength', 'Ply_mL.hr.mmlength', 'Seston_mL.hr.mmlength')
FeedRate.table$Date                       <- dat2$Date
FeedRate.table$ID                         <- loop_930[i,]
FeedRate.table$pH                         <- gsub("_.*", "\\1", FeedRate.table$ID)
FeedRate.table$Replicate                  <- gsub("^(?:[^_]+_){5}([^_]+).*", "\\1", FeedRate.table$ID)
FeedRate.table$Fed_Unfed                  <- dat2$Fed_Unfed
FeedRate.table$Run                        <- gsub("^(?:[^_]+_){3}([^_]+).*", "\\1", FeedRate.table$ID)
FeedRate.table$Plate                      <- dat2$Plate
FeedRate.table$Number                     <- gsub("^(?:[^_]+_){7}([^_]+).*", "\\1", FeedRate.table$ID)
FeedRate.table$Length_um                  <- dat2$Length_um
FeedRate.table$Chaet_mL.hr.mmlength       <- dat2$Chaet_mL.hr.mmlength
FeedRate.table$Ply_mL.hr.mmlength         <- dat2$Ply_mL.hr.mmlength
FeedRate.table$Seston_mL.hr.mmlength      <- dat2$Seston_mL.hr.mmlength
df       <- data.frame(FeedRate.table) # name dataframe for this single row
df_total.930 <- rbind(df_total.930,df) #bind to a cumulative list dataframe
#print(df_total.930) # print to monitor progress
} else {}
}
# ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# clean & view means...       ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
df_total.930 <- df_total.930  %>%
dplyr::mutate(pCO2 = case_when(pH == 8.0 ~ "500 μatm", pH == 7.5 ~ "800 μatm")) %>%
dplyr::mutate(random_fact = as.factor(paste(Replicate, pH, Fed_Unfed, sep = '_')))
Ply_CR_930_Means <- df_total.930 %>%
dplyr::group_by(pCO2, Fed_Unfed) %>%
dplyr::filter(Ply_mL.hr.mmlength > 0) %>% # ommit negative values
dplyr::summarise(
Ply_meanCR = mean(Ply_mL.hr.mmlength),
Ply_sdCR   = sd(Ply_mL.hr.mmlength),
Ply_seCR   = sd(Ply_mL.hr.mmlength) / sqrt(length(Ply_mL.hr.mmlength)),
n = n())
print(Ply_CR_930_Means)
Chaet_CR_930_Means <- df_total.930 %>%
dplyr::group_by(pCO2, Fed_Unfed) %>%
dplyr::filter(Chaet_mL.hr.mmlength > 0) %>% # ommit negative values
dplyr::summarise(
Chaet_meanCR = mean(Chaet_mL.hr.mmlength),
Chaet_sdCR   = sd(Chaet_mL.hr.mmlength),
Chaet_seCR   = sd(Chaet_mL.hr.mmlength) / sqrt(length(Chaet_mL.hr.mmlength)),
n = n())
print(Chaet_CR_930_Means)
Seston_CR_930_Means <- df_total.930 %>%
dplyr::group_by(pCO2, Fed_Unfed) %>%
dplyr::filter(Seston_mL.hr.mmlength > 0) %>% # ommit negative values
dplyr::summarise(
Seston_meanCR = mean(Seston_mL.hr.mmlength),
Seston_sdCR   = sd(Seston_mL.hr.mmlength),
Seston_seCR   = sd(Seston_mL.hr.mmlength) / sqrt(length(Seston_mL.hr.mmlength)),
n = n())
print(Seston_CR_930_Means)
# ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# Linear mixed-effects models ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# Data
Ply_FR_930_df      <- df_total.930 %>% filter(Ply_mL.hr.mmlength > 0) %>% mutate(type = 'ply') %>%
dplyr::rename(CR_mL.hr.mmlength = Ply_mL.hr.mmlength) %>% dplyr::select(!c('Chaet_mL.hr.mmlength','Seston_mL.hr.mmlength'))
Chaet_FR_930_df    <- df_total.930 %>% filter(Chaet_mL.hr.mmlength > 0) %>% mutate(type = 'chaet') %>%
dplyr::rename(CR_mL.hr.mmlength = Chaet_mL.hr.mmlength) %>% dplyr::select(!c('Ply_mL.hr.mmlength','Seston_mL.hr.mmlength'))
Seston_FR_930_df   <- df_total.930 %>% filter(Seston_mL.hr.mmlength > 0) %>% mutate(type = 'seston') %>%
dplyr::rename(CR_mL.hr.mmlength = Seston_mL.hr.mmlength) %>% dplyr::select(!c('Chaet_mL.hr.mmlength','Ply_mL.hr.mmlength'))
# ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# Clearance Rate for loop     ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
V = 25 # V == Volume of the vessel (in mL as 25 ml)
df_total.1026<- data.frame() # start dataframe
for (i in 1:nrow(loop_1026)) {
dat <- ClearanceRate_Master.1026 %>%
dplyr::filter(uniq_Identifier == loop_1026[i,]) %>%
dplyr::mutate(Date_pH = paste(Date, pH, sep = '_')) %>%
dplyr::arrange(time)
t_end      <- nrow(dat)
t_end_min1 <- nrow(dat) - 2
blanks <- meanBLANKS.Summary %>% dplyr::filter(Date_pH %in% dat$Date_pH[1])
# ply
A.ply               <- blanks$meanBlank[blanks$Type == 'Ply']
C0_Ply              <- max(dat$PLY_cell.ml[c(1:2)])
Cend_Ply            <- min(dat$PLY_cell.ml[c(t_end_min1:t_end)])
t0_Ply              <- dat$time[dat$PLY_cell.ml==C0_Ply]
t_Ply               <- max(  (min(dat$time[dat$PLY_cell.ml==Cend_Ply])) - t0_Ply) # call max becasue (although unlikely) there can be a case of the same count - calling multiple values
if (Cend_Ply == 0) {
ClearanceRate.Ply <- (V * ((ln( C0_Ply / 0.0001 )/(t_Ply/60)) - A.ply)) / (dat$Length_um[1] / 1000) # Chaetoceros cells mL-1  hr-1 mm shell length-1
} else ( ClearanceRate.Ply <- (V * ((ln( C0_Ply / Cend_Ply )/(t_Ply/60)) - A.ply)) / (dat$Length_um[1] / 1000))
# chaet
A.chaet             <- blanks$meanBlank[blanks$Type == 'Chaet']
C0_Chaet            <- max(dat$Chaet_cell.ml[c(1:2)])
Cend_Chaet          <- min(dat$Chaet_cell.ml[c(t_end_min1:t_end)])
t0_Chaet            <- dat$time[dat$Chaet_cell.ml==C0_Chaet]
t_Chaet             <- max((dat$time[dat$Chaet_cell.ml==Cend_Chaet]) - t0_Chaet) # call max becasue (although unlikely) there can be a case of the same count - calling multiple values
if (Cend_Chaet == 0) {
ClearanceRate.Chaet <- (V * ((ln( C0_Chaet / 0.0001 )/(t_Chaet/60)) - A.chaet)) / (dat$Length_um[1] / 1000) # Chaetoceros cells mL-1  hr-1 mm shell length-1
} else ( ClearanceRate.Chaet <- (V * ((ln( C0_Chaet / Cend_Chaet )/(t_Chaet/60)) - A.chaet)) / (dat$Length_um[1] / 1000))
# low chl a (seston)
A.Seston             <- blanks$meanBlank[blanks$Type == 'Seston']
C0_Seston            <- max(dat$Low_chlorophyll_cell.ml[c(1:2)])
Cend_Seston          <- min(dat$Low_chlorophyll_cell.ml[c(t_end_min1:t_end)])
t0_Seston            <- dat$time[dat$Low_chlorophyll_cell.ml==C0_Seston]
t_Seston             <- max((dat$time[dat$Low_chlorophyll_cell.ml==Cend_Seston]) - t0_Seston) # call max becasue (although unlikely) there can be a case of the same count - calling multiple values
if (Cend_Seston == 0) {
ClearanceRate.Seston <- (V * ((ln( C0_Seston / 0.0001 )/(t_Seston/60)) - A.Seston)) / (dat$Length_um[1] / 1000) # Chaetoceros cells mL-1  hr-1 mm shell length-1
} else ( ClearanceRate.Seston <- (V * ((ln( C0_Seston / Cend_Seston )/(t_Seston/60)) - A.Seston)) / (dat$Length_um[1] / 1000))
dat2 <- dat[1,] %>%
dplyr::select(c('Date','pH', 'Replicate', 'Fed_Unfed','Run', 'Plate', 'Number', 'Length_um')) %>%
mutate(Chaet_mL.hr.mmlength = ClearanceRate.Chaet) %>%
mutate(Ply_mL.hr.mmlength = ClearanceRate.Ply) %>%
mutate(Seston_mL.hr.mmlength = ClearanceRate.Seston)
if (nrow(dat2) > 0) {
FeedRate.table           <- data.frame(matrix(nrow = nrow(dat2), ncol = 12)) # create dataframe to save cumunalitively during for loop
colnames(FeedRate.table) <- c('Date', 'ID', 'pH', 'Replicate', 'Fed_Unfed','Run', 'Plate', 'Number', 'Length_um', 'Chaet_mL.hr.mmlength', 'Ply_mL.hr.mmlength', 'Seston_mL.hr.mmlength')
FeedRate.table$Date                       <- dat2$Date
FeedRate.table$ID                         <- loop_1026[i,]
FeedRate.table$pH                         <- gsub("_.*", "\\1", FeedRate.table$ID)
FeedRate.table$Replicate                  <- gsub("^(?:[^_]+_){5}([^_]+).*", "\\1", FeedRate.table$ID)
FeedRate.table$Fed_Unfed                  <- dat2$Fed_Unfed
FeedRate.table$Run                        <- gsub("^(?:[^_]+_){3}([^_]+).*", "\\1", FeedRate.table$ID)
FeedRate.table$Plate                      <- dat2$Plate
FeedRate.table$Number                     <- gsub("^(?:[^_]+_){7}([^_]+).*", "\\1", FeedRate.table$ID)
FeedRate.table$Length_um                  <- dat2$Length_um
FeedRate.table$Chaet_mL.hr.mmlength       <- dat2$Chaet_mL.hr.mmlength
FeedRate.table$Ply_mL.hr.mmlength         <- dat2$Ply_mL.hr.mmlength
FeedRate.table$Seston_mL.hr.mmlength      <- dat2$Seston_mL.hr.mmlength
df       <- data.frame(FeedRate.table) # name dataframe for this single row
df_total.1026 <- rbind(df_total.1026,df) #bind to a cumulative list dataframe
#print(df_total.1026) # print to monitor progress
} else {}
}
# ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# clean & view means...       ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
df_total.1026 <- df_total.1026  %>%
dplyr::mutate(pCO2 = case_when(pH == 8.0 ~ "500 μatm", pH == 7.5 ~ "800 μatm")) %>%
dplyr::mutate(random_fact = as.factor(paste(Replicate, pH, Fed_Unfed, sep = '_')))
Ply_CR_1026_Means <- df_total.1026 %>%
dplyr::group_by( Fed_Unfed) %>%
dplyr::filter(Ply_mL.hr.mmlength > 0) %>% # ommit negative values
dplyr::summarise(
Ply_meanCR = mean(Ply_mL.hr.mmlength),
Ply_sdCR   = sd(Ply_mL.hr.mmlength),
Ply_seCR   = sd(Ply_mL.hr.mmlength) / sqrt(length(Ply_mL.hr.mmlength)),
n = n())
print(Ply_CR_1026_Means)
Chaet_CR_1026_Means <- df_total.1026 %>%
dplyr::group_by(Fed_Unfed) %>%
dplyr::filter(Chaet_mL.hr.mmlength > 0) %>% # ommit negative values
dplyr::summarise(
Chaet_meanCR = mean(Chaet_mL.hr.mmlength),
Chaet_sdCR   = sd(Chaet_mL.hr.mmlength),
Chaet_seCR   = sd(Chaet_mL.hr.mmlength) / sqrt(length(Chaet_mL.hr.mmlength)),
n = n())
print(Chaet_CR_1026_Means)
Seston_CR_1026_Means <- df_total.1026 %>%
dplyr::group_by(Fed_Unfed) %>%
dplyr::filter(Seston_mL.hr.mmlength > 0) %>% # ommit negative values
dplyr::summarise(
Seston_meanCR = mean(Seston_mL.hr.mmlength),
Seston_sdCR   = sd(Seston_mL.hr.mmlength),
Seston_seCR   = sd(Seston_mL.hr.mmlength) / sqrt(length(Seston_mL.hr.mmlength)),
n = n())
print(Seston_CR_1026_Means)
# ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# Linear mixed-effects models ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# Data
Ply_FR_1026_df      <- df_total.1026 %>% filter(Ply_mL.hr.mmlength > 0) %>% mutate(type = 'ply') %>%
dplyr::rename(CR_mL.hr.mmlength = Ply_mL.hr.mmlength) %>% dplyr::select(!c('Chaet_mL.hr.mmlength','Seston_mL.hr.mmlength'))
Chaet_FR_1026_df    <- df_total.1026 %>% filter(Chaet_mL.hr.mmlength > 0) %>% mutate(type = 'chaet') %>%
dplyr::rename(CR_mL.hr.mmlength = Chaet_mL.hr.mmlength) %>% dplyr::select(!c('Ply_mL.hr.mmlength','Seston_mL.hr.mmlength'))
Seston_FR_1026_df   <- df_total.1026 %>% filter(Seston_mL.hr.mmlength > 0) %>% mutate(type = 'seston') %>%
dplyr::rename(CR_mL.hr.mmlength = Seston_mL.hr.mmlength) %>% dplyr::select(!c('Chaet_mL.hr.mmlength','Ply_mL.hr.mmlength'))
chaet_clearance_master <- rbind(Chaet_FR_914_df,Chaet_FR_930_df, Chaet_FR_1026_df)
chaet_clearance_master
SumTable_ChaetClear<- chaet_clearance_master[!is.na(chaet_clearance_master$CR_mL.hr.mmlength),] %>%
summarySE(measurevar="CR_mL.hr.mmlength", groupvars=c("Age", "pCO2", "Fed_Unfed"))
chaet_clearance_master[!is.na(chaet_clearance_master$CR_mL.hr.mmlength),]
# Length_um
SumTable_ChaetClear <- chaet_clearance_master[!is.na(chaet_clearance_master$CR_mL.hr.mmlength),] %>%
summarySE(measurevar="CR_mL.hr.mmlength", groupvars=c("Age", "pCO2", "Fed_Unfed"))
# Length_um
SumTable_ChaetClear <- chaet_clearance_master[!is.na(chaet_clearance_master$CR_mL.hr.mmlength),] %>%
summarySE(measurevar="CR_mL.hr.mmlength", groupvars=c("Age", "pCO2", "Fed_Unfed"))
# Length_um
SumTable_ChaetClear <- chaet_clearance_master[!is.na(chaet_clearance_master$CR_mL.hr.mmlength),] %>%
summarySE(measurevar="CR_mL.hr.mmlength", groupvars=c("Date", "pCO2", "Fed_Unfed"))
SumTable_ChaetClear$pCO2 <- factor(SumTable_ChaetClear$pCO2, c("500 µatm","800 µatm"))
# Length_um
SumTable_ChaetClear <- chaet_clearance_master[!is.na(chaet_clearance_master$CR_mL.hr.mmlength),] %>%
summarySE(measurevar="CR_mL.hr.mmlength", groupvars=c("Date", "pCO2", "Fed_Unfed"))
SumTable_ChaetClear$pCO2 <- factor(SumTable_ChaetClear$pCO2, c("500 µatm","800 µatm"))
## Use geom_line and geom_point to plot over time
ChaetClear_time    <- ggplot(data=SumTable_ChaetClear, aes(x=Date, y=CR_mL.hr.mmlength, color=pCO2)) +
geom_line(aes(linetype = factor(Fed_Unfed)), size = 0.5) +
geom_point()+
scale_color_manual(values=c("forestgreen","darkorange2"))+
geom_errorbar(aes(ymin=Length_mm-se, ymax=Length_mm+se), width=.2,
position=position_dodge(.1))+
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size=10)) +
labs(y = expression(mL^{-1}~mm^{-1}%.%hr^{-1})) +
scale_x_continuous(name ="Age (d)") +
labs(title =  "Clearance of Chaetoceros over time..",
y = "Shell length (mm)") +
scale_linetype_manual(values = c("High food" = "solid", "Low food" = "dashed"))  +
theme(legend.position="none") +
# facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
facet_wrap(~pCO2)
ChaetClear_time
## Use geom_line and geom_point to plot over time
ChaetClear_time    <- ggplot(data=SumTable_ChaetClear, aes(x=Date, y=CR_mL.hr.mmlength, color=pCO2)) +
geom_line(aes(linetype = factor(Fed_Unfed)), size = 0.5) +
geom_point()+
scale_color_manual(values=c("forestgreen","darkorange2"))+
geom_errorbar(aes(ymin=CR_mL.hr.mmlength-se, ymax=CR_mL.hr.mmlength+se), width=.2,
position=position_dodge(.1))+
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size=10)) +
labs(y = expression(mL^{-1}~mm^{-1}%.%hr^{-1})) +
scale_x_continuous(name ="Age (d)") +
labs(title =  "Clearance of Chaetoceros over time..",
y = "Shell length (mm)") +
scale_linetype_manual(values = c("High food" = "solid", "Low food" = "dashed"))  +
theme(legend.position="none") +
# facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
facet_wrap(~pCO2)
ChaetClear_time
ggplot(data=SumTable_ChaetClear, aes(x=Date, y=CR_mL.hr.mmlength, color=pCO2)) +
geom_line(aes(linetype = factor(Fed_Unfed)), size = 0.5) +
geom_point()+
scale_color_manual(values=c("forestgreen","darkorange2"))+
geom_errorbar(aes(ymin=CR_mL.hr.mmlength-se, ymax=CR_mL.hr.mmlength+se), width=.2,
position=position_dodge(.1))+
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size=10)) +
labs(y = expression(mL^{-1}~mm^{-1}%.%hr^{-1})) +
scale_x_continuous(name ="Age (d)")
SumTable_ChaetClear$pCO2
# Length_um
SumTable_ChaetClear <- chaet_clearance_master[!is.na(chaet_clearance_master$CR_mL.hr.mmlength),] %>%
summarySE(measurevar="CR_mL.hr.mmlength", groupvars=c("Date", "pCO2", "Fed_Unfed"))
SumTable_ChaetClear$pCO2 <- factor(SumTable_ChaetClear$pCO2, c("500 µatm","800 µatm"))
SumTable_ChaetClear$pCO2
# Length_um
SumTable_ChaetClear <- chaet_clearance_master[!is.na(chaet_clearance_master$CR_mL.hr.mmlength),] %>%
summarySE(measurevar="CR_mL.hr.mmlength", groupvars=c("Date", "pCO2", "Fed_Unfed"))
SumTable_ChaetClear$pCO2
SumTable_ChaetClear$pCO2 <- factor(SumTable_ChaetClear$pCO2, c("500 μatm","800 μatm"))
SumTable_ChaetClear$pCO2
## Use geom_line and geom_point to plot over time
ChaetClear_time    <- ggplot(data=SumTable_ChaetClear, aes(x=Date, y=CR_mL.hr.mmlength, color=pCO2)) +
geom_line(aes(linetype = factor(Fed_Unfed)), size = 0.5) +
geom_point()+
scale_color_manual(values=c("forestgreen","darkorange2"))+
geom_errorbar(aes(ymin=CR_mL.hr.mmlength-se, ymax=CR_mL.hr.mmlength+se), width=.2,
position=position_dodge(.1))+
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size=10)) +
labs(y = expression(mL^{-1}~mm^{-1}%.%hr^{-1})) +
scale_x_continuous(name ="Age (d)") +
labs(title =  "Clearance of Chaetoceros over time..",
y = "Shell length (mm)") +
scale_linetype_manual(values = c("High food" = "solid", "Low food" = "dashed"))  +
theme(legend.position="none") +
# facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
facet_wrap(~pCO2)
ChaetClear_time
ggplot(data=SumTable_ChaetClear, aes(x=Date, y=CR_mL.hr.mmlength, color=pCO2)) +
geom_line(aes(linetype = factor(Fed_Unfed)), size = 0.5) +
geom_point()+
scale_color_manual(values=c("forestgreen","darkorange2"))+
geom_errorbar(aes(ymin=CR_mL.hr.mmlength-se, ymax=CR_mL.hr.mmlength+se), width=.2,
position=position_dodge(.1))+
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size=10)) +
labs(y = expression(mL^{-1}~mm^{-1}%.%hr^{-1}))
SumTable_ChaetClear
## Use geom_line and geom_point to plot over time
ChaetClear_time    <- ggplot(data=SumTable_ChaetClear, aes(x=Date, y=CR_mL.hr.mmlength, color=pCO2)) +
geom_line(aes(linetype = factor(Fed_Unfed)), size = 0.5) +
geom_point()+
scale_color_manual(values=c("forestgreen","darkorange2"))+
geom_errorbar(aes(ymin=CR_mL.hr.mmlength-se, ymax=CR_mL.hr.mmlength+se), width=.2,
position=position_dodge(.1))+
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size=10)) +
labs(y = expression(mL^{-1}~mm^{-1}%.%hr^{-1})) +
scale_x_continuous(name ="Age (d)") +
labs(title =  "Clearance of Chaetoceros over time..",
y = "Shell length (mm)") +
scale_linetype_manual(values = c("fed" = "solid", "unfed" = "dashed"))  +
theme(legend.position="none") +
# facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
facet_wrap(~pCO2)
ChaetClear_time
## Use geom_line and geom_point to plot over time
ChaetClear_time    <- ggplot(data=SumTable_ChaetClear, aes(x=Date, y=CR_mL.hr.mmlength, color=pCO2)) +
geom_line(aes(linetype = factor(Fed_Unfed)), size = 0.5) +
geom_point()+
scale_color_manual(values=c("forestgreen","darkorange2"))+
geom_errorbar(aes(ymin=CR_mL.hr.mmlength-se, ymax=CR_mL.hr.mmlength+se), width=.2,
position=position_dodge(.1))+
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size=10)) +
labs(y = expression(mL^{-1}~mm^{-1}%.%hr^{-1})) +
scale_x_continuous(name ="Age (d)") +
labs(title =  "Clearance of Chaetocerous over time..",
y = "Shell length (mm)") +
scale_linetype_manual(values = c("fed" = "solid", "unfed" = "dashed"))  +
theme(legend.position="none") +
# facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
facet_wrap(~pCO2)
pdf(paste0("C:/Users/samjg/Documents/Github_repositories/Airradians_OA-foodsupply/RAnalysis/Output/ClearanceRates/Chaet_ClearanceRate_length.pdf"), width = 8, height = 6)
ChaetClear_time
dev.off()
# Length_um
SumTable_ChaetClear <- chaet_clearance_master[!is.na(chaet_clearance_master$CR_mL.hr.mmlength),] %>%
summarySE(measurevar="CR_mL.hr.mmlength", groupvars=c("Date", "pCO2", "Fed_Unfed")) %>%
dplyr::mutate(Age = case_when(Date == '9/14/2021' ~ 50, Date == '9/30/2021' ~ 66, Date == '10/26/2021' ~ 92))
SumTable_ChaetClear$pCO2 <- factor(SumTable_ChaetClear$pCO2, c("500 μatm","800 μatm"))
## Use geom_line and geom_point to plot over time
ChaetClear_time    <- ggplot(data=SumTable_ChaetClear, aes(x=Age, y=CR_mL.hr.mmlength, color=pCO2)) +
geom_line(aes(linetype = factor(Fed_Unfed)), size = 0.5) +
geom_point()+
scale_color_manual(values=c("forestgreen","darkorange2"))+
geom_errorbar(aes(ymin=CR_mL.hr.mmlength-se, ymax=CR_mL.hr.mmlength+se), width=.2,
position=position_dodge(.1))+
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size=10)) +
labs(y = expression(mL^{-1}~mm^{-1}%.%hr^{-1})) +
scale_x_continuous(name ="Age (d)") +
labs(title =  "Clearance of Chaetocerous over time..",
y = "Shell length (mm)") +
scale_linetype_manual(values = c("fed" = "solid", "unfed" = "dashed"))  +
theme(legend.position="none") +
# facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
facet_wrap(~pCO2)
ChaetClear_time
# Length_um
SumTable_ChaetClear <- chaet_clearance_master[!is.na(chaet_clearance_master$CR_mL.hr.mmlength),] %>%
summarySE(measurevar="CR_mL.hr.mmlength", groupvars=c("Date", "pCO2", "Fed_Unfed")) %>%
dplyr::mutate(Age = case_when(Date == '9/14/2021' ~ 50, Date == '9/30/2021' ~ 66, Date == '10/26/2021' ~ 92))
SumTable_ChaetClear
# Length_um
SumTable_ChaetClear <- chaet_clearance_master[!is.na(chaet_clearance_master$CR_mL.hr.mmlength),] %>%
summarySE(measurevar="CR_mL.hr.mmlength", groupvars=c("Date", "pCO2", "Fed_Unfed")) %>%
dplyr::mutate(Age = case_when(Date == '20210914' ~ 50, Date == '20210930' ~ 66, Date == '20211026' ~ 92))
SumTable_ChaetClear$pCO2 <- factor(SumTable_ChaetClear$pCO2, c("500 μatm","800 μatm"))
## Use geom_line and geom_point to plot over time
ChaetClear_time    <- ggplot(data=SumTable_ChaetClear, aes(x=Age, y=CR_mL.hr.mmlength, color=pCO2)) +
geom_line(aes(linetype = factor(Fed_Unfed)), size = 0.5) +
geom_point()+
scale_color_manual(values=c("forestgreen","darkorange2"))+
geom_errorbar(aes(ymin=CR_mL.hr.mmlength-se, ymax=CR_mL.hr.mmlength+se), width=.2,
position=position_dodge(.1))+
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size=10)) +
labs(y = expression(mL^{-1}~mm^{-1}%.%hr^{-1})) +
scale_x_continuous(name ="Age (d)") +
labs(title =  "Clearance of Chaetocerous over time..",
y = "Shell length (mm)") +
scale_linetype_manual(values = c("fed" = "solid", "unfed" = "dashed"))  +
theme(legend.position="none") +
# facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
facet_wrap(~pCO2)
ChaetClear_time
pdf(paste0("C:/Users/samjg/Documents/Github_repositories/Airradians_OA-foodsupply/RAnalysis/Output/ClearanceRates/Chaet_ClearanceRate_length.pdf"), width = 8, height = 6)
ChaetClear_time
dev.off()
