data_64 %>% dplyr::group_by(Fed_Unfed) %>% dplyr::summarise(mean = mean(Length))
data_64_length <- length %>%
filter(Age_DPF=="64") %>%
dplyr::mutate(pCO2 = case_when(pH == 8 ~ "500 μatm",  pH == 7.5 ~ "800 μatm")) %>%
dplyr::mutate(Fed_Unfed = case_when(Fed_Unfed == "fed" ~ "High food",  Fed_Unfed == "unfed" ~ "Low food"))
data_64_length
data_51
data_64$RFactor <- as.factor(paste(data_64$Replicate, data_64$pH, sep = '_'))
data_64_length$RFactor <- as.factor(paste(data_64_length$Replicate, data_64_length$pH, sep = '_'))
data_64_length$RFactor
# using lmer
ShellLengthMod_D64 <- lmer(Length_um ~ pCO2 + (1|RFactor),
data=data_64_length,
REML=TRUE)
pander(anova(ShellLengthMod_D64), style='rmarkdown')
check_model(ShellLengthMod_D64) # observe the diagnostics of the model
shapiro.test(residuals(ShellLengthMod_D64)) # non normal
leveneTest(residuals(ShellLengthMod_D64) ~ data_64_length$pCO2)
# using lme
ShellLengthMod_D64 = lme(Length_um ~ pCO2, random=~1|RFactor,
data=data_64_length,
method="REML")
# using lmer
ShellLengthMod_D64 <- lmer(Length_um ~ pCO2*Fed_Unfed + (1|RFactor),
data=data_64_length,
REML=TRUE)
pander(anova(ShellLengthMod_D64), style='rmarkdown')
check_model(ShellLengthMod_D64) # observe the diagnostics of the model
shapiro.test(residuals(ShellLengthMod_D64)) # non normal - 2.2e-16
leveneTest(residuals(ShellLengthMod_D64) ~ data_64_length$pCO2) # good 0.7793
leveneTest(residuals(ShellLengthMod_D64) ~ data_64_length$Fed_Unfed) # good  0.627
leveneTest(residuals(ShellLengthMod_D64) ~ data_64_length$Fed_Unfed) # good  0.627
leveneTest(residuals(ShellLengthMod_D64) ~ data_64_length$pCO2) # good  0.627
leveneTest(residuals(ShellLengthMod_D64) ~ data_64_length$Fed_Unfed) # good  0.627
leveneTest(residuals(ShellLengthMod_D64) ~ data_64_length$pCO2*data_64_length$Fed_Unfed) # good  0.627
leveneTest(residuals(ShellLengthMod_D64) ~ data_64_length$pCO2+data_64_length$Fed_Unfed) # good  0.627
leveneTest(residuals(ShellLengthMod_D64) ~ data_64_length$pCO2*data_64_length$Fed_Unfed) # good  0.627
leveneTest(residuals(ShellLengthMod_D64) ~ data_64_length$pCO2) # good  0.627
# using lme
ShellLengthMod_D64 = lme(Length_um ~ pCO2*Fed_Unfed, random=~1|RFactor,
data=data_64_length,
method="REML")
pander(Anova(ShellLengthMod_D64), style='rmarkdown')
check_model(ShellLengthMod_D64) # observe the diagnostics of the model
shapiro.test(residuals(ShellLengthMod_D64)) # non normal
leveneTest(residuals(ShellLengthMod_D64) ~ data_64$pCO2)
leveneTest(residuals(ShellLengthMod_D64) ~ data_64_length$pCO2)
# using lme
ShellLengthMod_D64 = lme(Length_um ~ pCO2*Fed_Unfed, random=~1|RFactor,
data=data_64_length,
method="REML")
pander(Anova(ShellLengthMod_D64), style='rmarkdown') # **Fed_Unfed**    |  643.8  | 1  | 5.012e-142 |
# using lmer
SurvivalMod_D64 <- lmer(Survival ~ pCO2*Fed_Unfed + (1|RFactor),
data=data_64,
REML=TRUE)
pander(anova(SurvivalMod_D64), style='rmarkdown') #  **Fed_Unfed**    | 1.198e-111 |
# using lmer
SurvivalMod_D64 <- lmer(Survival ~ pCO2*Fed_Unfed + (1|RFactor),
data=data_64,
REML=TRUE)
data_64
data_64$RFactor <- as.factor(paste(data_64$Rep, data_64$pH, sep = '_'))
# using lmer
SurvivalMod_D64 <- lmer(Survival ~ pCO2*Fed_Unfed + (1|RFactor),
data=data_64,
REML=TRUE)
pander(anova(SurvivalMod_D64), style='rmarkdown') #  **Fed_Unfed**    | 1.198e-111 |
check_model(ShellLengthMod_D64) # observe the diagnosticsdata_64_length$pCO2 of the model
data_64
ShellLengthMod_D64 <- aov(lm(Length_um~pCO2*Fed_Unfed+Replicate, data = data_64) )
# using lmer
SurvivalMod_D64 <- lmer(Survival ~ pCO2*Fed_Unfed + (1|RFactor),
data=data_64,
REML=TRUE)
# using lme
ShellLengthMod_D64 = lme(Survival ~ pCO2*Fed_Unfed, random=~1|RFactor,
data=data_64,
method="REML")
pander(Anova(ShellLengthMod_D64), style='rmarkdown') # **Fed_Unfed**    |  643.8  | 1  | 5.012e-142 |
shapiro.test(residuals(ShellLengthMod_D64)) # non normal - 2.2e-16
leveneTest(residuals(ShellLengthMod_D64) ~ data_64_length$pCO2) # good  0.627
leveneTest(residuals(ShellLengthMod_D64) ~ data_64$pCO2) # good  0.627
pander(Anova(ShellLengthMod_D64), style='rmarkdown') # **Fed_Unfed**    |  643.8  | 1  | 5.012e-142 |
check_model(ShellLengthMod_D64) # observe the diagnosticsdata_64_length$pCO2 of the model
shapiro.test(residuals(ShellLengthMod_D64)) # non normal - 2.2e-16
leveneTest(residuals(ShellLengthMod_D64) ~ data_64$pCO2) # good  0.627
Day64_Survival_BoxPlot<-ggplot(data=data_64, aes(x=trt, y=Survival, fill=trt)) +
geom_boxplot()+scale_fill_manual(values=c("orange1","darkorange2","springgreen2","forestgreen"))+
theme_bw() +  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), legend.title = element_blank())+
#ggtitle("Age = 8 days")+
scale_y_continuous(name ="Length (µm)")+
scale_x_discrete(name ="Treatment")
Day64_Survival_BoxPlot
ShellLengthMod_D64 <- aov(lm(Length_um~pCO2*Fed_Unfed+Replicate, data = data_64) )
pander(summary(ShellLengthMod_D64), style='rmarkdown')
Day64_Length_BoxPlot<-ggplot(data=data_64, aes(x=pCO2, y=Length_um, fill=pCO2)) +
geom_boxplot()+scale_fill_manual(values=c("darkorange2","forestgreen"))+
theme_bw() +  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), legend.title = element_blank())+
#ggtitle("Age = 8 days")+
scale_y_continuous(name ="Length (µm)")+
scale_x_discrete(name ="Treatment") +
facet_wrap(~Fed_Unfed)
Day64_Length_BoxPlot
Day64_Length_BoxPlot<-ggplot(data=data_64_length, aes(x=pCO2, y=Length_um, fill=pCO2)) +
geom_boxplot()+scale_fill_manual(values=c("darkorange2","forestgreen"))+
theme_bw() +  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), legend.title = element_blank())+
#ggtitle("Age = 8 days")+
scale_y_continuous(name ="Length (µm)")+
scale_x_discrete(name ="Treatment") +
facet_wrap(~Fed_Unfed)
Day64_Length_BoxPlot
SurvivaleMod_D64 <- aov(lm(Survival~pCO2*Fed_Unfed, data = data_64) )
pander(summary(SurvivaleMod_D64), style='rmarkdown')
check_model(SurvivaleMod_D64) # observe the diagnostics of the model
shapiro.test(residuals(SurvivaleMod_D64)) # non normal
leveneTest(SurvivaleMod_D64) # good
data_64 %>% dplyr::group_by(pCO2) %>% dplyr::summarise(mean = mean(Survival))
data_64 %>% dplyr::group_by(Fed_Unfed) %>% dplyr::summarise(mean = mean(Survival), sd = sd(Survival))
data_64 %>% dplyr::group_by(trt) %>% dplyr::summarise(mean = mean(Survival))
Length_64dpf <- ggplot(data_64, aes(x =pCO2, Length_um,  fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("grey50","white")) +
geom_point(shape = 21, size = 1, position = position_jitterdodge(jitter.width = 0.4)) +
theme_classic() +
#ylim(2000, 4000) +
scale_x_discrete(labels=c('~500 μatm', '~800 μatm')) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
stat_summary(fun.y=mean, geom="point", shape=18, size=4) +
labs(title = "Shell Length; F1 Scallops (juveniles) 66 days post-fertilization",
y = expression(Shell~length~"("~μm~")"),
x = expression(italic(p)*CO[2]~Treatment~"("~μ*atm~")")) +
facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
Survival_64DPF <- ggplot(data_64, aes(x =pCO2, (Survival*100) , fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("grey50","white")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
#ylim(2, 4.5) +
scale_x_discrete(labels=c('~500 μatm', '~800 μatm')) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
stat_summary(fun.y=mean, geom="point", shape=18, size=4) +
labs(title = "Perent survival; F1 Scallops (juveniles) 66 days post-fertilization",
y = expression(Survival~"(%)"),
x = expression(italic(p)*CO[2]~Treatment~"("~μ*atm~")")) +
facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
Survival_64DPF
Length_64dpf
Length_64dpf <- ggplot(data_64_length, aes(x =pCO2, Length_um,  fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("grey50","white")) +
geom_point(shape = 21, size = 1, position = position_jitterdodge(jitter.width = 0.4)) +
theme_classic() +
#ylim(2000, 4000) +
scale_x_discrete(labels=c('~500 μatm', '~800 μatm')) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
stat_summary(fun.y=mean, geom="point", shape=18, size=4) +
labs(title = "Shell Length; F1 Scallops (juveniles) 66 days post-fertilization",
y = expression(Shell~length~"("~μm~")"),
x = expression(italic(p)*CO[2]~Treatment~"("~μ*atm~")")) +
facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
Length_64dpf
Survival_64DPF
data_64
data_64$trt
data_64$pCO2
as.factor(gsub("^(?:[^_]+_){1}([^_]+).*", "\\1", data_64$trt))
gsub("^(?:[^_]+_){1}([^_]+).*", "\\1", data_64$trt)
data_64$pCO2 <-  as.factor(gsub("^(?:[^_]+_){1}([^_]+).*", "\\1", data_64$trt))
levels(data_64$pCO2)
levels(data_64$pCO2) <- c("800 μatm", "500 μatm")
data_64 %>% dplyr::group_by(Fed_Unfed) %>% dplyr::summarise(mean = mean(Length))
data_64$RFactor <- as.factor(paste(data_64$Rep, data_64$pH, sep = '_'))
data_64
# using lmer
SurvivalMod_D64 <- lmer(Survival ~ pCO2*Fed_Unfed + (1|RFactor),
data=data_64,
REML=TRUE)
pander(anova(SurvivalMod_D64), style='rmarkdown') #  **Fed_Unfed**    | 1.198e-111 |
check_model(ShellLengthMod_D64) # observe the diagnosticsdata_64_length$pCO2 of the model
shapiro.test(residuals(ShellLengthMod_D64)) # non normal - 2.2e-16
pander(anova(SurvivalMod_D64), style='rmarkdown') #  **Fed_Unfed**    | 1.198e-111 |
# using lmer
SurvivalMod_D64 <- lmer(Survival ~ pCO2*Fed_Unfed + (1|RFactor),
data=data_64,
REML=TRUE)
pander(anova(SurvivalMod_D64), style='rmarkdown') #  **Fed_Unfed**    | 1.198e-111 |
# using lme
ShellLengthMod_D64 = lme(Length_um ~ pCO2*Fed_Unfed, random=~1|RFactor,
data=data_64_length,
method="REML")
pander(Anova(ShellLengthMod_D64), style='rmarkdown') # **Fed_Unfed**    |  643.8  | 1  | 5.012e-142 |
# using lmer
ShellLengthMod_D64 <- lmer(Length_um ~ pCO2*Fed_Unfed + (1|RFactor),
data=data_64_length,
REML=TRUE)
pander(anova(ShellLengthMod_D64), style='rmarkdown') #  **Fed_Unfed**    | 1.198e-111 |
# using lmer
SurvivalMod_D64 <- lmer(Survival ~ pCO2*Fed_Unfed + (1|RFactor),
data=data_64,
REML=TRUE)
pander(anova(SurvivalMod_D64), style='rmarkdown') #  **Fed_Unfed**    | 1.198e-111 |
# using lme
ShellLengthMod_D64 = lme(Survival ~ pCO2*Fed_Unfed, random=~1|RFactor,
data=data_64,
method="REML")
pander(Anova(ShellLengthMod_D64), style='rmarkdown') # **pCO2**      | 2.791  | 1  |  0.09481
pander(anova(SurvivalMod_D64), style='rmarkdown') #  **Fed_Unfed**    | 1.198e-111 |
#pdf(paste0("C:/Users/samjg/Documents/Github_repositories/Airradians_OA/RAnalysis/Output/Survival_size/20210930_shell_length.pdf"))
Length_64dpf
# pdf(paste0("C:/Users/samjg/Documents/Github_repositories/Airradians_OA/RAnalysis/Output/Survival_size/20210930_survival.pdf"))
Survival_64DPF
Survival_64DPF <- ggplot(data_64, aes(x =pCO2, (Survival*100) , fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("grey50","white")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
#ylim(2, 4.5) +
scale_x_discrete(labels=c('~500 μatm', '~800 μatm')) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
stat_summary(fun.y=mean, geom="point", shape=18, size=4) +
labs(title = "Perent survival; F1 Scallops (juveniles) 64 days post-fertilization",
y = expression(Survival~"(%)"),
x = expression(italic(p)*CO[2]~Treatment~"("~μ*atm~")")) +
facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
Survival_64DPF
pdf(paste0("C:/Users/samjg/Documents/Github_repositories/Airradians_OA/RAnalysis/Output/Survival_size/20210930_survival.pdf"))
Survival_64DPF
dev.off()
#pdf(paste0("C:/Users/samjg/Documents/Github_repositories/Airradians_OA/RAnalysis/Output/Survival_size/20210930_shell_length.pdf"))
Length_64dpf
pdf(paste0("C:/Users/samjg/Documents/Github_repositories/Airradians_OA/RAnalysis/Output/Survival_size/20210930_shell_length.pdf"))
Length_64dpf
dev.off()
data_92<- df%>%
filter(Age_DPF=="92")
data_92<- survival_juvenile %>%
filter(Age_DPF=="92")
data_92_length <- length %>%
filter(Age_DPF=="92") %>%
dplyr::mutate(pCO2 = case_when(pH == 8 ~ "500 μatm",  pH == 7.5 ~ "800 μatm")) %>%
dplyr::mutate(Fed_Unfed = case_when(Fed_Unfed == "fed" ~ "High food",  Fed_Unfed == "unfed" ~ "Low food"))
data_92<- survival_juvenile %>%
filter(Age_DPF=="92")
data_92$Fed_Unfed <- as.factor(gsub("^(?:[^_]+_){2}([^_]+).*", "\\1", data_92$trt))
levels(data_92$Fed_Unfed) <- c("High food", "Low food")
data_92$pCO2 <-  as.factor(gsub("^(?:[^_]+_){1}([^_]+).*", "\\1", data_92$trt))
levels(data_92$pCO2) <- c("800 μatm", "500 μatm")
data_92 %>% dplyr::group_by(Fed_Unfed) %>% dplyr::summarise(mean = mean(Length))
data_92_length <- length %>%
filter(Age_DPF=="92") %>%
dplyr::mutate(pCO2 = case_when(pH == 8 ~ "500 μatm",  pH == 7.5 ~ "800 μatm")) %>%
dplyr::mutate(Fed_Unfed = case_when(Fed_Unfed == "fed" ~ "High food",  Fed_Unfed == "unfed" ~ "Low food"))
data_90<- survival_juvenile %>%
filter(Age_DPF=="92")
data_92$Fed_Unfed <- as.factor(gsub("^(?:[^_]+_){2}([^_]+).*", "\\1", data_92$trt))
data_90<- survival_juvenile %>%
filter(Age_DPF=="92")
data_90$Fed_Unfed <- as.factor(gsub("^(?:[^_]+_){2}([^_]+).*", "\\1", data_90$trt))
levels(data_90$Fed_Unfed) <- c("High food", "Low food")
data_90$pCO2 <-  as.factor(gsub("^(?:[^_]+_){1}([^_]+).*", "\\1", data_90$trt))
levels(data_90$pCO2) <- c("800 μatm", "500 μatm")
data_90 %>% dplyr::group_by(Fed_Unfed) %>% dplyr::summarise(mean = mean(Length))
data_90_length <- length %>%
filter(Age_DPF=="92") %>%
dplyr::mutate(pCO2 = case_when(pH == 8 ~ "500 μatm",  pH == 7.5 ~ "800 μatm")) %>%
dplyr::mutate(Fed_Unfed = case_when(Fed_Unfed == "fed" ~ "High food",  Fed_Unfed == "unfed" ~ "Low food"))
# using lmer
ShellLengthMod_D90 <- lmer(Length_um ~ pCO2*Fed_Unfed + (1|RFactor),
data=data_90_length,
REML=TRUE)
data_90_length
data_90$RFactor <- as.factor(paste(data_90$Replicate, data_90$pH, sep = '_'))
data_90$RFactor
data_90$RFactor <- as.factor(paste(data_90$Rep, data_90$pH, sep = '_'))
data_90$RFactor
data_90_length$RFactor <- as.factor(paste(data_90_length$Replicate, data_90_length$pH, sep = '_'))
data_90_length$RFactor
# using lmer
ShellLengthMod_D90 <- lmer(Length_um ~ pCO2*Fed_Unfed + (1|RFactor),
data=data_90_length,
REML=TRUE)
pander(anova(ShellLengthMod_D90), style='rmarkdown') #  **Fed_Unfed**    | 1.198e-111 |
check_model(ShellLengthMod_D90) # observe the diagnosticsdata_90_length$pCO2 of the model
check_model(ShellLengthMod_D90) # observe the diagnosticsdata_90_length$pCO2 of the model
shapiro.test(residuals(ShellLengthMod_D90)) # non normal - 2.2e-16
leveneTest(residuals(ShellLengthMod_D90) ~ data_90_length$pCO2) # good  0.627
# using lme
ShellLengthMod_D90 = lme(Length_um ~ pCO2*Fed_Unfed, random=~1|RFactor,
data=data_90_length,
method="REML")
pander(Anova(ShellLengthMod_D90), style='rmarkdown') # **Fed_Unfed**    |  903.8  | 1  | 5.012e-142 |
# using lmer
SurvivalMod_D90 <- lmer(Survival ~ pCO2*Fed_Unfed + (1|RFactor),
data=data_90,
REML=TRUE)
pander(anova(SurvivalMod_D90), style='rmarkdown') #  no sig effects
check_model(ShellLengthMod_D90) # observe the diagnostics data_90_length$pCO2 of the model
# check_model(ShellLengthMod_D90) # observe the diagnostics data_90_length$pCO2 of the model
shapiro.test(residuals(ShellLengthMod_D90)) # non normal - 2.2e-16
leveneTest(residuals(ShellLengthMod_D90) ~ data_90$pCO2) # good  0.627
leveneTest(residuals(ShellLengthMod_D90) ~ data_90$pCO2) # good  0.627
# using lmer
SurvivalMod_D90 <- lmer(Survival ~ pCO2*Fed_Unfed + (1|RFactor),
data=data_90,
REML=TRUE)
# using lme
ShellLengthMod_D90 = lme(Survival ~ pCO2*Fed_Unfed, random=~1|RFactor,
data=data_90,
method="REML")
pander(Anova(ShellLengthMod_D90), style='rmarkdown') # **pCO2**      | 2.791  | 1  |  0.09481
# using lme
ShellLengthMod_D90 = lme(Survival ~ pCO2*Fed_Unfed, random=~1|RFactor,
data=data_90,
method="REML")
pander(Anova(ShellLengthMod_D90), style='rmarkdown') #  **Fed_Unfed**    |  236.3  | 1  | 2.526e-53  |
check_model(ShellLengthMod_D90) # observe the diagnosticsdata_90_length$pCO2 of the model
shapiro.test(residuals(ShellLengthMod_D90)) # non normal - 0.002907
leveneTest(residuals(ShellLengthMod_D90) ~ data_90$pCO2) # good  0.07483 .
Length_92dpf <- ggplot(data_90, aes(x =pCO2, Length_um,  fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("grey50","white")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
#ylim(2000, 4000) +
scale_x_discrete(labels=c('~500 μatm', '~800 μatm')) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
stat_summary(fun.y=mean, geom="point", shape=18, size=4) +
labs(title = "Shell Length; F1 Scallops (juveniles) 92 days post-fertilization",
y = expression(Shell~length~"("~μm~")"),
x = expression(italic(p)*CO[2]~Treatment~"("~μ*atm~")")) +
facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
Length_92dpf
Length_92dpf <- ggplot(data_90_length, aes(x =pCO2, Length_um,  fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("grey50","white")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
#ylim(2000, 4000) +
scale_x_discrete(labels=c('~500 μatm', '~800 μatm')) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
stat_summary(fun.y=mean, geom="point", shape=18, size=4) +
labs(title = "Shell Length; F1 Scallops (juveniles) 92 days post-fertilization",
y = expression(Shell~length~"("~μm~")"),
x = expression(italic(p)*CO[2]~Treatment~"("~μ*atm~")")) +
facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
Length_92dpf
Survival_92DPF <- ggplot(data_92, aes(x =pCO2, (Survival*100) , fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("grey50","white")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
#ylim(2, 4.5) +
scale_x_discrete(labels=c('~500 μatm', '~800 μatm')) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
stat_summary(fun.y=mean, geom="point", shape=18, size=4) +
labs(title = "Perent survival; F1 Scallops (juveniles) 92 days post-fertilization",
y = expression(Survival~"(%)"),
x = expression(italic(p)*CO[2]~Treatment~"("~μ*atm~")")) +
facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
Survival_92DPF
data_92
data_90$Fed_Unfed <- as.factor(gsub("^(?:[^_]+_){2}([^_]+).*", "\\1", data_90$trt))
levels(data_90$Fed_Unfed) <- c("High food", "Low food")
data_90$Fed_Unfed
Survival_92DPF <- ggplot(data_92, aes(x =pCO2, (Survival*100) , fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("grey50","white")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
#ylim(2, 4.5) +
scale_x_discrete(labels=c('~500 μatm', '~800 μatm')) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
stat_summary(fun.y=mean, geom="point", shape=18, size=4) +
labs(title = "Perent survival; F1 Scallops (juveniles) 92 days post-fertilization",
y = expression(Survival~"(%)"),
x = expression(italic(p)*CO[2]~Treatment~"("~μ*atm~")")) +
facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
Survival_92DPF
Survival_92DPF <- ggplot(data_90, aes(x =pCO2, (Survival*100) , fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("grey50","white")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
#ylim(2, 4.5) +
scale_x_discrete(labels=c('~500 μatm', '~800 μatm')) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
stat_summary(fun.y=mean, geom="point", shape=18, size=4) +
labs(title = "Perent survival; F1 Scallops (juveniles) 92 days post-fertilization",
y = expression(Survival~"(%)"),
x = expression(italic(p)*CO[2]~Treatment~"("~μ*atm~")")) +
facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
Survival_92DPF
Length_92dpf <- ggplot(data_90_length, aes(x =pCO2, Length_um,  fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("grey50","white")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
#ylim(2000, 4000) +
scale_x_discrete(labels=c('~500 μatm', '~800 μatm')) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
stat_summary(fun.y=mean, geom="point", shape=18, size=4) +
labs(title = "Shell Length; F1 Scallops (juveniles) 90 days post-fertilization",
y = expression(Shell~length~"("~μm~")"),
x = expression(italic(p)*CO[2]~Treatment~"("~μ*atm~")")) +
facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
Length_92dpf
Survival_92DPF <- ggplot(data_90, aes(x =pCO2, (Survival*100) , fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("grey50","white")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
#ylim(2, 4.5) +
scale_x_discrete(labels=c('~500 μatm', '~800 μatm')) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
stat_summary(fun.y=mean, geom="point", shape=18, size=4) +
labs(title = "Perent survival; F1 Scallops (juveniles) 90 days post-fertilization",
y = expression(Survival~"(%)"),
x = expression(italic(p)*CO[2]~Treatment~"("~μ*atm~")")) +
facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
Survival_92DPF
# using lmer
ShellLengthMod_D90 <- lmer(Length_um ~ pCO2*Fed_Unfed + (1|RFactor),
data=data_90_length,
REML=TRUE)
pander(anova(ShellLengthMod_D90), style='rmarkdown') # **Fed_Unfed**    | 2.036e-88
check_model(ShellLengthMod_D90) # observe the diagnosticsdata_90_length$pCO2 of the model
shapiro.test(residuals(ShellLengthMod_D90)) # non normal 6.026e-15
leveneTest(residuals(ShellLengthMod_D90) ~ data_90_length$pCO2) # good 0.1583
# using lme
ShellLengthMod_D90 = lme(Length_um ~ pCO2*Fed_Unfed, random=~1|RFactor,
data=data_90_length,
method="REML")
pander(Anova(ShellLengthMod_D90), style='rmarkdown') # **Fed_Unfed**    |  579.3  | 1  | 5.206e-128
# Survival:::::::::::::::::::::::::::::::::::::::::::::
# using lmer
SurvivalMod_D90 <- lmer(Survival ~ pCO2*Fed_Unfed + (1|RFactor),
data=data_90,
REML=TRUE)
pander(anova(SurvivalMod_D90), style='rmarkdown') #  **Fed_Unfed**    | 2.936e-09 |
# check_model(ShellLengthMod_D90) # observe the diagnostics data_90_length$pCO2 of the model
shapiro.test(residuals(ShellLengthMod_D90)) # non normal 6.026e-15
leveneTest(residuals(ShellLengthMod_D90) ~ data_90$pCO2) # good  0.627
Length_90dpf <- ggplot(data_90_length, aes(x =pCO2, Length_um,  fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("grey50","white")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
#ylim(2000, 4000) +
scale_x_discrete(labels=c('~500 μatm', '~800 μatm')) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
stat_summary(fun.y=mean, geom="point", shape=18, size=4) +
labs(title = "Shell Length; F1 Scallops (juveniles) 90 days post-fertilization",
y = expression(Shell~length~"("~μm~")"),
x = expression(italic(p)*CO[2]~Treatment~"("~μ*atm~")")) +
facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
Length_90dpf
Survival_90DPF <- ggplot(data_90, aes(x =pCO2, (Survival*100) , fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("grey50","white")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
#ylim(2, 4.5) +
scale_x_discrete(labels=c('~500 μatm', '~800 μatm')) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
stat_summary(fun.y=mean, geom="point", shape=18, size=4) +
labs(title = "Perent survival; F1 Scallops (juveniles) 90 days post-fertilization",
y = expression(Survival~"(%)"),
x = expression(italic(p)*CO[2]~Treatment~"("~μ*atm~")")) +
facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
Survival_90DPF
Survival_90DPF
e0("C:/Users/samuel.gurr/Documents/Github_repositories/Airradians_OA/RAnalysis/Output/Survival_size/20210930_shell_length.pdf"))
pdf(paste0("C:/Users/samjg/Documents/Github_repositories/Airradians_OA/RAnalysis/Output/Survival_size/20210930_survival.pdf"))
Survival_90DPF
Survival_90DPF
dev.off()
pdf(paste0("C:/Users/samjg/Documents/Github_repositories/Airradians_OA/RAnalysis/Output/Survival_size/20210930_survival.pdf"))
Survival_90DPF
dev.off()
pdf(paste0("C:/Users/samjg/Documents/Github_repositories/Airradians_OA/RAnalysis/Output/Survival_size/20211026_shell_length.pdf"))
Length_90dpf
dev.off()
pdf(paste0("C:/Users/samjg/Documents/Github_repositories/Airradians_OA/RAnalysis/Output/Survival_size/20210930_shell_length.pdf"))
Length_64dpf
dev.off()
