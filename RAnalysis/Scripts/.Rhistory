geom_line(aes(linetype = factor(Fed_Unfed)), size = 0.5) +
geom_point()+
scale_color_manual(values=c("black","black"))
GrowthRate_Means_plot <- ggplot(data=Growth_rate_Means_byTreat, aes(x=Age_DPF, y=(Growth_rate_umperday/1000), color=pCO2)) +
geom_line(aes(linetype = factor(Fed_Unfed)), size = 0.5) +
geom_point()+
scale_color_manual(values=c("black","black")) +
geom_errorbar(aes(ymin=(Growth_rate_umperday/1000)-(se/1000),
ymax=(Growth_rate_umperday/1000)+(se/1000)), width=.2,
position=position_dodge(.1))+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
scale_x_continuous(name ="Age (days)") +
scale_y_continuous(name ="Shell growth rate (mm per day)")  +
scale_linetype_manual(values = c("High food" = "solid", "Low food" = "dashed"))  +
theme_classic() +
theme(legend.position="none") +
# facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
facet_wrap(~pCO2)
GrowthRate_Means_plot
GrowthRate_Means_plot <- ggplot(data=Growth_rate_Means_byTreat, aes(x=Age_DPF, y=(Growth_rate_umperday/1000), color=pCO2)) +
geom_line(aes(linetype = factor(Fed_Unfed)), size = 0.5) +
geom_point()+
scale_color_manual(values=c("black","black")) +
geom_errorbar(aes(ymin=(Growth_rate_umperday/1000)-(se/1000),
ymax=(Growth_rate_umperday/1000)+(se/1000)), width=.2,
position=position_dodge(.1))+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
scale_x_continuous(name ="Age (days)") +
scale_y_continuous(name ="Shell growth rate (mm per day)")  +
scale_linetype_manual(values = c("High food" = "solid", "Low food" = "dashed"))  +
theme_classic() +
#theme(legend.position="none") +
# facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
facet_wrap(~pCO2)
GrowthRate_Means_plot
GrowthRate_Means_plot_D92 <- Growth_rate_Means_byTreat %>%
dplyr::filter(Age_DPF %in% 92) %>%
ggplot(aes(x=Age_DPF, y=(Growth_rate_umperday/1000), color=pCO2)) +
geom_line(aes(linetype = factor(Fed_Unfed)), size = 0.5) +
geom_point()+
scale_color_manual(values=c("black","black")) +
geom_errorbar(aes(ymin=(Growth_rate_umperday/1000)-(se/1000),
ymax=(Growth_rate_umperday/1000)+(se/1000)), width=.2,
position=position_dodge(.1))+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
scale_x_continuous(name ="Age (days)") +
scale_y_continuous(name ="Shell growth rate (mm per day)")  +
scale_linetype_manual(values = c("High food" = "solid", "Low food" = "dashed"))  +
theme_classic() +
#theme(legend.position="none") +
# facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
facet_wrap(~pCO2)
GrowthRate_Means_plot_D92
Length_Means <- summarySE(length, measurevar="Length_um", groupvars=c("Age_DPF", "pH", "Fed_Unfed"))
Length_Means <- Length_Means %>%
dplyr::mutate(pCO2 = case_when(pH == 8 ~ "500 μatm",  pH == 7.5 ~ "800 μatm")) %>%
dplyr::mutate(Fed_Unfed = case_when(Fed_Unfed == "fed" ~ "High food",  Fed_Unfed == "unfed" ~ "Low food"))
Length_Means
Length_Means_byTank  <- summarySE(length, measurevar="Length_um", groupvars=c("Age_DPF", "pH", "Fed_Unfed", "Replicate")) %>%
dplyr::mutate(pCO2 = case_when(pH == 8 ~ "500 μatm",  pH == 7.5 ~ "800 μatm")) %>%
dplyr::mutate(Fed_Unfed = case_when(Fed_Unfed == "fed" ~ "High food",  Fed_Unfed == "unfed" ~ "Low food"))
Length_Means_byTank
Av_7.5FedA <- (Length_Means_byTank %>% dplyr::filter(Age_DPF %in% 51))[1,6] # pH 7.5 Rep (tank) A
Av_7.5FedB <- (Length_Means_byTank %>% dplyr::filter(Age_DPF %in% 51))[2,6] # pH 7.5 Rep (tank) B
Av_7.5FedC <- (Length_Means_byTank %>% dplyr::filter(Age_DPF %in% 51))[3,6] # pH 7.5 Rep (tank) C
Av_7.5FedD <- (Length_Means_byTank %>% dplyr::filter(Age_DPF %in% 51))[4,6] # pH 7.5 Rep (tank) D
Av_8.0FedA <- (Length_Means_byTank %>% dplyr::filter(Age_DPF %in% 51))[5,6] # pH 8.0 Rep (tank) A
Av_8.0FedB <- (Length_Means_byTank %>% dplyr::filter(Age_DPF %in% 51))[6,6] # pH 8.0 Rep (tank) B
Av_8.0FedC <- (Length_Means_byTank %>% dplyr::filter(Age_DPF %in% 51))[7,6] # pH 8.0 Rep (tank) C
Av_8.0FedD <- (Length_Means_byTank %>% dplyr::filter(Age_DPF %in% 51))[8,6] # pH 8.0 Rep (tank) D
Growth_rate <- Length_Means_byTank %>%
dplyr::mutate(Start_Length_um =
case_when( (pH == 7.5 & Replicate == 'A') ~ Av_7.5FedA, # pH = 7.5, insert this starting length value
(pH == 7.5 & Replicate == 'B') ~ Av_7.5FedB, # Note: two conditional case_when statements apply BOTH with & and inside ()
(pH == 7.5 & Replicate == 'C') ~ Av_7.5FedC,
(pH == 7.5 & Replicate == 'D') ~ Av_7.5FedD,
(pH == 8.0 & Replicate == 'A') ~ Av_8.0FedA,
(pH == 8.0 & Replicate == 'B') ~ Av_8.0FedB,
(pH == 8.0 & Replicate == 'C') ~ Av_8.0FedC,
(pH == 8.0 & Replicate == 'D') ~ Av_8.0FedD)) %>% # pH = 7.5, insert this starting length value
dplyr::mutate(Growth_rate_umperday = (Length_um - Start_Length_um) / (Age_DPF - 51)) %>%
dplyr::filter(!(Age_DPF %in% 51)) %>%  # we no longer need this first time point of length - just == zero for growth!
dplyr::select(!c(N,sd,se,ci)) # cut down necessary columns - however remember the N was 4, a mean from each replicate tank mean
Growth_rate
Growth_rate_Means_byTreat <- summarySE(Growth_rate, measurevar="Growth_rate_umperday", groupvars=c("Age_DPF", "pH", "pCO2", "Fed_Unfed"))
Growth_rate_Means_byTreat
GrowthRate_Means_plot <- ggplot(data=Growth_rate_Means_byTreat, aes(x=Age_DPF, y=(Growth_rate_umperday/1000), color=pCO2)) +
geom_line(aes(linetype = factor(Fed_Unfed)), size = 0.5) +
geom_point()+
scale_color_manual(values=c("black","black")) +
geom_errorbar(aes(ymin=(Growth_rate_umperday/1000)-(se/1000),
ymax=(Growth_rate_umperday/1000)+(se/1000)), width=.2,
position=position_dodge(.1))+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
scale_x_continuous(name ="Age (days)") +
scale_y_continuous(name ="Shell growth rate (mm per day)")  +
scale_linetype_manual(values = c("High food" = "solid", "Low food" = "dashed"))  +
theme_classic() +
#theme(legend.position="none") +
# facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
facet_wrap(~pCO2)
GrowthRate_Means_plot
GrowthRate_Means_plot_D92 <- Growth_rate_Means_byTreat %>%
dplyr::filter(Age_DPF %in% 92) %>%
ggplot(aes(x=Age_DPF, y=(Growth_rate_umperday/1000), color=pCO2)) +
geom_line(aes(linetype = factor(Fed_Unfed)), size = 0.5) +
geom_point()+
scale_color_manual(values=c("black","black")) +
geom_errorbar(aes(ymin=(Growth_rate_umperday/1000)-(se/1000),
ymax=(Growth_rate_umperday/1000)+(se/1000)), width=.2,
position=position_dodge(.1))+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
scale_x_continuous(name ="Age (days)") +
scale_y_continuous(name ="Shell growth rate (mm per day)")  +
scale_linetype_manual(values = c("High food" = "solid", "Low food" = "dashed"))  +
theme_classic() +
#theme(legend.position="none") +
# facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
facet_wrap(~pCO2)
GrowthRate_Means_plot_D92
# Purpose: Bay Scallop Project - Feeding Rates
# analysis of respiration rate data
# Written by: Sam J Gurr (last edit 11/17/2022)
# Review Riisgard 2001 defining the clearance rate of bivalves
# NOTE: clearance rate is defined as the volume of water cleared of suspended particles per unit time, and only equals filtration rate when
# 100% of suspended particles are efficiently retained
# LOAD PACKAGES :::::::::::::::::::::::::::::::::::::::::::::::::::::::
library(dplyr)
library(ggplot2)
library(forcats)
library(lme4)
library(lmerTest)
library(see)
library(performance)
library(car)
library(reshape2)
library(lubridate)
library(SciViews)
library(reshape2)
library(SciViews)
library(kableExtra)
library(latex2exp)
library(pander)
library(performance)
library(ggpubr)
library(Rmisc)
library(nlme)
library(AICcmodavg)
# SET WORKING DIRECTORY :::::::::::::::::::::::::::::::::::::::::::::::
# setwd("C:/Users/samjg/Documents/Github_repositories/Airradians_OA-foodsupply/RAnalysis") # Work computer
setwd("C:/Users/samjg/Documents/Github_repositories/Airradians_OA-foodsupply/RAnalysis") # personal computer
# LOAD DATA :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# Master_data       <- read.csv(file="Data/Clearance_rates/ClearanceRates_MasterData.csv", header=T) # master data file
ClearancRates_calc  <- read.csv(file="Output/ClearanceRates/ClearanceRate_Calc.csv", header=T) # master data file
ClearancRates_calc
Total_FR_914_df      <- ClearancRates_calc %>%
filter(Date %in% '20210914') %>%
filter(Total_mL.hr.mmlength > 0) %>% mutate(type = 'Total') %>%
dplyr::rename(CR_mL.hr.mmlength = Total_mL.hr.mmlength) %>%
dplyr::select(!c('Chaet_mL.hr.mmlength','Ply_mL.hr.mmlength','Seston_mL.hr.mmlength')) %>%
dplyr::mutate(pH = as.factor(pH))
Ply_FR_914_df      <- ClearancRates_calc %>%
filter(Date %in% '20210914') %>%
filter(Ply_mL.hr.mmlength > 0) %>% mutate(type = 'ply') %>%
dplyr::rename(CR_mL.hr.mmlength = Ply_mL.hr.mmlength) %>%
dplyr::select(!c('Total_mL.hr.mmlength','Chaet_mL.hr.mmlength','Seston_mL.hr.mmlength')) %>%
dplyr::mutate(pH = as.factor(pH))
Chaet_FR_914_df    <-  ClearancRates_calc %>%
filter(Date %in% '20210914') %>%
filter(Chaet_mL.hr.mmlength > 0) %>% mutate(type = 'chaet') %>%
dplyr::rename(CR_mL.hr.mmlength = Chaet_mL.hr.mmlength) %>%
dplyr::select(!c('Ply_mL.hr.mmlength', 'Total_mL.hr.mmlength', 'Seston_mL.hr.mmlength')) %>%
dplyr::mutate(pH = as.factor(pH))
Seston_FR_914_df   <-  ClearancRates_calc %>%
filter(Date %in% '20210914') %>%
filter(Seston_mL.hr.mmlength > 0) %>% mutate(type = 'seston') %>%
dplyr::rename(CR_mL.hr.mmlength = Seston_mL.hr.mmlength) %>%
dplyr::select(!c('Chaet_mL.hr.mmlength', 'Total_mL.hr.mmlength', 'Ply_mL.hr.mmlength')) %>%
dplyr::mutate(pH = as.factor(pH))
pander(Total_FR_914_df %>% summarySE(measurevar="CR_mL.hr.mmlength", groupvars=c("pCO2", "Fed_Unfed")), style='rmarkdown')
# Ply - one-way anova
Total_AOVmod_0914 <-aov(CR_mL.hr.bfactor ~ pCO2,
data=Total_FR_914_df.bfactor) #nlme
shapiro.test(resid(Total_AOVmod_0914)) # 0.2137
leveneTest(Total_AOVmod_0914) # 0.03883 *
Total_FR_914_df.bfactor      <- ClearancRates_calc %>%
filter(Date %in% '20210914') %>%
filter(Total_mL.hr.mmlength > 0) %>% mutate(type = 'Total') %>%
dplyr::rename(CR_mL.hr.bfactor = Total_mL.hr.bfactor) %>%
dplyr::select(!c('Chaet_mL.hr.bfactor','Ply_mL.hr.bfactor', 'Seston_mL.hr.bfactor')) %>%
dplyr::mutate(pH = as.factor(pH))
# Ply - one-way anova
Total_AOVmod_0914 <-aov(CR_mL.hr.bfactor ~ pCO2,
data=Total_FR_914_df.bfactor) #nlme
shapiro.test(resid(Total_AOVmod_0914)) # 0.2137
leveneTest(Total_AOVmod_0914) # 0.03883 *
Total_AOVmod_0914 <-aov(CR_mL.hr.bfactor ~ pCO2,
data=Total_FR_914_df.bfactor) #nlme
pander(anova(Total_AOVmod_0914), style='rmarkdown') # anova table of lme
Total_FR_914_df      <- ClearancRates_calc %>%
filter(Date %in% '20210914') %>%
filter(Total_mL.hr.mmlength > 0) %>% mutate(type = 'Total') %>%
dplyr::rename(CR_mL.hr.mmlength = Total_mL.hr.mmlength) %>%
dplyr::select(!c('Chaet_mL.hr.mmlength','Ply_mL.hr.mmlength','Seston_mL.hr.mmlength')) %>%
dplyr::mutate(pH = as.factor(pH))
Ply_FR_914_df      <- ClearancRates_calc %>%
filter(Date %in% '20210914') %>%
filter(Ply_mL.hr.mmlength > 0) %>% mutate(type = 'ply') %>%
dplyr::rename(CR_mL.hr.mmlength = Ply_mL.hr.mmlength) %>%
dplyr::select(!c('Total_mL.hr.mmlength','Chaet_mL.hr.mmlength','Seston_mL.hr.mmlength')) %>%
dplyr::mutate(pH = as.factor(pH))
Chaet_FR_914_df    <-  ClearancRates_calc %>%
filter(Date %in% '20210914') %>%
filter(Chaet_mL.hr.mmlength > 0) %>% mutate(type = 'chaet') %>%
dplyr::rename(CR_mL.hr.mmlength = Chaet_mL.hr.mmlength) %>%
dplyr::select(!c('Ply_mL.hr.mmlength', 'Total_mL.hr.mmlength', 'Seston_mL.hr.mmlength')) %>%
dplyr::mutate(pH = as.factor(pH))
Seston_FR_914_df   <-  ClearancRates_calc %>%
filter(Date %in% '20210914') %>%
filter(Seston_mL.hr.mmlength > 0) %>% mutate(type = 'seston') %>%
dplyr::rename(CR_mL.hr.mmlength = Seston_mL.hr.mmlength) %>%
dplyr::select(!c('Chaet_mL.hr.mmlength', 'Total_mL.hr.mmlength', 'Ply_mL.hr.mmlength')) %>%
dplyr::mutate(pH = as.factor(pH))
# simple size corrected data
Master_914_plotting         <- rbind(Total_FR_914_df, Chaet_FR_914_df, Ply_FR_914_df, Seston_FR_914_df)
Master_914_plotting$pHxfood <- paste(Master_914_plotting$pH, Master_914_plotting$Fed_Unfed, sep = '_')
CR_914_boxplot <- Master_914_plotting %>%
ggplot(aes(pCO2 , CR_mL.hr.mmlength , fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("white","grey50")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=10)) +
stat_summary(fun.y=mean, geom="point", shape=18, size=4, color="black", fill="white") +
ggtitle("Clearance rate (size corrected), F1 Scallops 20210914") +
facet_wrap(~type)
CR_914_boxplot
Total_FR_930_df      <- ClearancRates_calc %>%
filter(Date %in% '20210930') %>%
filter(Total_mL.hr.mmlength > 0) %>%
mutate(type = 'Total') %>%
dplyr::rename(CR_mL.hr.mmlength = Total_mL.hr.mmlength) %>%
dplyr::select(!c('Chaet_mL.hr.mmlength','Ply_mL.hr.mmlength', 'Seston_mL.hr.mmlength'))%>%
dplyr::mutate(pH = as.factor(pH))
Ply_FR_930_df      <- ClearancRates_calc %>%
filter(Date %in% '20210930') %>%
filter(Ply_mL.hr.mmlength > 0) %>%
mutate(type = 'ply') %>%
dplyr::rename(CR_mL.hr.mmlength = Ply_mL.hr.mmlength) %>%
dplyr::select(!c('Chaet_mL.hr.mmlength','Total_mL.hr.mmlength', 'Seston_mL.hr.mmlength'))%>%
dplyr::mutate(pH = as.factor(pH))
Chaet_FR_930_df    <- ClearancRates_calc %>%
filter(Date %in% '20210930') %>%
filter(Chaet_mL.hr.mmlength > 0) %>%
mutate(type = 'chaet') %>%
dplyr::rename(CR_mL.hr.mmlength = Chaet_mL.hr.mmlength) %>%
dplyr::select(!c('Ply_mL.hr.mmlength','Total_mL.hr.mmlength', 'Seston_mL.hr.mmlength'))%>%
dplyr::mutate(pH = as.factor(pH))
Seston_FR_930_df   <- ClearancRates_calc %>%
filter(Date %in% '20210930') %>%
filter(Seston_mL.hr.mmlength > 0) %>%
mutate(type = 'seston') %>%
dplyr::rename(CR_mL.hr.mmlength = Seston_mL.hr.mmlength) %>%
dplyr::select(!c('Chaet_mL.hr.mmlength','Total_mL.hr.mmlength', 'Ply_mL.hr.mmlength'))%>%
dplyr::mutate(pH = as.factor(pH))
Master_930_plotting         <- rbind(Total_FR_930_df,Chaet_FR_930_df, Ply_FR_930_df, Seston_FR_930_df)
Master_930_plotting$pHxfood <- paste(Master_930_plotting$pH, Master_930_plotting$Fed_Unfed, sep = '_')
CR_930_boxplot <- Master_930_plotting %>%
ggplot(aes(pHxfood , CR_mL.hr.mmlength , fill = pHxfood)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pHxfood)) +
scale_fill_manual(values=c("grey50","grey50","white","white")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=10)) +
stat_summary(fun.y=mean, geom="point", shape=18, size=4, color="black", fill="white") +
ggtitle("Clearance rate, F1 Scallops 20210930") +
facet_wrap(~type)
CR_930_boxplot
# Ply - one-way anova
Total_AOVmod_0930 <-aov(CR_mL.hr.bfactor ~ pCO2 * Fed_Unfed,
data=Total_FR_930_df.bfactor)
CR_930_boxplot
Total_FR_1026_df      <- ClearancRates_calc %>%
filter(Date %in% '20211026') %>%
filter(Total_mL.hr.mmlength > 0) %>%
mutate(type = 'Total') %>%
dplyr::rename(CR_mL.hr.mmlength = Total_mL.hr.mmlength) %>%
dplyr::select(!c('Chaet_mL.hr.mmlength','Ply_mL.hr.mmlength', 'Seston_mL.hr.mmlength'))%>%
dplyr::mutate(pH = as.factor(pH))
Ply_FR_1026_df      <- ClearancRates_calc %>%
filter(Date %in% '20211026') %>%
filter(Ply_mL.hr.mmlength > 0) %>%
mutate(type = 'ply') %>%
dplyr::rename(CR_mL.hr.mmlength = Ply_mL.hr.mmlength) %>%
dplyr::select(!c('Chaet_mL.hr.mmlength','Total_mL.hr.mmlength', 'Seston_mL.hr.mmlength'))%>%
dplyr::mutate(pH = as.factor(pH))
Chaet_FR_1026_df    <- ClearancRates_calc %>%
filter(Date %in% '20211026') %>%
filter(Chaet_mL.hr.mmlength > 0) %>%
mutate(type = 'chaet') %>%
dplyr::rename(CR_mL.hr.mmlength = Chaet_mL.hr.mmlength) %>%
dplyr::select(!c('Ply_mL.hr.mmlength','Total_mL.hr.mmlength','Seston_mL.hr.mmlength'))%>%
dplyr::mutate(pH = as.factor(pH))
Seston_FR_1026_df   <- ClearancRates_calc %>%
filter(Date %in% '20211026') %>%
filter(Seston_mL.hr.mmlength > 0) %>%
mutate(type = 'seston') %>%
dplyr::rename(CR_mL.hr.mmlength = Seston_mL.hr.mmlength) %>%
dplyr::select(!c('Chaet_mL.hr.mmlength','Total_mL.hr.mmlength','Ply_mL.hr.mmlength'))%>%
dplyr::mutate(pH = as.factor(pH))
Master_1026_plotting         <- rbind(Total_FR_1026_df,
Chaet_FR_1026_df,
Ply_FR_1026_df,
Seston_FR_1026_df)
Master_1026_plotting$pHxfood <- paste(Master_1026_plotting$pCO2, Master_1026_plotting$Fed_Unfed, sep = '_')
CR_1026_boxplot <- Master_1026_plotting %>%
ggplot(aes(pHxfood , CR_mL.hr.mmlength , fill = pHxfood)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pHxfood)) +
scale_fill_manual(values=c("grey50","grey50","white","white")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=10)) +
stat_summary(fun.y=mean, geom="point", shape=18, size=4, color="black", fill="white") +
ggtitle("Clearance rate, F1 Scallops 20211026") +
facet_wrap(~type)
CR_1026_boxplot
TukeyHSD(aov(Seston_AOVmod_1026))
# Seston - one-way anova
Seston_AOVmod_1026 <-lm(CR_mL.hr.bfactor ~ pCO2 * Fed_Unfed,
data=Seston_FR_1026_df.bfactor) #nlme
Seston_FR_1026_df   <- ClearancRates_calc %>%
filter(Date %in% '20211026') %>%
filter(Seston_mL.hr.mmlength > 0) %>%
mutate(type = 'seston') %>%
dplyr::rename(CR_mL.hr.mmlength = Seston_mL.hr.mmlength) %>%
dplyr::select(!c('Chaet_mL.hr.mmlength','Total_mL.hr.mmlength','Ply_mL.hr.mmlength'))%>%
dplyr::mutate(pH = as.factor(pH))
# Seston - one-way anova
Seston_AOVmod_1026 <-lm(CR_mL.hr.bfactor ~ pCO2 * Fed_Unfed,
data=Seston_FR_1026_df.bfactor) #nlme
# Seston - one-way anova
Seston_AOVmod_1026 <-lm(CR_mL.hr.bfactor ~ pCO2 * Fed_Unfed,
data=Seston_FR_1026_df) #nlme
Seston_FR_1026_df
# Seston - one-way anova
Seston_AOVmod_1026 <-lm(CR_mL.hr ~ pCO2 * Fed_Unfed,
data=Seston_FR_1026_df) #nlme
# Seston - one-way anova
Seston_AOVmod_1026 <-lm(CR_mL.hr.mmlength ~ pCO2 * Fed_Unfed,
data=Seston_FR_1026_df) #nlme
shapiro.test(resid(Seston_AOVmod_1026))# 0.1163
leveneTest(Seston_AOVmod_1026) # 0.553
pander(aov(Seston_AOVmod_1026), style='rmarkdown') # table for SRH test
# Data - b factor normalized
Total_FR_1026_df.bfactor      <- ClearancRates_calc %>%
filter(Date %in% '20211026') %>%
filter(Total_mL.hr.mmlength > 0) %>% mutate(type = 'Total') %>%
dplyr::rename(CR_mL.hr.bfactor = Total_mL.hr.bfactor) %>%
dplyr::select(!c('Chaet_mL.hr.bfactor','Ply_mL.hr.bfactor','Seston_mL.hr.bfactor')) %>%
dplyr::mutate(pH = as.factor(pH))
Ply_FR_1026_df.bfactor      <- ClearancRates_calc %>%
filter(Date %in% '20211026') %>%
filter(Ply_mL.hr.mmlength > 0) %>% mutate(type = 'ply') %>%
dplyr::rename(CR_mL.hr.bfactor = Ply_mL.hr.bfactor) %>%
dplyr::select(!c('Chaet_mL.hr.bfactor','Total_mL.hr.bfactor','Seston_mL.hr.bfactor')) %>%
dplyr::mutate(pH = as.factor(pH))
Chaet_FR_1026_df.bfactor    <-  ClearancRates_calc %>%
filter(Date %in% '20211026') %>%
filter(Chaet_mL.hr.mmlength > 0) %>% mutate(type = 'chaet') %>%
dplyr::rename(CR_mL.hr.bfactor = Chaet_mL.hr.bfactor) %>%
dplyr::select(!c('Ply_mL.hr.bfactor','Total_mL.hr.bfactor','Seston_mL.hr.bfactor')) %>%
dplyr::mutate(pH = as.factor(pH))
Seston_FR_1026_df.bfactor   <-  ClearancRates_calc %>%
filter(Date %in% '20211026') %>%
filter(Seston_mL.hr.mmlength > 0) %>% mutate(type = 'seston') %>%
dplyr::rename(CR_mL.hr.bfactor = Seston_mL.hr.bfactor) %>%
dplyr::select(!c('Chaet_mL.hr.bfactor','Total_mL.hr.bfactor','Ply_mL.hr.bfactor')) %>%
dplyr::mutate(pH = as.factor(pH))
# Seston - one-way anova
Seston_AOVmod_1026 <-lm(CR_mL.hr.bfactor ~ pCO2 * Fed_Unfed,
data=Seston_FR_1026_df) #nlme
Seston_FR_1026_df
# Seston - one-way anova
Seston_AOVmod_1026 <-lm(CR_mL.hr.bfactor ~ pCO2 * Fed_Unfed,
data=Seston_FR_1026_df.bfactor) #nlme
shapiro.test(resid(Seston_AOVmod_1026))# 0.1163
leveneTest(Seston_AOVmod_1026) # 0.553
pander(aov(Seston_AOVmod_1026), style='rmarkdown') # table for SRH test
TukeyHSD(aov(Seston_AOVmod_1026))
Master_1026_plotting         <- rbind(Total_FR_1026_df,
Chaet_FR_1026_df,
Ply_FR_1026_df,
Seston_FR_1026_df)
CR_1026_boxplot <- Master_1026_plotting %>%
ggplot(aes(pHxfood , CR_mL.hr.mmlength , fill = pHxfood)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pHxfood)) +
scale_fill_manual(values=c("grey50","grey50","white","white")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=10)) +
stat_summary(fun.y=mean, geom="point", shape=18, size=4, color="black", fill="white") +
ggtitle("Clearance rate, F1 Scallops 20211026") +
facet_wrap(~type)
CR_1026_boxplot
# b factor normalized data
Master_1026_plotting.bfactor         <- rbind(Total_FR_1026_df.bfactor,
Chaet_FR_1026_df.bfactor,
Ply_FR_1026_df.bfactor,
Seston_FR_1026_df.bfactor)
Master_1026_plotting.bfactor$pHxfood <- paste(Master_1026_plotting.bfactor$pCO2, Master_1026_plotting.bfactor$Fed_Unfed, sep = '_')
CR_1026_boxplot.bfactor <- Master_1026_plotting.bfactor %>%
ggplot(aes(pHxfood ,
CR_mL.hr.bfactor ,
fill = pHxfood)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2,
alpha=0.1,
aes(fill=pHxfood)) +
scale_fill_manual(values=c("grey50","grey50","white","white")) +
geom_point(shape = 21,
size = 2,
position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=10)) +
stat_summary(fun.y=mean,
geom="point",
shape=18,
size=4,
color="black",
fill="white") +
ggtitle("Clearance rate (bfactor normalized), F1 Scallops 20211026") +
facet_wrap(~type)
CR_1026_boxplot.bfactor
Growth_rate_Means_byTreat
Growth_rate
Growth_rate
Growth_rate_64DPF <- Growth_rate %>% dplyr::filter(Age_DPF %in% 64)
Growth_rate_92DPF <- Growth_rate %>% dplyr::filter(Age_DPF %in% 92)
Growth_rate_64DPF
GR_DPF64_MOD      <- lm(Growth_rate_umperday ~ pCO2*Fed_Unfed,data=Growth_rate_64DPF)
GR_DPF64_MOD
shapiro.test(resid(GR_DPF64_MOD))
leveneTest(0.3609)
leveneTest(GR_DPF64_MOD)
library(rcompanion)
GR_DPF64_MOD_SRH  <- scheirerRayHar(Growth_rate_umperday ~ pCO2*Fed_Unfed,data=Growth_rate_64DPF)
GR_DPF64_MOD_SRH  <- scheirerRayHare(Growth_rate_umperday ~ pCO2*Fed_Unfed,data=Growth_rate_64DPF)
shapiro.test(resid(GR_DPF64_MOD_SRH)) # 0.3609 normal
leveneTest(GR_DPF64_MOD_SRH) # 0.02278 * - non-normal
summary(GR_DPF64_MOD_SRH)
GR_DPF64_MOD_SRH
GR_DPF64_MOD_SRH  <- scheirerRayHare(Growth_rate_umperday ~ pCO2*Fed_Unfed,data=Growth_rate_64DPF)
## 92 DPF
Growth_rate_92DPF <- Growth_rate %>% dplyr::filter(Age_DPF %in% 92) # the data
GR_DPF92_MOD      <- lm(Growth_rate_umperday ~ pCO2*Fed_Unfed,data=Growth_rate_92DPF)
shapiro.test(resid(GR_DPF92_MOD)) # 0.3609 normal
leveneTest(GR_DPF92_MOD) # 0.02278 * -  homogeneity of variance FAILED
summary(aov(GR_DPF92_MOD))
#                 Df Sum Sq       H p.value
# pCO2            1      1  0.0441 0.83363
# Fed_Unfed       1    256 11.2941 0.00078
# pCO2:Fed_Unfed  1      4  0.1765 0.67442
emmeans(GR_DPF64_MOD_SRH)
#                 Df Sum Sq       H p.value
# pCO2            1      1  0.0441 0.83363
# Fed_Unfed       1    256 11.2941 0.00078
# pCO2:Fed_Unfed  1      4  0.1765 0.67442
emmeans(GR_DPF92_MOD)
#                 Df Sum Sq       H p.value
# pCO2            1      1  0.0441 0.83363
# Fed_Unfed       1    256 11.2941 0.00078
# pCO2:Fed_Unfed  1      4  0.1765 0.67442
summarySE(Growth_rate_64DPF, measurevar="Growth_rate_umperday", groupvars=c("Age_DPF", "pH", "pCO2", "Fed_Unfed"))
#                 Df Sum Sq       H p.value
# pCO2            1      1  0.0441 0.83363
# Fed_Unfed       1    256 11.2941 0.00078
# pCO2:Fed_Unfed  1      4  0.1765 0.67442
summarySE(Growth_rate_64DPF, measurevar="Growth_rate_umperday", groupvars=c(pCO2", "Fed_Unfed"))
#                 Df Sum Sq       H p.value
# pCO2            1      1  0.0441 0.83363
# Fed_Unfed       1    256 11.2941 0.00078
# pCO2:Fed_Unfed  1      4  0.1765 0.67442
summarySE(Growth_rate_64DPF, measurevar="Growth_rate_umperday", groupvars=c("pCO2", "Fed_Unfed"))
#                 Df Sum Sq       H p.value
# pCO2            1      1  0.0441 0.83363
# Fed_Unfed       1    256 11.2941 0.00078
# pCO2:Fed_Unfed  1      4  0.1765 0.67442
summarySE(Growth_rate_64DPF, measurevar="Growth_rate_umperday", groupvars=c("Fed_Unfed"))
#                 Df Sum Sq Mean Sq F value   Pr(>F)
# pCO2            1     31      31   0.178    0.680
# Fed_Unfed       1  76696   76696 439.801 8.01e-11 ***
# pCO2:Fed_Unfed  1     41      41   0.233    0.638
# Residuals      12   2093     174
summarySE(GR_DPF92_MOD, measurevar="Growth_rate_umperday", groupvars=c("Fed_Unfed"))
## 64 DPF
Growth_rate_64DPF <- Growth_rate %>% dplyr::filter(Age_DPF %in% 64) # the data
#                 Df Sum Sq Mean Sq F value   Pr(>F)
# pCO2            1     31      31   0.178    0.680
# Fed_Unfed       1  76696   76696 439.801 8.01e-11 ***
# pCO2:Fed_Unfed  1     41      41   0.233    0.638
# Residuals      12   2093     174
summarySE(Growth_rate_92DPF, measurevar="Growth_rate_umperday", groupvars=c("Fed_Unfed"))
GR_DPF64_MOD_SRH # food effect
