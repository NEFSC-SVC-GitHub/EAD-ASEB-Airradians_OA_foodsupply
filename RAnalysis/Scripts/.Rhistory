library(Rmisc)
library(devtools)
# SET WORKING DIRECTORY :::::::::::::::::::::::::::::::::::::::::::::::
# setwd("C:/Users/samjg/Documents/Github_repositories/Airradians_OA/RAnalysis") # personal computer
setwd("C:/Users/samuel.gurr/Documents/Github_repositories/Airradians_OA/RAnalysis") # Work computer
# setwd("C:/Users/samjg/Documents/Github_repositories/Airradians_OA/RAnalysis") # Work computer
# LOAD DATA :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
resp.data       <- read.csv(file="Output/Respiration/Cumulative_resp_alpha0.4_15sectrunc1hour.csv", header=T) %>%
dplyr::filter(!Date %in% "9/14/2021" | !Filename %in% 'Run_1_raw.txt') # read the calculate raw rates from 'resp_LoLin' script - contains the calculated rate (not normalized for blanks) for each sensor-channel
exp_metadata    <- read.csv(file="Data/ExperimentMetadata.csv", header=T) # treatment assignments to 'Chamber_Tank'
lengths         <- read.csv(file="Data/Respiration/Lengths_Condition_resp_clearance.csv", header=T)
resp.ref        <- read.csv(file="Data/Respiration/Reference_master.csv", header=T) %>% dplyr::filter(!Date %in% "9/14/2021" | !Filename %in% 'Run_1_raw.txt')
DWs_Len_1026    <- read.csv(file="Data/Survival_Size/20211026_lengths_dryweights.csv", header=T)
DWs_Len_914.930 <- read.csv(file="Data/Survival_Size/2021914_930_dryweights.csv", header=T)
DWs_Len_914.930
Length_914           <- lengths         %>%
dplyr::filter(Date %in% '9/14/2021')  %>%
dplyr::rename(Rep = Replicate)        %>%
dplyr::select(c("Rep","pH","Number","Food", "Run", "Plate", "Instrument","Length_um"))
Dryweight_914        <- DWs_Len_914.930 %>%
dplyr::filter(Date %in% '20210914')   %>%
dplyr::filter(Purpose %in% 'resp_filtration') %>%
dplyr::rename(pH = Treatment)         %>%
dplyr::rename(Number = Num)           %>%
dplyr::select(c("Rep","pH","Number", "Plate","Run","Scallop_DW_mg"))
nrow(Length_914)
nrow(Dryweight_914)
nrow(DW_Len_914)
DW_Len_914 <- merge(Length_914, Dryweight_914)
DW_Len_914$Date <- "9/14/2021"
DW_Len_914 %>% ggplot(aes(x = Length_um, y = Scallop_DW_mg)) +
geom_smooth(method = "lm", se=FALSE, color="black", formula = Scallop_DW_mg ~ Length_um) +
theme_classic() +
ylab("Whole animal dry weight (mg)") +
xlab("Shell length (um)") +
geom_point() +
geom_smooth(method='lm')
Length_930           <- lengths         %>%
dplyr::filter(Date %in% '9/30/2021')  %>%
dplyr::rename(Rep = Replicate)        %>%
dplyr::select(c("Rep","pH","Number", "Food", "Run", "Plate","Length_um"))
Dryweight_930        <- DWs_Len_914.930 %>%
dplyr::filter(Date %in% '20210930')   %>%
dplyr::filter(Purpose %in% 'resp_filtration') %>%
dplyr::rename(Number = Num)           %>%
dplyr::rename(pH = Treatment)         %>%
dplyr::rename(Food = Fed_unfed)       %>%
dplyr::select(c("Rep","pH","Number", "Food", "Run", "Plate","Scallop_DW_mg"))
DW_Len_930 <- merge(Length_930, Dryweight_930)
DW_Len_930$Date <- "9/30/2021"
DW_Len_930 %>% ggplot(aes(x = Length_um, y = Scallop_DW_mg)) +
geom_smooth(method = "lm", se=FALSE, color="black", formula = Scallop_DW_mg ~ Length_um) +
theme_classic() +
ylab("Whole animal dry weight (mg)") +
xlab("Shell length (um)") +
geom_point() +
geom_smooth(method='lm') + # y~0+x if you want it through the origin (0,0)
facet_wrap(~Food)
# 20211026 ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
Length_1026_Unfed    <- lengths         %>%
dplyr::filter(Date %in% '10/26/2021') %>%
dplyr::rename(Rep = Replicate)        %>%
dplyr::select(c("Rep","pH","Number", "Food", "Run", "Run","Plate","Length_um"))
# 20211026 ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
Length_1026_Unfed    <- lengths         %>%
dplyr::filter(Date %in% '10/26/2021') %>%
dplyr::rename(Rep = Replicate)        %>%
dplyr::select(c("Rep","pH","Number", "Food", "Run", "Plate","Length_um"))
Dryweight_1026_Unfed <- DWs_Len_914.930 %>%
dplyr::filter(Date %in% '20211026')   %>%
dplyr::filter(Purpose %in% 'resp_filtration') %>%
dplyr::rename(Food = Fed_unfed)       %>%
dplyr::rename(pH = Treatment)         %>%
dplyr::rename(Number = Num)           %>%
dplyr::select(c("Rep","pH","Number", "Food","Run", "Plate",  "Scallop_DW_mg"))
DW_Len_1026_unfed <- merge(Length_1026_Unfed, Dryweight_1026_Unfed)
DW_Len_1026_unfed$Date <- "10/26/2021"
# Explore the DW and shell length relationship in our data...
Master_SizeStand_dat      <- rbind(DW_Len_1026_unfed, DW_Len_1026_Fed, DW_Len_930, DW_Len_914)
DW_Len_1026_unfed
DW_Len_1026_Fed
DW_Len_930
DW_Len_914
Length_914           <- lengths         %>%
dplyr::filter(Date %in% '9/14/2021')  %>%
dplyr::rename(Rep = Replicate)        %>%
dplyr::select(c("Rep","pH","Number","Food", "Run", "Food", "Plate", "Instrument","Length_um"))
Dryweight_914        <- DWs_Len_914.930 %>%
dplyr::filter(Date %in% '20210914')   %>%
dplyr::filter(Purpose %in% 'resp_filtration') %>%
dplyr::rename(pH = Treatment)         %>%
dplyr::rename(Number = Num)           %>%
dplyr::select(c("Rep","pH","Number", "Plate","Run","Scallop_DW_mg"))
DW_Len_914 <- merge(Length_914, Dryweight_914)
# Explore the DW and shell length relationship in our data...
Master_SizeStand_dat      <- rbind(DW_Len_1026_unfed, DW_Len_1026_Fed, DW_Len_930, DW_Len_914)
DW_Len_914
DW_Len_930
# Explore the DW and shell length relationship in our data...
Master_SizeStand_dat      <- rbind(DW_Len_1026_unfed, DW_Len_1026_Fed, DW_Len_930, DW_Len_914)
DW_Len_1026_Fed
DW_Len_914$Date <- "9/14/2021"
# Explore the DW and shell length relationship in our data...
Master_SizeStand_dat      <- rbind(DW_Len_1026_unfed, DW_Len_1026_Fed, DW_Len_930, DW_Len_914)
DW_Len_914
DW_Len_930
DW_Len_1026_Fed
DW_Len_1026_unfed
DW_Len_1026_Fed    <- lengths           %>%
dplyr::filter(Date %in% '10/26/2021' & Food %in% 'fed') %>%
dplyr::rename(Rep = Replicate)        %>%
dplyr::select(c("Rep","pH","Number", "Food", "Run", "Plate","Length_um", 'Dry_Shell_weight', 'Dry_Tissue_weight')) %>% # call the dry weights that were complete separately
dplyr::mutate(Scallop_DW_mg = (Dry_Shell_weight + Dry_Tissue_weight)*1000) %>% # calculate the total animal dry weight and covert to mg ( *1000)- this corresponds with the data we have for smaller animals on previous dates
dplyr::select(!c('Dry_Tissue_weight','Dry_Shell_weight')) # omit these to merge to the master file ""
DW_Len_1026_Fed$Date <- "10/26/2021"
# Explore the DW and shell length relationship in our data...
Master_SizeStand_dat      <- rbind(DW_Len_1026_unfed, DW_Len_1026_Fed, DW_Len_930, DW_Len_914)
rbind(DW_Len_1026_unfed, DW_Len_1026_Fed)
rbind(DW_Len_1026_unfed, DW_Len_1026_Fed, DW_Len_930)
# Explore the DW and shell length relationship in our data...
Master_SizeStand_dat      <- rbind(DW_Len_930, DW_Len_914)
DW_Len_914
Length_914           <- lengths         %>%
dplyr::filter(Date %in% '9/14/2021')  %>%
dplyr::rename(Rep = Replicate)        %>%
dplyr::select(c("Rep","pH","Number","Food", "Run", "Food", "Plate", "Length_um"))
Dryweight_914        <- DWs_Len_914.930 %>%
dplyr::filter(Date %in% '20210914')   %>%
dplyr::filter(Purpose %in% 'resp_filtration') %>%
dplyr::rename(pH = Treatment)         %>%
dplyr::rename(Number = Num)           %>%
dplyr::select(c("Rep","pH","Number", "Plate","Run","Scallop_DW_mg"))
DW_Len_914 <- merge(Length_914, Dryweight_914)
DW_Len_914$Date <- "9/14/2021"
# Explore the DW and shell length relationship in our data...
Master_SizeStand_dat      <- rbind(DW_Len_1026_unfed, DW_Len_1026_Fed, DW_Len_930, DW_Len_914)
nrow(Master_SizeStand_dat)
# merge the exp_metadata with the resp.data
resp.ref_length_merged                 <- merge(resp.ref, lengths) # all TRUE allows us to keep the blanks
resp.data_merged                       <- merge(resp.data, resp.ref_length_merged) %>% # out master file moving forward....
dplyr::mutate(filetype = str_sub(Filename, -3,-1)) %>%
dplyr::mutate(filetype = factor(ifelse(filetype == "csv", "SDR_data", "LoLigo_data")))
kable(head(resp.data_merged))
resp.data_merged[94,c(1:6)]  # 	C1 RR_9.30.21_AM_Plate_2_Run_1.csv # -0.02890813	-0.0608251	-0.0608251 - Lz and Leq call better regression than Lpc
resp.data_merged[110,c(1:6)] #  C5 RR_9.30.21_PM_Plate_2_Run_2.csv	0.029052351	-0.076034441	-0.076034441
resp.data_merged[95,c(1:6)]  # 	C1 RR_9.30.21_PM_Plate_1_Run_2.csv	0.011656487	0.011656487	0.011656487  - ommit this
resp.data_merged[94,4] <- resp.data_merged[94,5] # 20210930_Plate_2_Run_2_C5_regression - Lz and Leq call better regression than Lpc
resp.data_merged[110,4] <- resp.data_merged[110,5] # 20210930_Plate_2_Run_1_C1_regression - Lz and Leq call better regression than Lpc
resp.data_merged[95,4] <- -0.0296 # 20210930_Plate_1_Run_2_C1_regression - plot shows noise after the 20 minutes mark, we reran this at the end of the LoLin script, insert here!
resp.data_merged[94,c(1:6)]
resp.data_merged[110,c(1:6)]
resp.data_merged[95,c(1:6)]
blanks_total <- data.frame() # start dataframe
blanks.table <- data.frame(matrix(nrow = 1,ncol = 5)) # make a table template
colnames(blanks.table)<-c('Date', 'Channel', 'mean_Lpc', 'mean_Leq' , 'mean_Lz') # names for comuns in the for loop
blanks_all_raw <- data.frame(merge(resp.ref, resp.data, by = c('Date', 'Channel', 'Filename')) %>%
dplyr::mutate(filetype = str_sub(Filename, -3,-1)) %>%
dplyr::mutate(filetype = factor(ifelse(filetype == "csv", "SDR_data", "LoLigo_data"))) %>%
dplyr::filter(Chamber_tank  == 'blank') %>%
dplyr::filter(Lpc <0) %>%
dplyr::filter(!Date == '9/30/2021' | !Lpc < -0.035) %>% #omits C6 RR_9.30.21_AM_Plate_1_Run_1.csv	8.0	blank - View the Lolin plot, looks noisy and a fast outlier from the others
dplyr::filter(!Date == '10/26/2021'  | !Channel == "CH8" | !Run == "2" )) # omit a bad blank that contained a bad seal, noted on the respiration sampling day during the trial
kable((blanks_all_raw)[,c(1:3,6,8,12:14)])
blanks_means <- blanks_all_raw %>%
dplyr::group_by(Date, pH, filetype) %>%
dplyr::filter(Chamber_tank == "blank") %>%
dplyr::filter(Lpc <0) %>% # ommit blank calls that d/n represent oxygen consumption
dplyr::summarise(BLANK.mean_Lpc = mean(abs(Lpc)),
BLANK.sd.Lpc   = sd(abs(Lpc)),
BLANK.mean_Leq = mean(abs(Leq)),
BLANK.mean_Lz = mean(abs(Lz)),
n = n())
kable(blanks_means)
Resp.Master <- merge(resp.data_merged, blanks_means, by=c("Date", "pH",  "filetype")) %>% # NOTE: this repeats for every distinct length value
dplyr::mutate(resp_blankStand = Lpc - BLANK.mean_Lpc) # ommits respiration rate values showing an increase in O2 over time
Resp.Master2 <- merge(Master_SizeStand_dat2, Resp.Master)
sort(Resp.Master$Length_um) == sort(Master_SizeStand_dat$Length_um)
Master_SizeStand_dat2 <- Master_SizeStand_dat %>%  dplyr::select(!Length_um)
sort(Resp.Master$Length_um) == sort(Master_SizeStand_dat2$Length_um)
sort(Master_SizeStand_dat2$Length_um)
Master_SizeStand_dat2 <- Master_SizeStand_dat %>%  dplyr::select(!Length_um)
Resp.Master2 <- merge(Master_SizeStand_dat2, Resp.Master)
nrow(Resp.Master2)
Resp.Master2
Resp.Master
Resp.Master2 <- merge(Master_SizeStand_dat2, Resp.Master, by = c('Date','pH','Food','Run','Plate','Number'))
nrow(Resp.Master2)
Master_SizeStand_dat2
nrow(Master_SizeStand_dat2)
nrow(Resp.Master)
Resp.Master2 <- cbind(Master_SizeStand_dat2, Resp.Master, by = c('Date','pH','Food','Run','Plate','Number'))
Resp.Master2 <- merge(Master_SizeStand_dat, Resp.Master, by = c('Date','pH','Food','Run','Plate','Number'))
nrow(Resp.Master2)
Resp.Master2
Resp.Master2 <- merge(Master_SizeStand_dat, Resp.Master, by = c('Date','pH','Food','Run','Plate','Rep','Number'))
Resp.Master
Master_SizeStand_dat
Resp.Master
Resp.Master
Length_914           <- lengths         %>%
dplyr::filter(Date %in% '9/14/2021')  %>%
dplyr::select(c("Replicate","pH","Number","Food", "Run", "Food", "Plate", "Length_um"))
Dryweight_914        <- DWs_Len_914.930 %>%
dplyr::filter(Date %in% '20210914')   %>%
dplyr::filter(Purpose %in% 'resp_filtration') %>%
dplyr::rename(Replicate = Rep)        %>%
dplyr::rename(pH = Treatment)         %>%
dplyr::rename(Number = Num)           %>%
dplyr::select(c("Replicate","pH","Number", "Plate","Run","Scallop_DW_mg"))
DW_Len_914 <- merge(Length_914, Dryweight_914)
DW_Len_914$Date <- "9/14/2021"
DW_Len_914 %>% ggplot(aes(x = Length_um, y = Scallop_DW_mg)) +
geom_smooth(method = "lm", se=FALSE, color="black", formula = Scallop_DW_mg ~ Length_um) +
theme_classic() +
ylab("Whole animal dry weight (mg)") +
xlab("Shell length (um)") +
geom_point() +
geom_smooth(method='lm')
# 20210930 ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
Length_930           <- lengths         %>%
dplyr::filter(Date %in% '9/30/2021')  %>%
dplyr::select(c("Replicate","pH","Number", "Food", "Run", "Plate","Length_um"))
Dryweight_930        <- DWs_Len_914.930 %>%
dplyr::filter(Date %in% '20210930')   %>%
dplyr::filter(Purpose %in% 'resp_filtration') %>%
dplyr::rename(Number = Num)           %>%
dplyr::rename(Replicate = Rep)        %>%
dplyr::rename(pH = Treatment)         %>%
dplyr::rename(Food = Fed_unfed)       %>%
dplyr::select(c("Replicate","pH","Number", "Food", "Run", "Plate","Scallop_DW_mg"))
DW_Len_930 <- merge(Length_930, Dryweight_930)
DW_Len_930$Date <- "9/30/2021"
DW_Len_930 %>% ggplot(aes(x = Length_um, y = Scallop_DW_mg)) +
geom_smooth(method = "lm", se=FALSE, color="black", formula = Scallop_DW_mg ~ Length_um) +
theme_classic() +
ylab("Whole animal dry weight (mg)") +
xlab("Shell length (um)") +
geom_point() +
geom_smooth(method='lm') + # y~0+x if you want it through the origin (0,0)
facet_wrap(~Food)
# 20211026 ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
Length_1026_Unfed    <- lengths         %>%
dplyr::filter(Date %in% '10/26/2021') %>%
dplyr::select(c("Replicate","pH","Number", "Food", "Run", "Plate","Length_um"))
Dryweight_1026_Unfed <- DWs_Len_914.930 %>%
dplyr::filter(Date %in% '20211026')   %>%
dplyr::filter(Purpose %in% 'resp_filtration') %>%
dplyr::rename(Food = Fed_unfed)       %>%
dplyr::rename(Replicate = Rep)        %>%
dplyr::rename(pH = Treatment)         %>%
dplyr::rename(Number = Num)           %>%
dplyr::select(c("Replicate","pH","Number", "Food","Run", "Plate",  "Scallop_DW_mg"))
DW_Len_1026_unfed <- merge(Length_1026_Unfed, Dryweight_1026_Unfed)
DW_Len_1026_unfed$Date <- "10/26/2021"
# fed data - 'lengths' has the dry weight for shell and tissue in the 'fed' animals o 10/26/2021
DW_Len_1026_Fed    <- lengths           %>%
dplyr::filter(Date %in% '10/26/2021' & Food %in% 'fed') %>%
dplyr::rename(Rep = Replicate)        %>%
dplyr::select(c("Rep","pH","Number", "Food", "Run", "Plate","Length_um", 'Dry_Shell_weight', 'Dry_Tissue_weight')) %>% # call the dry weights that were complete separately
dplyr::mutate(Scallop_DW_mg = (Dry_Shell_weight + Dry_Tissue_weight)*1000) %>% # calculate the total animal dry weight and covert to mg ( *1000)- this corresponds with the data we have for smaller animals on previous dates
dplyr::select(!c('Dry_Tissue_weight','Dry_Shell_weight')) # omit these to merge to the master file ""
DW_Len_1026_Fed$Date <- "10/26/2021"
rbind(DW_Len_1026_Fed, DW_Len_1026_unfed) %>%
ggplot(aes(x = Length_um, y = Scallop_DW_mg)) +
geom_smooth(method = "lm", se=FALSE, color="black", formula = Scallop_DW_mg ~ Length_um) +
theme_classic() +
ylab("Whole animal dry weight (mg)") +
xlab("Shell length (um)") +
geom_point() +
geom_smooth(method='lm') + # y~0+x if you want it through the origin (0,0)
facet_wrap(~Food)
DW_Len_1026_unfed
# Explore the DW and shell length relationship in our data...
Master_SizeStand_dat      <- rbind(DW_Len_1026_unfed, DW_Len_1026_Fed, DW_Len_930, DW_Len_914)
Length_914           <- lengths         %>%
dplyr::filter(Date %in% '9/14/2021')  %>%
dplyr::select(c("Replicate","pH","Number","Food", "Run", "Food", "Plate", "Length_um"))
Dryweight_914        <- DWs_Len_914.930 %>%
dplyr::filter(Date %in% '20210914')   %>%
dplyr::filter(Purpose %in% 'resp_filtration') %>%
dplyr::rename(Replicate = Rep)        %>%
dplyr::rename(pH = Treatment)         %>%
dplyr::rename(Number = Num)           %>%
dplyr::select(c("Replicate","pH","Number", "Plate","Run","Scallop_DW_mg"))
DW_Len_914 <- merge(Length_914, Dryweight_914)
DW_Len_914$Date <- "9/14/2021"
DW_Len_914
Length_930           <- lengths         %>%
dplyr::filter(Date %in% '9/30/2021')  %>%
dplyr::select(c("Replicate","pH","Number", "Food", "Run", "Plate","Length_um"))
Dryweight_930        <- DWs_Len_914.930 %>%
dplyr::filter(Date %in% '20210930')   %>%
dplyr::filter(Purpose %in% 'resp_filtration') %>%
dplyr::rename(Number = Num)           %>%
dplyr::rename(Replicate = Rep)        %>%
dplyr::rename(pH = Treatment)         %>%
dplyr::rename(Food = Fed_unfed)       %>%
dplyr::select(c("Replicate","pH","Number", "Food", "Run", "Plate","Scallop_DW_mg"))
DW_Len_930 <- merge(Length_930, Dryweight_930)
DW_Len_930$Date <- "9/30/2021"
DW_Len_930 %>% ggplot(aes(x = Length_um, y = Scallop_DW_mg)) +
geom_smooth(method = "lm", se=FALSE, color="black", formula = Scallop_DW_mg ~ Length_um) +
theme_classic() +
ylab("Whole animal dry weight (mg)") +
xlab("Shell length (um)") +
geom_point() +
geom_smooth(method='lm') + # y~0+x if you want it through the origin (0,0)
facet_wrap(~Food)
# 20211026 ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
Length_1026_Unfed    <- lengths         %>%
dplyr::filter(Date %in% '10/26/2021') %>%
dplyr::select(c("Replicate","pH","Number", "Food", "Run", "Plate","Length_um"))
Dryweight_1026_Unfed <- DWs_Len_914.930 %>%
dplyr::filter(Date %in% '20211026')   %>%
dplyr::filter(Purpose %in% 'resp_filtration') %>%
dplyr::rename(Food = Fed_unfed)       %>%
dplyr::rename(Replicate = Rep)        %>%
dplyr::rename(pH = Treatment)         %>%
dplyr::rename(Number = Num)           %>%
dplyr::select(c("Replicate","pH","Number", "Food","Run", "Plate",  "Scallop_DW_mg"))
DW_Len_1026_unfed <- merge(Length_1026_Unfed, Dryweight_1026_Unfed)
DW_Len_1026_unfed$Date <- "10/26/2021"
DW_Len_1026_Fed    <- lengths           %>%
dplyr::filter(Date %in% '10/26/2021' & Food %in% 'fed') %>%
dplyr::select(c("Replicate","pH","Number", "Food", "Run", "Plate","Length_um", 'Dry_Shell_weight', 'Dry_Tissue_weight')) %>% # call the dry weights that were complete separately
dplyr::mutate(Scallop_DW_mg = (Dry_Shell_weight + Dry_Tissue_weight)*1000) %>% # calculate the total animal dry weight and covert to mg ( *1000)- this corresponds with the data we have for smaller animals on previous dates
dplyr::select(!c('Dry_Tissue_weight','Dry_Shell_weight')) # omit these to merge to the master file ""
DW_Len_1026_Fed$Date <- "10/26/2021"
# Explore the DW and shell length relationship in our data...
Master_SizeStand_dat      <- rbind(DW_Len_1026_unfed, DW_Len_1026_Fed, DW_Len_930, DW_Len_914)
Resp.Master2 <- merge(Master_SizeStand_dat, Resp.Master, by = c('Date','pH','Food','Run','Plate','Rep','Number'))
Resp.Master2 <- merge(Master_SizeStand_dat, Resp.Master, by = c('Date','pH','Food','Run','Plate','Replicate','Number'))
nrow(Resp.Master2)
Resp.Master2
View(Resp.Master2)
Master_SizeStand_dat2 <- Master_SizeStand_dat %>%  dplyr::select(!Length_um)
Resp.Master2 <- merge(Master_SizeStand_dat2, Resp.Master, by = c('Date','pH','Food','Run','Plate','Replicate','Number'))
nrow(Resp.Master2)
Resp.Master_OM <- Resp.Master2 %>% dplyr::filter(!resp_blankStand > 0) %>% # ommit respiration values that are positive
dplyr::mutate(volume = case_when(filetype == "LoLigo_data" & Date == '9/14/2021' ~ 1.7, # small vessels for loligo system
filetype == "LoLigo_data" & Date == '10/26/2021' & Channel == 'CH1' ~ 68.55323, # larger custom vessels measured individually...
filetype == "LoLigo_data" & Date == '10/26/2021' & Channel == 'CH2' ~ 68.85583, # larger custom vessels measured individually...
filetype == "LoLigo_data" & Date == '10/26/2021' & Channel == 'CH3' ~ 68.87473, # larger custom vessels measured individually...
filetype == "LoLigo_data" & Date == '10/26/2021' & Channel == 'CH4' ~ 68.95481, # larger custom vessels measured individually...
filetype == "LoLigo_data" & Date == '10/26/2021' & Channel == 'CH5' ~ 68.57288, # larger custom vessels measured individually...
filetype == "LoLigo_data" & Date == '10/26/2021' & Channel == 'CH6' ~ 68.01878, # larger custom vessels measured individually...
filetype == "LoLigo_data" & Date == '10/26/2021' & Channel == 'CH7' ~ 68.54551, # larger custom vessels measured individually...
filetype == "LoLigo_data" & Date == '10/26/2021' & Channel == 'CH8' ~ 68.53297, # larger custom vessels measured individually...
filetype == "SDR_data" ~ 2.2)) %>% # 24-well plate
dplyr::mutate(Age = case_when(Date == '9/14/2021' ~ 50, Date == '9/30/2021' ~ 66, Date == '10/26/2021' ~ 92)) %>%
dplyr::mutate(Fed_Unfed = case_when(Fed_Unfed == 'F' ~ "High food", is.na(Fed_Unfed) ~ "High food", Fed_Unfed == 'U' ~ "Low food")) %>%
dplyr::mutate(pCO2 = case_when(pH == 8.0 ~ "500 μatm", pH == 7.5 ~ "800 μatm"))
Resp.outliers <- Resp.Master %>% dplyr::filter(resp_blankStand > 0) # call the values with positive resp rates, measing they were slower than the blank!
print(Resp.outliers)
Resp.Master_OM$resp_volStand_mg_L_hr <- ( (abs(Resp.Master_OM$resp_blankStand)) * # call absolute value of resp in mg per minute - convert to ng min-1
(Resp.Master_OM$volume/1000) ) * 60
Resp.Master_OMLen <- Resp.Master_OM[!is.na(Resp.Master_OM$Length_um),]
summarySE(Resp.Master_OMLen, measurevar="Length_um")
print(paste( "Median shell length 9/14-10/26 = ", median(Resp.Master_OMLen$Length_um))) # 3148.36
# NORMALIZED for Shell Size (Length)
Resp.Master_OM$resp_µmol_L_m_Length_hr <- (
( ( (abs(Resp.Master_OM$resp_blankStand)) * # call absolute value of resp in mg per minute -  mg O2 L-1 per min-1
(Resp.Master_OM$volume/1000) ) * # mg per Liter, correct for vial volume 9in mL convert to Liters
(1/32) * # converted mg L to mmol/L O2 (molar mass of O2 is 32 grams)
(1000) ) / # multiple by 1000 to convert mmol/ O2 to umol/L O2
(Resp.Master_OM$Length_um/1000000)) * # normalize by Dry tissue weight  as to mg O2 L-1 g dry tissue weight-1
(60) # correct for the time; final value is ug O2 Liter -1 mg dry tissue weight-1 hour-1
Resp.Master_OM$Scallop_DW_mg <- as.numeric(Resp.Master_OM$Scallop_DW_mg )
Resp.Master_OM$resp_µmol_L_g_hr <- ( # NORMALIZED for Dry Tissue Weight
( ( (abs(Resp.Master_OM$resp_blankStand)) * # call absolute value of resp in mg per minute -  mg O2 L-1 per min-1
(Resp.Master_OM$volume/1000) ) * # mg per Liter, correct for vial volume 9in mL convert to Liters
(1/32) * # converted mg L to mmol/L O2 (molar mass of O2 is 32 grams)
(1000) ) / # multiple by 1000 to convert mmol/ O2 to umol/L O2
(Resp.Master_OM$Scallop_DW_mg/1000)) * # normalize by Dry tissue weight  as to mg O2 L-1 g dry tissue weight-1
(60) # correct for the time; final value is ug O2 Liter -1 mg dry tissue weight-1 hour-1
RespSumTab_Len      <- Resp.Master_OM[!is.na(Resp.Master_OM$resp_µmol_L_m_Length_hr),] %>%
summarySE(measurevar="resp_µmol_L_m_Length_hr", groupvars=c("Age", "pCO2", "Fed_Unfed"))
RespSumTab_Len$pCO2 <- factor(RespSumTab_Len$pCO2, c("500 μatm","800 μatm"))
## Use geom_line and geom_point to plot over time
Resp_LengthStand    <- ggplot(data=RespSumTab_Len, aes(x=Age, y=resp_µmol_L_m_Length_hr, color=pCO2)) +
geom_line(aes(linetype = factor(Fed_Unfed)), size = 0.5) +
geom_point()+
scale_color_manual(values=c("forestgreen","darkorange2"))+
geom_errorbar(aes(ymin=resp_µmol_L_m_Length_hr-se, ymax=resp_µmol_L_m_Length_hr+se), width=.2,
position=position_dodge(.1))+
theme_bw() +  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
scale_x_continuous(name ="Age (days)") +
labs(title = "F1 Scallops: Food x OA Experiment",
y = expression(Respiration~rate~"("~μmol~L^{-1}~O[2]%.%m^{-1}~shell~length%.% hr^{-1}~")")) +
scale_linetype_manual(values = c("High food" = "solid", "Low food" = "dashed"))  +
theme(legend.position="none") +
# facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
facet_wrap(~pCO2)
Resp_LengthStand
RespSumTab_DW      <- Resp.Master_OM[!is.na(Resp.Master_OM$resp_µmol_L_g_hr),] %>%
summarySE(measurevar="resp_µmol_L_g_hr", groupvars=c("Age", "pCO2", "Fed_Unfed"))
RespSumTab_DW$pCO2 <- factor(RespSumTab_DW$pCO2, c("500 μatm","800 μatm"))
## Use geom_line and geom_point to plot over time
Resp_DryWgtStand   <- ggplot(data=RespSumTab_DW, aes(x=Age, y=resp_µmol_L_g_hr, color=pCO2)) +
geom_line(aes(linetype = factor(Fed_Unfed)), size = 0.5) +
geom_point()+
scale_color_manual(values=c("forestgreen","darkorange2"))+
geom_errorbar(aes(ymin=resp_µmol_L_g_hr-se, ymax=resp_µmol_L_g_hr+se), width=.2,
position=position_dodge(.1))+
theme_bw() +  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
scale_x_continuous(name ="Age (days)") +
labs(title = "F1 Scallops: Food x OA Experiment",
y = expression(Respiration~rate~"("~μmol~L^{-1}~O[2]%.%g^{-1}~DW%.% hr^{-1}~")")) +
scale_linetype_manual(values = c("High food" = "solid", "Low food" = "dashed"))  +
theme(legend.position="none") +
# facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food')))
facet_wrap(~pCO2)
Resp_DryWgtStand
# model effect of treatment on resp rate 20210507
Resp_0914 <- Resp.Master_OM %>%
dplyr::filter(Date %in% '9/14/2021')  %>% # call only 9/14
dplyr::filter(!Chamber_tank  %in% 'blank')
Resp_0914 %>% dplyr::group_by(Chamber_tank) %>% dplyr::summarise(n()) # tank replication
LMmod_0914_SL <- aov(lm(resp_µmol_L_m_Length_hr~pCO2,data=Resp_0914))
pander(summary(LMmod_0914_SL), style='rmarkdown')
check_model(LMmod_0914_SL) # observe the diagnostics of the model
shapiro.test(residuals(LMmod_0914_SL)) #  normal - 0.3875
leveneTest(LMmod_0914_SL) # good - 0.6186
Resp_0930 <- Resp.Master_OM %>%
dplyr::filter(Date %in% '9/30/2021')  %>% # call only 9/14
dplyr::select(-Center)
Resp_0930 %>% dplyr::group_by(Chamber_tank, Food ) %>% dplyr::summarise(n()) # tank replication
LMmod_0930_SL <- aov(lm(resp_µmol_L_m_Length_hr~pCO2*Food,data=Resp_0930))
pander(summary(LMmod_0930_SL), style='rmarkdown')
check_model(LMmod_0930_SL) # observe the diagnostics of the model
shapiro.test(residuals(LMmod_0930_SL)) #  normal - 0.3875
leveneTest(LMmod_0930_SL) # good - 0.6186
check_model(LMmod_0930_SL) # observe the diagnostics of the model
shapiro.test(residuals(LMmod_0930_SL)) #  normal - 0.3875
LMmod_0930_SL <- aov(lm(resp_µmol_L_m_Length_hr~pCO2*Food,data=Resp_0930))
pander(summary(LMmod_0930_SL), style='rmarkdown')
ggplot(Resp_0930, aes(x = factor(pCO2, level = c('500 μatm', '800 μatm')), resp_µmol_L_m_Length_hr , fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, width=0.5, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("white","grey50")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
scale_x_discrete(labels= c('~500 μatm', '~800 μatm')) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 120)) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
labs(title = "F1 Scallops: respiration rates on 20210930 (shell length stand.)",
y = expression(Respiration~rate~"("~μmol~L^{-1}~O[2]%.%m^{-1}~shell~length%.% hr^{-1}~")"),
x = expression(italic(p)*CO[2]~Treatment~"("~μ*atm~")"))  +
facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food'))) # +
Resp_0930
LMmod_0930_DW <- aov(lm(resp_µmol_L_g_hr~pCO2*Food,data=Resp_0930))
pander(summary(LMmod_0930_DW), style='rmarkdown')
check_model(LMmod_0930_DW) # observe the diagnostics of the model
shapiro.test(residuals(LMmod_0930_DW)) #  normal - 0.3875
leveneTest(LMmod_0930_DW) # good - 0.6186
ggplot(Resp_0930, aes(x = factor(pCO2, level = c('500 μatm', '800 μatm')), resp_µmol_L_g_hr , fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, width=0.5, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("white","grey50")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
scale_x_discrete(labels= c('~500 μatm', '~800 μatm')) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 200)) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
labs(title = "F1 Scallops: respiration rates on 20210930 (whole dry weight stand.)",
y = expression(Respiration~rate~"("~μmol~L^{-1}~O[2]%.%g^{-1}~DW%.% hr^{-1}~")"),
x = expression(italic(p)*CO[2]~Treatment~"("~μ*atm~")"))  +
facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food'))) # +
Resp_01026 <- Resp.Master_OM %>%
dplyr::filter(Date %in% '10/26/2021')  %>% # call only 10/14
dplyr::select(-Center)
Resp_01026 %>% dplyr::group_by(Chamber_tank, Food ) %>% dplyr::summarise(n()) # tank replication
LMmod_01026_SL <- aov(lm(resp_µmol_L_m_Length_hr~pCO2*Food,data=Resp_01026))
pander(summary(LMmod_01026_SL), style='rmarkdown')
check_model(LMmod_01026_SL) # observe the diagnostics of the model
shapiro.test(residuals(LMmod_01026_SL)) #  normal - 0.3875
leveneTest(LMmod_01026_SL) # good - 0.6186
ggplot(Resp_01026, aes(x = factor(pCO2, level = c('500 μatm', '800 μatm')), resp_µmol_L_m_Length_hr , fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, width=0.5, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("white","grey50")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
scale_x_discrete(labels= c('~500 μatm', '~800 μatm')) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 250)) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
labs(title = "F1 Scallops: respiration rates on 202101026 (shell length stand.)",
y = expression(Respiration~rate~"("~μmol~L^{-1}~O[2]%.%m^{-1}~shell~length%.% hr^{-1}~")"),
x = expression(italic(p)*CO[2]~Treatment~"("~μ*atm~")"))  +
facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food'))) # +
LMmod_01026_DW <- aov(lm(resp_µmol_L_g_hr~pCO2*Food,data=Resp_01026))
pander(summary(LMmod_01026_DW), style='rmarkdown')
check_model(LMmod_01026_DW) # observe the diagnostics of the model
shapiro.test(residuals(LMmod_01026_DW)) #  normal - 0.3875
leveneTest(LMmod_01026_DW) # good - 0.6186
ggplot(Resp_01026, aes(x = factor(pCO2, level = c('500 μatm', '800 μatm')), resp_µmol_L_g_hr , fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, width=0.5, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("white","grey50")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
scale_x_discrete(labels= c('~500 μatm', '~800 μatm')) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 150)) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
labs(title = "F1 Scallops: respiration rates on 202101026 (whole dry weight stand.)",
y = expression(Respiration~rate~"("~μmol~L^{-1}~O[2]%.%g^{-1}~DW%.% hr^{-1}~")"),
x = expression(italic(p)*CO[2]~Treatment~"("~μ*atm~")"))  +
facet_wrap(~factor(Fed_Unfed, level = c('Low food', 'High food'))) # +
