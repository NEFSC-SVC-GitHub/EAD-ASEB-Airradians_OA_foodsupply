#  theme
theme_classic() +
#xlim(0, 20) +
facet_grid(pH ~ .)
denisty_box_CI_92DPF <-ggplot(p.box.data) +
# manually plot flipped boxplot
geom_segment(aes(x = ymin, xend = ymax, y = -0.2, yend = -0.2)) +
geom_rect(aes(xmin = lower, xmax = upper, ymin = -0.25, ymax = -0.15,  fill = pH),color = "black") +
geom_point(data = . %>% unnest(outliers), aes(x = outliers, y = -0.2), color = "grey60", size = 1) +
# vertical lines at Q1 / Q2 / Q3
geom_vline(data = . %>% select(pH, lower, mean, upper) %>% gather(key, value, -pH), aes(xintercept = value)) +
# density plot
geom_density(data = LMEmod_CI_1026.DATA, aes(x = CI, fill=pH, ..scaled..), alpha=.4) +
#  theme
theme_classic() +
#xlim(0, 20) +
facet_grid(pH ~ .) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), legend.position = "none", plot.title = element_text(size=10))+
labs(x = "Condition index", y = "Scaled density")  +
scale_fill_manual(values=c("grey40", "grey85"))
denisty_box_CI_92DPF
LMEmod_CI_1026.DATA
# Linear mixed effects model
levels(LMEmod_CI_1026.DATA$pH_Replicate)
CI_1026 <- len.dryweight.CI_1026[!is.na(len.dryweight.CI_1026$CI),] %>%
dplyr::select(c('pH','CI','Tank_Replicate')) %>%
dplyr::mutate(Age = "64DPF") %>%
dplyr::mutate(pH_Replicate = (as.factor(paste(pH,Age, Tank_Replicate, sep ='_')))) %>%
dplyr::mutate(pH_Age = (as.factor(paste(pH,Age, sep = '_')))) %>%
dplyr::select(-Tank_Replicate)
CI_1202 <- len.dryweight.CI_1202[!is.na(len.dryweight.CI_1202$Condition_index_drywtRatio_Walne1976),] %>%
dplyr::select(c('pH','Condition_index_drywtRatio_Walne1976', 'pH_Replicate')) %>%
dplyr::rename(CI = Condition_index_drywtRatio_Walne1976) %>%
dplyr::mutate(Age = "139DPF") %>%
dplyr::mutate(pH_Age = (as.factor(paste(pH,Age, sep = '_'))))
Master_CI_raw
len.dryweight.CI_1026
CI_1026 <- len.dryweight.CI_1026[!is.na(len.dryweight.CI_1026$CI),] %>%
dplyr::select(c('pH','CI','Tank_Replicate')) %>%
dplyr::mutate(Age = "64DPF") %>%
dplyr::mutate(random_eff = (as.factor(paste(pH,Tank_Replicate, sep ='_')))) %>%
dplyr::mutate(pH_Age = (as.factor(paste(pH,Age, sep = '_')))) %>%
dplyr::select(-Tank_Replicate)
CI_1202 <- len.dryweight.CI_1202[!is.na(len.dryweight.CI_1202$Condition_index_drywtRatio_Walne1976),] %>%
dplyr::select(c('pH','Condition_index_drywtRatio_Walne1976')) %>%
dplyr::rename(CI = Condition_index_drywtRatio_Walne1976) %>%
dplyr::mutate(random_eff = (as.factor(paste(pH,Tank_Replicate, sep ='_')))) %>%
dplyr::mutate(Age = "139DPF") %>%
dplyr::mutate(pH_Age = (as.factor(paste(pH,Age, sep = '_'))))
CI_1202 <- len.dryweight.CI_1202[!is.na(len.dryweight.CI_1202$Condition_index_drywtRatio_Walne1976),] %>%
dplyr::select(c('pH','Condition_index_drywtRatio_Walne1976')) %>%
dplyr::rename(CI = Condition_index_drywtRatio_Walne1976) %>%
dplyr::mutate(random_eff = (as.factor(paste(pH,Rep, sep ='_')))) %>%
dplyr::mutate(Age = "139DPF") %>%
dplyr::mutate(pH_Age = (as.factor(paste(pH,Age, sep = '_'))))
CI_1202 <- len.dryweight.CI_1202[!is.na(len.dryweight.CI_1202$Condition_index_drywtRatio_Walne1976),] %>%
dplyr::select(c('pH','Condition_index_drywtRatio_Walne1976', 'Tank_Replicate')) %>%
dplyr::rename(CI = Condition_index_drywtRatio_Walne1976) %>%
dplyr::mutate(random_eff = (as.factor(paste(pH,Rep, sep ='_')))) %>%
dplyr::mutate(Age = "139DPF") %>%
dplyr::mutate(pH_Age = (as.factor(paste(pH,Age, sep = '_'))))
len.dryweight.CI_1202
CI_1202 <- len.dryweight.CI_1202[!is.na(len.dryweight.CI_1202$Condition_index_drywtRatio_Walne1976),] %>%
dplyr::select(c('pH','Condition_index_drywtRatio_Walne1976', 'Tank_Replicate')) %>%
dplyr::rename(CI = Condition_index_drywtRatio_Walne1976) %>%
dplyr::mutate(random_eff = (as.factor(paste(pH,Tank_Replicate, sep ='_')))) %>%
dplyr::mutate(Age = "139DPF") %>%
dplyr::mutate(pH_Age = (as.factor(paste(pH,Age, sep = '_'))))
Master_CI_raw <- rbind(CI_1026, CI_1202) %>% dplyr::filter(CI > 0) # ommit values with negative CI (poor data due to error)
CI_1026 <- len.dryweight.CI_1026[!is.na(len.dryweight.CI_1026$CI),] %>%
dplyr::select(c('pH','CI','Tank_Replicate')) %>%
dplyr::mutate(Age = "64DPF") %>%
dplyr::mutate(random_eff = (as.factor(paste(pH,Tank_Replicate, sep ='_')))) %>%
dplyr::mutate(pH_Age = (as.factor(paste(pH,Age, sep = '_')))) %>%
dplyr::select(-Tank_Replicate)
CI_1202 <- len.dryweight.CI_1202[!is.na(len.dryweight.CI_1202$Condition_index_drywtRatio_Walne1976),] %>%
dplyr::select(c('pH','Condition_index_drywtRatio_Walne1976', 'Tank_Replicate')) %>%
dplyr::rename(CI = Condition_index_drywtRatio_Walne1976) %>%
dplyr::mutate(random_eff = (as.factor(paste(pH,Tank_Replicate, sep ='_')))) %>%
dplyr::mutate(Age = "139DPF") %>%
dplyr::mutate(pH_Age = (as.factor(paste(pH,Age, sep = '_'))))
Master_CI_raw <- rbind(CI_1026, CI_1202) %>% dplyr::filter(CI > 0) # ommit values with negative CI (poor data due to error)
CI_1202
# merge the raw data
names(CI_1026)
CI_1202 <- len.dryweight.CI_1202[!is.na(len.dryweight.CI_1202$Condition_index_drywtRatio_Walne1976),] %>%
dplyr::select(c('pH','Condition_index_drywtRatio_Walne1976', 'Tank_Replicate')) %>%
dplyr::rename(CI = Condition_index_drywtRatio_Walne1976) %>%
dplyr::mutate(random_eff = (as.factor(paste(pH,Tank_Replicate, sep ='_')))) %>%
dplyr::mutate(Age = "139DPF") %>%
dplyr::mutate(pH_Age = (as.factor(paste(pH,Age, sep = '_')))) %>%
dplyr::select(-Tank_Replicate)
Master_CI_raw <- rbind(CI_1026, CI_1202) %>% dplyr::filter(CI > 0) # ommit values with negative CI (poor data due to error)
# Linear mixed effects model
levels(LMEmod_CI_1026.DATA$random_eff)
# 1026 data
# statistical approach to 20211026 (last time point of the food OA challenge BUT just the fed animals..)
LMEmod_CI_1026.DATA <- Master_CI_raw %>% dplyr::filter(Age %in% '64DPF') # filter the data from 20211026
# Linear mixed effects model
levels(LMEmod_CI_1026.DATA$random_eff)
levels(LMEmod_CI_1026.DATA$random_eff)
LMEmod_CI_1026      <- lme(CI ~ pH, random=~1|random_eff, data= LMEmod_CI_1026.DATA) # run the model with ranodom effect of the tank replicate within treatment
# |     &nbsp;      | numDF | denDF | F-value | p-value |
# |:---------------:|:-----:|:-----:|:-------:|:-------:|
# | **(Intercept)** |   1   |  80   |  1627   |    0    |
# |     **pH**      |   1   |   6   |  4.657  | 0.07428 | # marginal significant
pander(anova(LMEmod_CI_1026), style='rmarkdown') # print the model
LMEmod_CI_1026      <- lm(CI ~ pH, data= LMEmod_CI_1026.DATA) # run the model with ranodom effect of the tank replicate within treatment
# |     &nbsp;      | numDF | denDF | F-value | p-value |
# |:---------------:|:-----:|:-----:|:-------:|:-------:|
# | **(Intercept)** |   1   |  80   |  1627   |    0    |
# |     **pH**      |   1   |   6   |  4.657  | 0.07428 | # marginal significant
pander(anova(LMEmod_CI_1026), style='rmarkdown') # print the model
Master_CI_raw <- rbind(CI_1026, CI_1202)
# 1026 data
# statistical approach to 20211026 (last time point of the food OA challenge BUT just the fed animals..)
LMEmod_CI_1026.DATA <- Master_CI_raw %>% dplyr::filter(Age %in% '64DPF') # filter the data from 20211026
levels(LMEmod_CI_1026.DATA$random_eff) # should be 8 levels A B C D within 7.5 and 8
LMEmod_CI_1026      <- lme(CI ~ pH, random=~1|random_eff, data= LMEmod_CI_1026.DATA) # run the model with ranodom effect of the tank replicate within treatment
# |     &nbsp;      | numDF | denDF | F-value | p-value |
# |:---------------:|:-----:|:-----:|:-------:|:-------:|
# | **(Intercept)** |   1   |  80   |  1627   |    0    |
# |     **pH**      |   1   |   6   |  4.657  | 0.07428 | # marginal significant
pander(anova(LMEmod_CI_1026), style='rmarkdown') # print the model
# merge the raw data
Master_CI_raw <- rbind(CI_1026, CI_1202) %>% dplyr::filter(CI > 0) # ommit values with negative CI (poor data due to error)
LMEmod_CI_1026.DATA
df_mean <- LMEmod_CI_1026.DATA %>%
dplyr::group_by(pH) %>%
dplyr::summarize(average = mean(CI)) %>%
dplyr::ungroup()
p.box <- ggplot(LMEmod_CI_1026.DATA, aes(x = pH, y = CI)) + geom_boxplot() + geom_point(data= df_mean, mapping = aes(x = pH, y = average),
color="red")
p.box.data <- layer_data(p.box) %>%
select(x, ymin, lower, middle, upper, ymax, outliers, flipped_aes) %>%
dplyr::rename(mean = flipped_aes) %>%
dplyr::mutate(mean  = df_mean$average) %>%
mutate(pH = factor(x, labels = levels(LMEmod_CI_1026.DATA$pH), ordered = TRUE)) %>%
select(-x)
denisty_box_CI_92DPF <-ggplot(p.box.data) +
# manually plot flipped boxplot
geom_segment(aes(x = ymin, xend = ymax, y = -0.2, yend = -0.2)) +
geom_rect(aes(xmin = lower, xmax = upper, ymin = -0.25, ymax = -0.15,  fill = pH),color = "black") +
geom_point(data = . %>% unnest(outliers), aes(x = outliers, y = -0.2), color = "grey60", size = 1) +
# vertical lines at Q1 / Q2 / Q3
geom_vline(data = . %>% select(pH, lower, mean, upper) %>% gather(key, value, -pH), aes(xintercept = value)) +
# density plot
geom_density(data = LMEmod_CI_1026.DATA, aes(x = CI, fill=pH, ..scaled..), alpha=.4) +
#  theme
theme_classic() +
#xlim(0, 20) +
facet_grid(pH ~ .) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), legend.position = "none", plot.title = element_text(size=10))+
labs(x = "Condition index", y = "Scaled density")  +
scale_fill_manual(values=c("grey40", "grey85"))
df_mean <- LMEmod_CI_1026.DATA %>%
dplyr::group_by(pH) %>%
dplyr::summarize(average = mean(CI)) %>%
dplyr::ungroup()
p.box <- ggplot(LMEmod_CI_1026.DATA, aes(x = pH, y = CI)) + geom_boxplot() + geom_point(data= df_mean, mapping = aes(x = pH, y = average),
color="red")
p.box.data <- layer_data(p.box) %>%
select(x, ymin, lower, middle, upper, ymax, outliers, flipped_aes) %>%
dplyr::rename(mean = flipped_aes) %>%
dplyr::mutate(mean  = df_mean$average) %>%
mutate(pH = factor(x, labels = levels(LMEmod_CI_1026.DATA$pH), ordered = TRUE)) %>%
select(-x)
p.box
Master_CI_raw$pH <- as.factor(Master_CI_raw$pH)
# 1026 data
# statistical approach to 20211026 (last time point of the food OA challenge BUT just the fed animals..)
LMEmod_CI_1026.DATA <- Master_CI_raw %>% dplyr::filter(Age %in% '64DPF') # filter the data from 20211026
levels(LMEmod_CI_1026.DATA$random_eff) # should be 8 levels A B C D within 7.5 and 8
LMEmod_CI_1026      <- lme(CI ~ pH, random=~1|random_eff, data= LMEmod_CI_1026.DATA) # run the model with ranodom effect of the tank replicate within treatment
# |     &nbsp;      | numDF | denDF | F-value | p-value |
# |:---------------:|:-----:|:-----:|:-------:|:-------:|
# | **(Intercept)** |   1   |  80   |  1627   |    0    |
# |     **pH**      |   1   |   6   |  4.657  | 0.07428 | # marginal significant
pander(anova(LMEmod_CI_1026), style='rmarkdown') # print the model
df_mean <- LMEmod_CI_1026.DATA %>%
dplyr::group_by(pH) %>%
dplyr::summarize(average = mean(CI)) %>%
dplyr::ungroup()
p.box <- ggplot(LMEmod_CI_1026.DATA, aes(x = pH, y = CI)) + geom_boxplot() + geom_point(data= df_mean, mapping = aes(x = pH, y = average),
color="red")
p.box.data <- layer_data(p.box) %>%
select(x, ymin, lower, middle, upper, ymax, outliers, flipped_aes) %>%
dplyr::rename(mean = flipped_aes) %>%
dplyr::mutate(mean  = df_mean$average) %>%
mutate(pH = factor(x, labels = levels(LMEmod_CI_1026.DATA$pH), ordered = TRUE)) %>%
select(-x)
denisty_box_CI_92DPF <-ggplot(p.box.data) +
# manually plot flipped boxplot
geom_segment(aes(x = ymin, xend = ymax, y = -0.2, yend = -0.2)) +
geom_rect(aes(xmin = lower, xmax = upper, ymin = -0.25, ymax = -0.15,  fill = pH),color = "black") +
geom_point(data = . %>% unnest(outliers), aes(x = outliers, y = -0.2), color = "grey60", size = 1) +
# vertical lines at Q1 / Q2 / Q3
geom_vline(data = . %>% select(pH, lower, mean, upper) %>% gather(key, value, -pH), aes(xintercept = value)) +
# density plot
geom_density(data = LMEmod_CI_1026.DATA, aes(x = CI, fill=pH, ..scaled..), alpha=.4) +
#  theme
theme_classic() +
#xlim(0, 20) +
facet_grid(pH ~ .) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), legend.position = "none", plot.title = element_text(size=10))+
labs(x = "Condition index", y = "Scaled density")  +
scale_fill_manual(values=c("grey40", "grey85"))
denisty_box_CI_92DPF
# statistical approach to 20211026 (last time point of the food OA challenge BUT just the fed animals..)
LMEmod_CI_1202.DATA <- Master_CI_raw %>% dplyr::filter(Age %in% '139DPF') # filter the data from 20211202
LMEmod_CI_1202      <- lme(CI ~ pH, random=~1|random_eff, data= LMEmod_CI_1202.DATA) # run the model with ranodom effect of the tank replicate within treatment
# |     &nbsp;      | numDF | denDF | F-value | p-value |
# |:---------------:|:-----:|:-----:|:-------:|:-------:|
# | **(Intercept)** |   1   |  68   |  426.9  |    0    |
# |     **pH**      |   1   |   6   | 0.05716 |  0.819  |
pander(anova(LMEmod_CI_1202), style='rmarkdown') # print the model
pdf(paste0(filename = "C:/Users/samjg/Documents/Github_repositories/Airradians_OA-foodsupply/RAnalysis/Output/Survival_size/20211026_figs_table/20211026_CI_Fed_density_plot.pdf"), width = 4, height = 4)
denisty_box_CI_92DPF # print the model diagnostics
dev.off()
len.dryweight.CI_1026
len.dryweight.CI_1026
CI_1026 <- len.dryweight.CI_1026[!is.na(len.dryweight.CI_1026$CI),] %>%
summarySE(measurevar="CI", groupvars=c("pH")) %>%
dplyr::mutate(pCO2 = case_when(pH == 8  ~ "500 μatm", pH == 7.5 ~ "800 μatm")) %>% # cahmber volumes on different dates with
dplyr::mutate(Age = 92)
CI_1026
CI_1202 <- summarySE(len.dryweight.CI_1202, measurevar="Condition_index_drywtRatio_Walne1976", groupvars=c("pH")) %>%
dplyr::filter(Condition_index_drywtRatio_Walne1976 > 0) %>%
dplyr::mutate(pCO2 = case_when(pH == 8  ~ "500 μatm", pH == 7.5 ~ "800 μatm")) %>% # cahmber volumes on different dates with
dplyr::rename(CI = "Condition_index_drywtRatio_Walne1976") %>% # cahmber volumes on different dates with
dplyr::mutate(Age = 139)
Master_CI <- rbind(CI_1026, CI_1202)
ggplot(data=Master_CI, aes(x=Age, y=CI, color=pCO2)) +
geom_line( stat = "identity", size=1.0)+
geom_point(position=position_dodge(.5))+
scale_color_manual(values=c("forestgreen","darkorange2"))+
geom_errorbar(aes(ymin=CI-se, ymax=CI+se), width=.2,
position=position_dodge(.5))+
theme_classic() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
scale_y_continuous(name ="Condition index [(Dry tissue / dry shell) *100]")+
theme(text = element_text(size=15))
len.dryweight.CI_1026[!is.na(len.dryweight.CI_1026$CI),]
CI_1026 <- len.dryweight.CI_1026[!is.na(len.dryweight.CI_1026$CI),] %>%
summarySE(measurevar="CI", groupvars=c("pH")) %>%
dplyr::mutate(pCO2 = case_when(pH == 8  ~ "500 μatm", pH == 7.5 ~ "800 μatm")) %>% # cahmber volumes on different dates with
dplyr::mutate(Age = 92)
CI_1026
CI_1026_means <- len.dryweight.CI_1026[!is.na(len.dryweight.CI_1026$CI),] %>%
summarySE(measurevar="CI", groupvars=c("pH")) %>%
dplyr::mutate(pCO2 = case_when(pH == 8  ~ "500 μatm", pH == 7.5 ~ "800 μatm")) %>% # cahmber volumes on different dates with
dplyr::mutate(Age = 92)
CI_1202_means <- summarySE(len.dryweight.CI_1202, measurevar="Condition_index_drywtRatio_Walne1976", groupvars=c("pH")) %>%
dplyr::filter(Condition_index_drywtRatio_Walne1976 > 0) %>%
dplyr::mutate(pCO2 = case_when(pH == 8  ~ "500 μatm", pH == 7.5 ~ "800 μatm")) %>% # cahmber volumes on different dates with
dplyr::rename(CI = "Condition_index_drywtRatio_Walne1976") %>% # cahmber volumes on different dates with
dplyr::mutate(Age = 139)
Master_CI <- rbind(CI_1026_means, CI_1202_means)
ggplot(data=Master_CI, aes(x=Age, y=CI, color=pCO2)) +
geom_line( stat = "identity", size=1.0)+
geom_point(position=position_dodge(.5))+
scale_color_manual(values=c("forestgreen","darkorange2"))+
geom_errorbar(aes(ymin=CI-se, ymax=CI+se), width=.2,
position=position_dodge(.5))+
theme_classic() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
scale_y_continuous(name ="Condition index [(Dry tissue / dry shell) *100]")+
theme(text = element_text(size=15))
CI_1202_means
len.dryweight.CI_1202      <-read.csv(file="C:/Users/samjg/Documents/Github_repositories/Airradians_OA-foodsupply/RAnalysis/Data/Survival_Size/20211202_lengths_dryweights.csv", header = TRUE)
CI_1202_means <- summarySE(len.dryweight.CI_1202, measurevar="Condition_index_drywtRatio_Walne1976", groupvars=c("pH")) %>%
dplyr::filter(Condition_index_drywtRatio_Walne1976 > 0) %>%
dplyr::mutate(pCO2 = case_when(pH == 8  ~ "500 μatm", pH == 7.5 ~ "800 μatm")) %>% # cahmber volumes on different dates with
dplyr::rename(CI = "Condition_index_drywtRatio_Walne1976") %>% # cahmber volumes on different dates with
dplyr::mutate(Age = 139)
Master_CI <- rbind(CI_1026_means, CI_1202_means)
ggplot(data=Master_CI, aes(x=Age, y=CI, color=pCO2)) +
geom_line( stat = "identity", size=1.0)+
geom_point(position=position_dodge(.5))+
scale_color_manual(values=c("forestgreen","darkorange2"))+
geom_errorbar(aes(ymin=CI-se, ymax=CI+se), width=.2,
position=position_dodge(.5))+
theme_classic() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
scale_y_continuous(name ="Condition index [(Dry tissue / dry shell) *100]")+
theme(text = element_text(size=15))
# statistical approach to 20211026 (last time point of the food OA challenge BUT just the fed animals..)
LMEmod_CI_1202.DATA <- Master_CI_raw %>% dplyr::filter(Age %in% '139DPF') # filter the data from 20211202
LMEmod_CI_1202      <- lme(CI ~ pH, random=~1|random_eff, data= LMEmod_CI_1202.DATA) # run the model with ranodom effect of the tank replicate within treatment
# |     &nbsp;      | numDF | denDF | F-value |  p-value  |
# |:---------------:|:-----:|:-----:|:-------:|:---------:|
# | **(Intercept)** |   1   |  69   |  75.21  | 1.179e-12 |
# |     **pH**      |   1   |   6   | 0.1874  |  0.6802   |
pander(anova(LMEmod_CI_1202), style='rmarkdown') # print the model
denisty_box_CI_92DPF
LMEmod_CI_1202.DATA
len.dryweight.CI_1026
CI_1202 <- len.dryweight.CI_1202[!is.na(len.dryweight.CI_1202$Condition_index_drywtRatio_Walne1976),] %>%
dplyr::select(c('pH','Condition_index_drywtRatio_Walne1976', 'Tank_Replicate', "Shell_length_mm")) %>%
dplyr::rename(CI = Condition_index_drywtRatio_Walne1976) %>%
dplyr::mutate(random_eff = (as.factor(paste(pH,Tank_Replicate, sep ='_')))) %>%
dplyr::mutate(Age = "139DPF") %>%
dplyr::mutate(pH_Age = (as.factor(paste(pH,Age, sep = '_')))) %>%
dplyr::select(-Tank_Replicate)
CI_1026 <- len.dryweight.CI_1026[!is.na(len.dryweight.CI_1026$CI),] %>%
dplyr::select(c('pH','CI','Tank_Replicate', "Shell_length_mm")) %>%
dplyr::mutate(Age = "64DPF") %>%
dplyr::mutate(random_eff = (as.factor(paste(pH,Tank_Replicate, sep ='_')))) %>%
dplyr::mutate(pH_Age = (as.factor(paste(pH,Age, sep = '_')))) %>%
dplyr::select(-Tank_Replicate)
# merge the raw data
Master_CI_raw <- rbind(CI_1026, CI_1202) %>% dplyr::filter(CI > 0) # ommit values with negative CI (poor data due to error)
Master_CI_raw$pH <- as.factor(Master_CI_raw$pH)
LMEmod_CI_1202.DATA <- Master_CI_raw %>% dplyr::filter(Age %in% '139DPF')
LMEmod_CI_1202.DATA
LMEmod_CI_1202.DATA <- Master_CI_raw %>% dplyr::filter(Age %in% '139DPF')  %>%
mutate(size_class = as.factor(case_when(Shell_length_mm < 7 ~ "small",  Shell_length_mm > 7 & Shell_length_mm < 15 ~ "mid", Shell_length_mm > 15 ~ "large")))
LMEmod_CI_1202.DATA
# statistical approach to 20211026 (last time point of the food OA challenge BUT just the fed animals..)
LMEmod_CI_1202.DATA <- Master_CI_raw %>% dplyr::filter(Age %in% '139DPF')  %>%
mutate(size_class = as.factor(case_when(Shell_length_mm < 7 ~ "small",  Shell_length_mm > 7 & Shell_length_mm < 14.5 ~ "mid", Shell_length_mm > 14.5 ~ "large"))) # filter the data from 20211202
LMEmod_CI_1202.DATA
# statistical approach to 20211026 (last time point of the food OA challenge BUT just the fed animals..)
LMEmod_CI_1202.DATA <- Master_CI_raw %>% dplyr::filter(Age %in% '139DPF')  %>%
mutate(size_class = as.factor(case_when(Shell_length_mm < 7 ~ "small",  Shell_length_mm > 7 & Shell_length_mm < 14.05 ~ "mid", Shell_length_mm > 14.05 ~ "large"))) # filter the data from 20211202
LMEmod_CI_1202.DATA
# plot the desnity boxplot
CI_mean <- Master_CI_raw %>%
dplyr::group_by(pH_Age, Shell_length_mm) %>%
dplyr::summarize(average = mean(CI)) %>%
dplyr::ungroup()
# plot the desnity boxplot
CI_mean <- Master_CI_raw %>%
dplyr::mutate(sizeclass_pH <- as.factor(paste(pH_Age, size_class, sep = '_')))
# plot the desnity boxplot
CI_mean <- Master_CI_raw %>%
dplyr::mutate(sizeclass_pH <- as.factor(paste(pH_Age, size_class, sep = '_')))
# plot the desnity boxplot
CI_mean <- Master_CI_raw %>%
dplyr::mutate(sizeclass_pH = as.factor(paste(pH_Age, size_class, sep = '_')))
# plot the desnity boxplot
CI_mean <- Master_CI_raw %>%
dplyr::mutate(sizeclass_pH = as.factor(paste(pH_Age, size_class, sep = '_'))) %>%
dplyr::group_by(sizeclass_pH) %>%
dplyr::summarize(average = mean(CI)) %>%
dplyr::ungroup()
# statistical approach to 20211026 (last time point of the food OA challenge BUT just the fed animals..)
LMEmod_CI_1202.DATA <- Master_CI_raw %>% dplyr::filter(Age %in% '139DPF')  %>%
mutate(size_class = as.factor(case_when(Shell_length_mm < 7 ~ "small",  Shell_length_mm > 7 & Shell_length_mm < 14.05 ~ "mid", Shell_length_mm > 14.05 ~ "large"))) # filter the data from 20211202
# plot the desnity boxplot
CI_mean <- LMEmod_CI_1202.DATA %>%
dplyr::mutate(sizeclass_pH = as.factor(paste(pH_Age, size_class, sep = '_'))) %>%
dplyr::group_by(sizeclass_pH) %>%
dplyr::summarize(average = mean(CI)) %>%
dplyr::ungroup()
p.box <- ggplot(LMEmod_CI_1202.DATA, aes(x = sizeclass_pH, y = CI)) + geom_boxplot() + geom_point(data= CI_mean, mapping = aes(x = sizeclass_pH, y = average),
color="red")
p.box
# plot the desnity boxplot
CI_mean <- LMEmod_CI_1202.DATA %>%
dplyr::mutate(sizeclass_pH = as.factor(paste(pH_Age, size_class, sep = '_'))) %>%
dplyr::group_by(sizeclass_pH) %>%
dplyr::summarize(average = mean(CI)) %>%
dplyr::ungroup()
CI_mean
# plot the desnity boxplot
CI_mean <- LMEmod_CI_1202.DATA %>%
dplyr::mutate(sizeclass_pH = as.factor(paste(pH, size_class, sep = '_'))) %>%
dplyr::group_by(sizeclass_pH) %>%
dplyr::summarize(average = mean(CI)) %>%
dplyr::ungroup()
p.box <- ggplot(LMEmod_CI_1202.DATA, aes(x = sizeclass_pH, y = CI)) + geom_boxplot() + geom_point(data= CI_mean, mapping = aes(x = sizeclass_pH, y = average),
color="red")
p.box
# plot the desnity boxplot
CI_mean <- LMEmod_CI_1202.DATA %>%
dplyr::mutate(sizeclass_pH = as.factor(paste(pH, size_class, sep = '_'))) %>%
dplyr::group_by(sizeclass_pH) %>%
dplyr::summarize(average = mean(CI)) %>%
dplyr::ungroup()
CI_mean
p.box <- ggplot(LMEmod_CI_1202.DATA, aes(x = pH, y = CI)) + geom_boxplot() + geom_point(data= CI_mean, mapping = aes(x = sizeclass_pH, y = average),
color="red")
p.box
p.box <- ggplot(LMEmod_CI_1202.DATA, aes(x = sizeclass_pH, y = CI)) + geom_boxplot() + geom_point(data= CI_mean, mapping = aes(x = sizeclass_pH, y = average),
color="red")
p.box
p.box <- ggplot(LMEmod_CI_1202.DATA, aes(x = sizeclass, y = CI)) + geom_boxplot() + geom_point(data= CI_mean, mapping = aes(x = sizeclass_pH, y = average),
color="red")
p.box
# statistical approach to 20211026 (last time point of the food OA challenge BUT just the fed animals..)
LMEmod_CI_1202.DATA <- Master_CI_raw %>% dplyr::filter(Age %in% '139DPF')  %>%
mutate(size_class = as.factor(case_when(Shell_length_mm < 7 ~ "small",  Shell_length_mm > 7 & Shell_length_mm < 14.05 ~ "mid", Shell_length_mm > 14.05 ~ "large"))) # filter the data from 20211202
LMEmod_CI_1202.DATA
# statistical approach to 20211026 (last time point of the food OA challenge BUT just the fed animals..)
LMEmod_CI_1202.DATA <- Master_CI_raw %>% dplyr::filter(Age %in% '139DPF')  %>%
mutate(size_class = as.factor(case_when(Shell_length_mm < 7 ~ "small",  Shell_length_mm > 7 & Shell_length_mm < 14.05 ~ "mid", Shell_length_mm > 14.05 ~ "large"))) %>%  # filter the data from 20211202
dplyr::mutate(sizeclass_pH = as.factor(paste(pH, size_class, sep = '_'))) %>%
LMEmod_CI_1202      <- lme(CI ~ pH, random=~1|random_eff, data= LMEmod_CI_1202.DATA) # run the model with ranodom effect of the tank replicate within treatment
# statistical approach to 20211026 (last time point of the food OA challenge BUT just the fed animals..)
LMEmod_CI_1202.DATA <- Master_CI_raw %>% dplyr::filter(Age %in% '139DPF')  %>%
mutate(size_class = as.factor(case_when(Shell_length_mm < 7 ~ "small",  Shell_length_mm > 7 & Shell_length_mm < 14.05 ~ "mid", Shell_length_mm > 14.05 ~ "large"))) %>%  # filter the data from 20211202
dplyr::mutate(sizeclass_pH = as.factor(paste(pH, size_class, sep = '_')))
LMEmod_CI_1202.DATA
# plot the desnity boxplot
CI_mean <- LMEmod_CI_1202.DATA %>%
dplyr::group_by(sizeclass_pH) %>%
dplyr::summarize(average = mean(CI)) %>%
dplyr::ungroup()
p.box <- ggplot(LMEmod_CI_1202.DATA, aes(x = sizeclass_pH, y = CI)) + geom_boxplot() + geom_point(data= CI_mean, mapping = aes(x = sizeclass_pH, y = average),
color="red")
p.box
p.box.data <- layer_data(p.box) %>%
select(x, ymin, lower, middle, upper, ymax, outliers, flipped_aes) %>%
dplyr::rename(mean = flipped_aes) %>%
dplyr::mutate(mean  = CI_mean$average) %>%
mutate(sizeclass_pH = factor(x, labels = levels(LMEmod_CI_1202.DATA$sizeclass_pH), ordered = TRUE)) %>%
select(-x)
p.box.data
ggplot(p.box.data) +
# manually plot flipped boxplot
geom_segment(aes(x = ymin, xend = ymax, y = -0.075, yend = -0.075)) +
geom_rect(aes(xmin = lower, xmax = upper, ymin = -0.2, ymax = -0.05,  fill = sizeclass_pH),color = "black") +
geom_point(data = . %>% unnest(outliers), aes(x = outliers, y = -0.15), color = "grey60", size = 1) +
# vertical lines at Q1 / Q2 / Q3
geom_vline(data = . %>% select(sizeclass_pH, lower, mean, upper) %>% gather(key, value, -sizeclass_pH), aes(xintercept = value)) +
# density plot
geom_density(data = LMEmod_CI_1202.DATA, aes(x = CI, group=sizeclass_pH, fill=sizeclass_pH, ..scaled..), alpha=.4, adjust=1.5) +
#  theme
theme_classic() +
facet_grid(sizeclass_pH ~ .) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), legend.position = "none", plot.title = element_text(size=10))+
labs(title = "F1 Scallops: Condition index 20211026-20211202",
x = expression(Condition~index),
y = "Scaled density")
denisty_box_CI_1202 <-ggplot(p.box.data) +
# manually plot flipped boxplot
geom_segment(aes(x = ymin, xend = ymax, y = -0.075, yend = -0.075)) +
geom_rect(aes(xmin = lower, xmax = upper, ymin = -0.2, ymax = -0.05,  fill = sizeclass_pH),color = "black") +
geom_point(data = . %>% unnest(outliers), aes(x = outliers, y = -0.15), color = "grey60", size = 1) +
# vertical lines at Q1 / Q2 / Q3
geom_vline(data = . %>% select(sizeclass_pH, lower, mean, upper) %>% gather(key, value, -sizeclass_pH), aes(xintercept = value)) +
# density plot
geom_density(data = LMEmod_CI_1202.DATA, aes(x = CI, group=sizeclass_pH, fill=sizeclass_pH, ..scaled..), alpha=.4, adjust=1.5) +
#  theme
theme_classic() +
facet_grid(sizeclass_pH ~ .) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), legend.position = "none", plot.title = element_text(size=10))+
labs(title = "F1 Scallops: Condition index 20211026-20211202",
x = expression(Condition~index),
y = "Scaled density")
denisty_box_CI_1202
denisty_box_CI_1202 <-ggplot(p.box.data) +
# manually plot flipped boxplot
geom_segment(aes(x = ymin, xend = ymax, y = -0.075, yend = -0.075)) +
geom_rect(aes(xmin = lower, xmax = upper, ymin = -0.2, ymax = -0.05,  fill = sizeclass_pH),color = "black") +
geom_point(data = . %>% unnest(outliers), aes(x = outliers, y = -0.15), color = "grey60", size = 1) +
# vertical lines at Q1 / Q2 / Q3
geom_vline(data = . %>% select(sizeclass_pH, lower, mean, upper) %>% gather(key, value, -sizeclass_pH), aes(xintercept = value)) +
# density plot
geom_density(data = LMEmod_CI_1202.DATA, aes(x = CI, group=sizeclass_pH, fill=sizeclass_pH, ..scaled..), alpha=.4, adjust=1.5) +
#  theme
theme_classic() +
facet_grid(sizeclass_pH ~ .) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), legend.position = "none", plot.title = element_text(size=10))+
labs(title = "F1 Scallops: Condition index 20211202 BY SIZE CLASS",
x = expression(Condition~index),
y = "Scaled density")
denisty_box_CI_1202
# |     &nbsp;      | numDF | denDF | F-value | p-value |
# |:---------------:|:-----:|:-----:|:-------:|:-------:|
# | **(Intercept)** |   1   |  80   |  1627   |    0    |
# |     **pH**      |   1   |   6   |  4.657  | 0.07428 | # marginal significant
pander(anova(LMEmod_CI_1026), style='rmarkdown') # print the model
kable(as.data.frame(anova(LMEmod_CI_1026))) %>%  # save the table
kable_styling() %>%
save_kable(file = "C:/Users/samuel.gurr/Documents/Github_repositories/Airradians_OA-foodsupply/RAnalysis/Output/Survival_size/20211026_figs_table/20211026_CI_LME_Table.png", zoom = 1.5)
kable(as.data.frame(anova(LMEmod_CI_1026))) %>%  # save the table
kable_styling() %>%
save_kable(file = "C:/Users/samuel.gurr/Documents/Github_repositories/Airradians_OA-foodsupply/RAnalysis/Output/Survival_size/20211026_figs_table/20211026_CI_LME_Table.png", zoom = 1.5)
kable(as.data.frame(anova(LMEmod_CI_1026))) %>%  # save the table
kable_styling() %>%
save_kable(file = "C:/Users/samjg/Documents/Github_repositories/Airradians_OA-foodsupply/RAnalysis/Output/Survival_size/20211026_figs_table/20211026_CI_LME_Table.png", zoom = 1.5)
pdf(paste0(filename = "C:/Users/samjg/Documents/Github_repositories/Airradians_OA-foodsupply/RAnalysis/Output/Survival_size/20211026_figs_table/20211026_CI_LME_Diagnostics.pdf"))
check_model(LMEmod_CI_1026)  # model diagnostics
check_model(LMEmod_CI_1026)  # model diagnostics
dev.off()
shapiro.test(residuals(LMEmod_CI_1026)) # non-normal 8.769e-07
LMEmod_CI_1026      <- lme(log(CI) ~ pH, random=~1|random_eff, data= LMEmod_CI_1026.DATA) # run the model with ranodom effect of the tank replicate within treatment
# |     &nbsp;      | numDF | denDF | F-value | p-value |
# |:---------------:|:-----:|:-----:|:-------:|:-------:|
# | **(Intercept)** |   1   |  80   |  1627   |    0    |
# |     **pH**      |   1   |   6   |  4.657  | 0.07428 | # marginal significant
pander(anova(LMEmod_CI_1026), style='rmarkdown') # print the model
shapiro.test(residuals(LMEmod_CI_1026)) # non-normal 8.769e-07
LMEmod_CI_1026      <- lme(aqrt(CI) ~ pH, random=~1|random_eff, data= LMEmod_CI_1026.DATA) # run the model with ranodom effect of the tank replicate within treatment
LMEmod_CI_1026      <- lme(sqrt(CI) ~ pH, random=~1|random_eff, data= LMEmod_CI_1026.DATA) # run the model with ranodom effect of the tank replicate within treatment
# |     &nbsp;      | numDF | denDF | F-value | p-value |
# |:---------------:|:-----:|:-----:|:-------:|:-------:|
# | **(Intercept)** |   1   |  80   |  1627   |    0    |
# |     **pH**      |   1   |   6   |  4.657  | 0.07428 | # marginal significant
pander(anova(LMEmod_CI_1026), style='rmarkdown') # print the model
LMEmod_CI_1026      <- lme(sqrt(CI) ~ pH, random=~1|random_eff, data= LMEmod_CI_1026.DATA) # run the model with ranodom effect of the tank replicate within treatment
# |     &nbsp;      | numDF | denDF | F-value | p-value |
# |:---------------:|:-----:|:-----:|:-------:|:-------:|
# | **(Intercept)** |   1   |  80   |  1627   |    0    |
# |     **pH**      |   1   |   6   |  4.657  | 0.07428 | # marginal significant
pander(anova(LMEmod_CI_1026), style='rmarkdown') # print the model
shapiro.test(residuals(LMEmod_CI_1026)) # non-normal 8.769e-07
check_model(LMEmod_CI_1026)  # model diagnostics
LMEmod_CI_1026      <- lme(ln(CI) ~ pH, random=~1|random_eff, data= LMEmod_CI_1026.DATA) # run the model with ranodom effect of the tank replicate within treatment
summarySE(LMEmod_CI_1026.DATA, measurevar="CI", groupvars="pH")
