y = expression(Slope~"="~absolute~value~"("~Live~algae~cells~mL^{-1}~hour^{-1}~")"),
x = expression(italic(p)*CO[2]~Treatment~"("~mu*atm~")")) +
annotate("text", x=2, y= 25000, size = 4, label = "aov(slope~pH Treatment)") +
annotate("text", x=2, y= 24300, size = 4, label= paste('DF =',DF,'F =', signif(Fval, digits=3), 'p value =', signif(pval, digits=3), sep=" "))
# 20210930 DATA :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
ClearRate_Master[!is.na(ClearRate_Master$Cells_ml),] %>%
dplyr::filter(Date %in% 20210930) %>%
dplyr::mutate(pH_feed = paste(pH, Fed_Unfed, sep='_')) %>%
dplyr::mutate(Time._min = as.numeric(as.character(Time._min))) %>%
ggplot(aes(Time._min, Cells_ml, color=Replicate)) +
geom_point(shape=1, fill = "white", color = "black")+
ggtitle("RAW DATA: F1 Scallops, Clearance Rate 20210930")+
labs(y = expression(Live~algae~cells~"("~cells~mL^{-1}~")"),
x = expression(Time~"("~minutes~")")) +
theme(plot.title= element_text(size =16, face ="bold",
lineheight = 8, vjust=1), aspect.ratio=1)+
stat_smooth(method="lm", se = F) +
theme_bw() +
scale_shape_identity() +
facet_wrap( ~ pH_feed, scales = "free_x" )
# Clearance rate anlaysis for 9/30 data
ClearRate_Master.930       <- ClearRate_Master %>%
dplyr::filter(Date %in% 20210930) %>%
dplyr::mutate(uniq_Identifier = paste(pH, Fed_Unfed, "Run", Run, "Rep",Replicate, "Num", Number, sep='_'))
loop_930 <- as.data.frame(unique(ClearRate_Master.930$uniq_Identifier)) %>% dplyr::rename(ID = "unique(ClearRate_Master.930$uniq_Identifier)")
SlopeTable_930 <- data.frame() # run this before the loop
for(i in 1:nrow(loop_930)){
dat <- ClearRate_Master.930 %>%  filter(uniq_Identifier %in% loop_930[i,])
slope<- summary(lm((dat$Cells_ml) ~ as.numeric(dat$Time._min)))$coef[2,"Estimate"]
SLOPE  <- summary(lm((dat$Cells_ml) ~ as.numeric(dat$Time._min)))$r.squared
pval <- summary(lm((dat$Cells_ml) ~ as.numeric(dat$Time._min)))$coef[2,"Pr(>|t|)"]
mod  <- lm(as.numeric(dat$Time._min) ~ dat$Cells_ml)
norm_assum <- shapiro.test(resid(mod))
shapiro_pval <- norm_assum$p.value
# assign the data table
SLOPE.loop <- data.frame(matrix(nrow = 1, ncol = 6)) # create a new data table
colnames(SLOPE.loop) <- c('pH', 'Replicate', 'Fed_Unfed','slope', 'SLOPE', 'pval') # assign headers
SLOPE.loop$pH        <- gsub("_.*", "\\1", loop_930[i,])
SLOPE.loop$Replicate <- gsub("^(?:[^_]+_){5}([^_]+).*", "\\1", loop_930[i,])
SLOPE.loop$Fed_Unfed <- gsub("^(?:[^_]+_){1}([^_]+).*", "\\1", loop_930[i,])
SLOPE.loop$slope     <- slope * 60  # cells per mL per hour
SLOPE.loop$Number    <- gsub("^(?:[^_]+_){7}([^_]+).*", "\\1", loop_930[i,])
SLOPE.loop$SLOPE       <- SLOPE
SLOPE.loop$pval      <- pval
SLOPE.loop$shapiro_pval <- shapiro_pval
# loop additions
df <- data.frame(SLOPE.loop) # name dataframe for this single row
SlopeTable_930 <- rbind(SlopeTable_930,df) # bind to a cumulative list dataframe
print(SlopeTable_930) # show loop progress in the console
}# outside loo
SlopeTable_930
SLOPE_mod_930 <- aov(lm(slope ~ pH*Fed_Unfed, data= SlopeTable_930))
summary(SLOPE_mod_930)
DF.930   <- paste( (summary(SLOPE_mod_930)[[1]][["Df"]])[1], (summary(SLOPE_mod_930)[[1]][["Df"]])[2], sep = '/')
Fval.930 <- (summary(SLOPE_mod_930)[[1]][["F value"]])[1]
pval.930 <- (summary(SLOPE_mod_930)[[1]][["Pr(>F)"]])[1]
SlopeTable_930 %>%  mutate(pH_feed = paste(pH, Fed_Unfed, sep = '_')) %>%
ggplot(aes(pH , abs(slope) , fill = pH)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pH)) +
scale_fill_manual(values=c("grey50","white")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
scale_x_discrete(labels= c('Elevated (H)', 'Ambient (L)')) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
labs(title = "F1 Scallops: Slope algae cells/time - feeding rate trials 20210930",
y = expression(Slope~"="~absolute~value~"("~Live~algae~cells~mL^{-1}~hour^{-1}~")"),
x = expression(italic(p)*CO[2]~Treatment~"("~mu*atm~")")) +
facet_wrap(~ Fed_Unfed)
# 20210914 DATA :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
ClearRate_Master[!is.na(ClearRate_Master$Cells_ml),] %>%
dplyr::filter(Date %in% 20210914) %>%
dplyr::mutate(Time._min = as.numeric(as.character(Time._min))) %>%
ggplot(aes(Time._min, Cells_ml, color=Replicate)) +
geom_point(shape=1, color = "black")+
ggtitle("RAW DATA: F1 Scallops, Clearance Rate 20210914")+
labs(y = expression(Live~algae~cells~"("~cells~mL^{-1}~")"),
x = expression(Time~"("~minutes~")")) +
theme(plot.title= element_text(size =16, face ="bold",
lineheight = 8, vjust=1), aspect.ratio=1)+
stat_smooth(method="lm", se = F) +
theme_bw() +
scale_shape_identity() +
facet_wrap( ~ pH, scales = "free_x" )
# Clearance rate anlaysis for 9/30 data
ClearRate_Master.914 <- ClearRate_Master %>%
dplyr::filter(Date %in% 20210914) %>%
dplyr::mutate(uniq_Identifier = paste(pH, "Run", Run, "Rep",Replicate, "Num", Number, sep='_'))
loop_914 <- as.data.frame(unique(ClearRate_Master.914$uniq_Identifier)) %>% dplyr::rename(ID = "unique(ClearRate_Master.914$uniq_Identifier)")
SlopeTable_914 <- data.frame() # run this before the loop
for(i in 1:nrow(loop_914)){
dat <- ClearRate_Master.914 %>%  filter(uniq_Identifier %in% loop_914[i,])
slope<- summary(lm((dat$Cells_ml) ~ as.numeric(dat$Time._min)))$coef[2,"Estimate"]
SLOPE  <- summary(lm((dat$Cells_ml) ~ as.numeric(dat$Time._min)))$r.squared
pval <- summary(lm((dat$Cells_ml) ~ as.numeric(dat$Time._min)))$coef[2,"Pr(>|t|)"]
mod  <- lm(as.numeric(dat$Time._min) ~ dat$Cells_ml)
norm_assum <- shapiro.test(resid(mod))
shapiro_pval <- norm_assum$p.value
# assign the data table
SLOPE.loop <- data.frame(matrix(nrow = 1, ncol = 5)) # create a new data table
colnames(SLOPE.loop) <- c('pH', 'Replicate', 'slope', 'SLOPE', 'pval') # assign headers
SLOPE.loop$pH        <- gsub("_.*", "\\1", loop_914[i,])
SLOPE.loop$Replicate <- gsub("^(?:[^_]+_){4}([^_]+).*", "\\1", loop_914[i,])
SLOPE.loop$slope     <- slope * 60  # cells per mL per hour
SLOPE.loop$Number    <- gsub("^(?:[^_]+_){6}([^_]+).*", "\\1", loop_914[i,])
SLOPE.loop$SLOPE       <- SLOPE
SLOPE.loop$pval      <- pval
SLOPE.loop$shapiro_pval <- shapiro_pval
# loop additions
df <- data.frame(SLOPE.loop) # name dataframe for this single row
SlopeTable_914 <- rbind(SlopeTable_914,df) # bind to a cumulative list dataframe
# print(SlopeTable_914) # show loop progress in the console
}# outside loo
SlopeTable_914
SLOPE_mod_914 <- aov(lm(slope ~ pH, data= SlopeTable_914))
DF   <- paste( (summary(SLOPE_mod_914)[[1]][["Df"]])[1], (summary(SLOPE_mod_914)[[1]][["Df"]])[2], sep = '/')
Fval <- (summary(SLOPE_mod_914)[[1]][["F value"]])[1]
pval <- (summary(SLOPE_mod_914)[[1]][["Pr(>F)"]])[1]
ggplot(SlopeTable_914, aes(pH , abs(slope) , fill = pH)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pH)) +
scale_fill_manual(values=c("grey50","white")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
scale_x_discrete(labels= c('Elevated (H)', 'Ambient (L)')) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
labs(title = "F1 Scallops: Slope algae cells/time - feeding rate trials 20210914",
y = expression(Slope~"="~absolute~value~"("~Live~algae~cells~mL^{-1}~hour^{-1}~")"),
x = expression(italic(p)*CO[2]~Treatment~"("~mu*atm~")")) +
annotate("text", x=2, y= 25000, size = 4, label = "aov(slope~pH Treatment)") +
annotate("text", x=2, y= 24300, size = 4, label= paste('DF =',DF,'F =', signif(Fval, digits=3), 'p value =', signif(pval, digits=3), sep=" "))
# 20210930 DATA :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
ClearRate_Master[!is.na(ClearRate_Master$Cells_ml),] %>%
dplyr::filter(Date %in% 20210930) %>%
dplyr::mutate(pH_feed = paste(pH, Fed_Unfed, sep='_')) %>%
dplyr::mutate(Time._min = as.numeric(as.character(Time._min))) %>%
ggplot(aes(Time._min, Cells_ml, color=Replicate)) +
geom_point(shape=1, fill = "white", color = "black")+
ggtitle("RAW DATA: F1 Scallops, Clearance Rate 20210930")+
labs(y = expression(Live~algae~cells~"("~cells~mL^{-1}~")"),
x = expression(Time~"("~minutes~")")) +
theme(plot.title= element_text(size =16, face ="bold",
lineheight = 8, vjust=1), aspect.ratio=1)+
stat_smooth(method="lm", se = F) +
theme_bw() +
scale_shape_identity() +
facet_wrap( ~ pH_feed, scales = "free_x" )
# Clearance rate anlaysis for 9/30 data
ClearRate_Master.930       <- ClearRate_Master %>%
dplyr::filter(Date %in% 20210930) %>%
dplyr::mutate(uniq_Identifier = paste(pH, Fed_Unfed, "Run", Run, "Rep",Replicate, "Num", Number, sep='_'))
loop_930 <- as.data.frame(unique(ClearRate_Master.930$uniq_Identifier)) %>% dplyr::rename(ID = "unique(ClearRate_Master.930$uniq_Identifier)")
SlopeTable_930 <- data.frame() # run this before the loop
for(i in 1:nrow(loop_930)){
dat <- ClearRate_Master.930 %>%  filter(uniq_Identifier %in% loop_930[i,])
slope<- summary(lm((dat$Cells_ml) ~ as.numeric(dat$Time._min)))$coef[2,"Estimate"]
SLOPE  <- summary(lm((dat$Cells_ml) ~ as.numeric(dat$Time._min)))$r.squared
pval <- summary(lm((dat$Cells_ml) ~ as.numeric(dat$Time._min)))$coef[2,"Pr(>|t|)"]
mod  <- lm(as.numeric(dat$Time._min) ~ dat$Cells_ml)
norm_assum <- shapiro.test(resid(mod))
shapiro_pval <- norm_assum$p.value
# assign the data table
SLOPE.loop <- data.frame(matrix(nrow = 1, ncol = 6)) # create a new data table
colnames(SLOPE.loop) <- c('pH', 'Replicate', 'Fed_Unfed','slope', 'SLOPE', 'pval') # assign headers
SLOPE.loop$pH        <- gsub("_.*", "\\1", loop_930[i,])
SLOPE.loop$Replicate <- gsub("^(?:[^_]+_){5}([^_]+).*", "\\1", loop_930[i,])
SLOPE.loop$Fed_Unfed <- gsub("^(?:[^_]+_){1}([^_]+).*", "\\1", loop_930[i,])
SLOPE.loop$slope     <- slope * 60  # cells per mL per hour
SLOPE.loop$Number    <- gsub("^(?:[^_]+_){7}([^_]+).*", "\\1", loop_930[i,])
SLOPE.loop$SLOPE       <- SLOPE
SLOPE.loop$pval      <- pval
SLOPE.loop$shapiro_pval <- shapiro_pval
# loop additions
df <- data.frame(SLOPE.loop) # name dataframe for this single row
SlopeTable_930 <- rbind(SlopeTable_930,df) # bind to a cumulative list dataframe
#print(SlopeTable_930) # show loop progress in the console
}# outside loo
SlopeTable_930
SLOPE_mod_930 <- aov(lm(slope ~ pH*Fed_Unfed, data= SlopeTable_930))
summary(SLOPE_mod_930)
DF.930   <- paste( (summary(SLOPE_mod_930)[[1]][["Df"]])[1], (summary(SLOPE_mod_930)[[1]][["Df"]])[2], sep = '/')
Fval.930 <- (summary(SLOPE_mod_930)[[1]][["F value"]])[1]
pval.930 <- (summary(SLOPE_mod_930)[[1]][["Pr(>F)"]])[1]
SlopeTable_930 %>%  mutate(pH_feed = paste(pH, Fed_Unfed, sep = '_')) %>%
ggplot(aes(pH , abs(slope) , fill = pH)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pH)) +
scale_fill_manual(values=c("grey50","white")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
scale_x_discrete(labels= c('Elevated (H)', 'Ambient (L)')) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
labs(title = "F1 Scallops: Slope algae cells/time - feeding rate trials 20210930",
y = expression(Slope~"="~absolute~value~"("~Live~algae~cells~mL^{-1}~hour^{-1}~")"),
x = expression(italic(p)*CO[2]~Treatment~"("~mu*atm~")")) +
facet_wrap(~ Fed_Unfed)
# 20210914 DATA :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
ClearRate_Master[!is.na(ClearRate_Master$Cells_ml),] %>%
dplyr::filter(Date %in% 20210914) %>%
dplyr::mutate(Time._min = as.numeric(as.character(Time._min))) %>%
ggplot(aes(Time._min, Cells_ml, color=Replicate)) +
geom_point(shape=1, color = "black")+
ggtitle("RAW DATA: F1 Scallops, Clearance Rate 20210914")+
labs(y = expression(Live~algae~cells~"("~cells~mL^{-1}~")"),
x = expression(Time~"("~minutes~")")) +
theme(plot.title= element_text(size =16, face ="bold",
lineheight = 8, vjust=1), aspect.ratio=1)+
stat_smooth(method="lm", se = F) +
theme_bw() +
scale_shape_identity() +
facet_wrap( ~ pH, scales = "free_x" )
# Clearance rate anlaysis for 9/30 data
ClearRate_Master.914 <- ClearRate_Master %>%
dplyr::filter(Date %in% 20210914) %>%
dplyr::mutate(uniq_Identifier = paste(pH, "Run", Run, "Rep",Replicate, "Num", Number, sep='_'))
loop_914 <- as.data.frame(unique(ClearRate_Master.914$uniq_Identifier)) %>% dplyr::rename(ID = "unique(ClearRate_Master.914$uniq_Identifier)")
SlopeTable_914 <- data.frame() # run this before the loop
for(i in 1:nrow(loop_914)){
dat <- ClearRate_Master.914 %>%  filter(uniq_Identifier %in% loop_914[i,])
slope<- summary(lm((dat$Cells_ml) ~ as.numeric(dat$Time._min)))$coef[2,"Estimate"]
SLOPE  <- summary(lm((dat$Cells_ml) ~ as.numeric(dat$Time._min)))$r.squared
pval <- summary(lm((dat$Cells_ml) ~ as.numeric(dat$Time._min)))$coef[2,"Pr(>|t|)"]
mod  <- lm(as.numeric(dat$Time._min) ~ dat$Cells_ml)
norm_assum <- shapiro.test(resid(mod))
shapiro_pval <- norm_assum$p.value
# assign the data table
SLOPE.loop <- data.frame(matrix(nrow = 1, ncol = 5)) # create a new data table
colnames(SLOPE.loop) <- c('pH', 'Replicate', 'slope', 'SLOPE', 'pval') # assign headers
SLOPE.loop$pH        <- gsub("_.*", "\\1", loop_914[i,])
SLOPE.loop$Replicate <- gsub("^(?:[^_]+_){4}([^_]+).*", "\\1", loop_914[i,])
SLOPE.loop$slope     <- slope * 60  # cells per mL per hour
SLOPE.loop$Number    <- gsub("^(?:[^_]+_){6}([^_]+).*", "\\1", loop_914[i,])
SLOPE.loop$SLOPE       <- SLOPE
SLOPE.loop$pval      <- pval
SLOPE.loop$shapiro_pval <- shapiro_pval
# loop additions
df <- data.frame(SLOPE.loop) # name dataframe for this single row
SlopeTable_914 <- rbind(SlopeTable_914,df) # bind to a cumulative list dataframe
# print(SlopeTable_914) # show loop progress in the console
}# outside loo
SLOPE_mod_914 <- aov(lm(slope ~ pH, data= SlopeTable_914))
DF   <- paste( (summary(SLOPE_mod_914)[[1]][["Df"]])[1], (summary(SLOPE_mod_914)[[1]][["Df"]])[2], sep = '/')
Fval <- (summary(SLOPE_mod_914)[[1]][["F value"]])[1]
pval <- (summary(SLOPE_mod_914)[[1]][["Pr(>F)"]])[1]
ggplot(SlopeTable_914, aes(pH , abs(slope) , fill = pH)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pH)) +
scale_fill_manual(values=c("grey50","white")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
scale_x_discrete(labels= c('Elevated (H)', 'Ambient (L)')) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
labs(title = "F1 Scallops: Slope algae cells/time - feeding rate trials 20210914",
y = expression(Slope~"="~absolute~value~"("~Live~algae~cells~mL^{-1}~hour^{-1}~")"),
x = expression(italic(p)*CO[2]~Treatment~"("~mu*atm~")")) +
annotate("text", x=2, y= 25000, size = 4, label = "aov(slope~pH Treatment)") +
annotate("text", x=2, y= 24300, size = 4, label= paste('DF =',DF,'F =', signif(Fval, digits=3), 'p value =', signif(pval, digits=3), sep=" "))
# 20210930 DATA :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
ClearRate_Master[!is.na(ClearRate_Master$Cells_ml),] %>%
dplyr::filter(Date %in% 20210930) %>%
dplyr::mutate(pH_feed = paste(pH, Fed_Unfed, sep='_')) %>%
dplyr::mutate(Time._min = as.numeric(as.character(Time._min))) %>%
ggplot(aes(Time._min, Cells_ml, color=Replicate)) +
geom_point(shape=1, fill = "white", color = "black")+
ggtitle("RAW DATA: F1 Scallops, Clearance Rate 20210930")+
labs(y = expression(Live~algae~cells~"("~cells~mL^{-1}~")"),
x = expression(Time~"("~minutes~")")) +
theme(plot.title= element_text(size =16, face ="bold",
lineheight = 8, vjust=1), aspect.ratio=1)+
stat_smooth(method="lm", se = F) +
theme_bw() +
scale_shape_identity() +
facet_wrap( ~ pH_feed, scales = "free_x" )
# Clearance rate anlaysis for 9/30 data
ClearRate_Master.930       <- ClearRate_Master %>%
dplyr::filter(Date %in% 20210930) %>%
dplyr::mutate(uniq_Identifier = paste(pH, Fed_Unfed, "Run", Run, "Rep",Replicate, "Num", Number, sep='_'))
loop_930 <- as.data.frame(unique(ClearRate_Master.930$uniq_Identifier)) %>% dplyr::rename(ID = "unique(ClearRate_Master.930$uniq_Identifier)")
SlopeTable_930 <- data.frame() # run this before the loop
for(i in 1:nrow(loop_930)){
dat <- ClearRate_Master.930 %>%  filter(uniq_Identifier %in% loop_930[i,])
slope<- summary(lm((dat$Cells_ml) ~ as.numeric(dat$Time._min)))$coef[2,"Estimate"]
SLOPE  <- summary(lm((dat$Cells_ml) ~ as.numeric(dat$Time._min)))$r.squared
pval <- summary(lm((dat$Cells_ml) ~ as.numeric(dat$Time._min)))$coef[2,"Pr(>|t|)"]
mod  <- lm(as.numeric(dat$Time._min) ~ dat$Cells_ml)
norm_assum <- shapiro.test(resid(mod))
shapiro_pval <- norm_assum$p.value
# assign the data table
SLOPE.loop <- data.frame(matrix(nrow = 1, ncol = 6)) # create a new data table
colnames(SLOPE.loop) <- c('pH', 'Replicate', 'Fed_Unfed','slope', 'SLOPE', 'pval') # assign headers
SLOPE.loop$pH        <- gsub("_.*", "\\1", loop_930[i,])
SLOPE.loop$Replicate <- gsub("^(?:[^_]+_){5}([^_]+).*", "\\1", loop_930[i,])
SLOPE.loop$Fed_Unfed <- gsub("^(?:[^_]+_){1}([^_]+).*", "\\1", loop_930[i,])
SLOPE.loop$slope     <- slope * 60  # cells per mL per hour
SLOPE.loop$Number    <- gsub("^(?:[^_]+_){7}([^_]+).*", "\\1", loop_930[i,])
SLOPE.loop$SLOPE       <- SLOPE
SLOPE.loop$pval      <- pval
SLOPE.loop$shapiro_pval <- shapiro_pval
# loop additions
df <- data.frame(SLOPE.loop) # name dataframe for this single row
SlopeTable_930 <- rbind(SlopeTable_930,df) # bind to a cumulative list dataframe
#print(SlopeTable_930) # show loop progress in the console
}# outside loo
SLOPE_mod_930 <- aov(lm(slope ~ pH*Fed_Unfed, data= SlopeTable_930))
summary(SLOPE_mod_930)
DF.930   <- paste( (summary(SLOPE_mod_930)[[1]][["Df"]])[1], (summary(SLOPE_mod_930)[[1]][["Df"]])[2], sep = '/')
Fval.930 <- (summary(SLOPE_mod_930)[[1]][["F value"]])[1]
pval.930 <- (summary(SLOPE_mod_930)[[1]][["Pr(>F)"]])[1]
SlopeTable_930 %>%  mutate(pH_feed = paste(pH, Fed_Unfed, sep = '_')) %>%
ggplot(aes(pH , abs(slope) , fill = pH)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pH)) +
scale_fill_manual(values=c("grey50","white")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
scale_x_discrete(labels= c('Elevated (H)', 'Ambient (L)')) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
labs(title = "F1 Scallops: Slope algae cells/time - feeding rate trials 20210930",
y = expression(Slope~"="~absolute~value~"("~Live~algae~cells~mL^{-1}~hour^{-1}~")"),
x = expression(italic(p)*CO[2]~Treatment~"("~mu*atm~")")) +
facet_wrap(~ Fed_Unfed)
summary(SLOPE_mod_930)
# 20210914 DATA :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
Blank_914_pH7.5 <- (A_914_BlankMeans %>% dplyr::filter(pH == 7.5) %>% dplyr::arrange(desc(Time._min)))$meanBlank_ln_AlgaeLoss[1]
Blank_914_pH8.0 <- (A_914_BlankMeans %>% dplyr::filter(pH == 8.0) %>% dplyr::arrange(desc(Time._min)))$meanBlank_ln_AlgaeLoss[1]
# 20210930 DATA :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
Blank_930_pH7.5 <- (A_930_BlankMeans %>% dplyr::filter(pH == 7.5) %>% dplyr::arrange(desc(Time._min)))$meanBlank_ln_AlgaeLoss[1]
Blank_930_pH8.0 <- (A_930_BlankMeans %>% dplyr::filter(pH == 8.0) %>% dplyr::arrange(desc(Time._min)))$meanBlank_ln_AlgaeLoss[1]
Blank_914_pH7.5
Blank_914_pH8.0
Blank_930_pH7.5
Blank_930_pH8.0
df_total.914              <- data.frame() # start dataframe
for (i in 1:nrow(loop_914)) {
dat <- ClearRate_Master.914 %>%
dplyr::filter(uniq_Identifier == loop_914[i,]) %>%
dplyr::arrange(Time._min)
C0 <- (dat %>% dplyr::filter(Time._min == 0))$Cells_ml[1]
dat2 <- dat %>%
#dplyr::mutate(diff = as.numeric(Time._min) - lag(as.numeric(Time._min), default = first(as.numeric(Time._min)))) %>%
dplyr::filter(Time._min %in% 90) %>%
dplyr::mutate(Blank = if(pH == 7.5) Blank_914_pH7.5 else Blank_914_pH8.0 ) %>%
dplyr::mutate(AlgaeLossRatio = C0 / as.numeric(Cells_ml) ) %>%
dplyr::filter(!AlgaeLossRatio < 1) %>%
dplyr::mutate(ln_AlgaeLossRatio = ln(AlgaeLossRatio)) %>%
# dplyr::mutate(ClearanceRate =  ( (25/1000) / (diff/60)  * # V / t == Volume of the vessel (in Liters as 25 ml / 1000 ml L-1) and t = time in hours as the diff between the interval sin minutes / 60 mins hour-1
#                                   ( ln_AlgaeLossRatio ) / Length.um. ) ) %>%
dplyr::mutate(ClearanceRate_L_hour_mm = ( (25/1000) * # V / t == Volume of the vessel (in Liters as 25 ml / 1000 ml L-1) and t = time in hours as the diff between the interval sin minutes / 60 mins hour-1
(( ln_AlgaeLossRatio /  (as.numeric(Time._min)/60) - Blank))) / (Length.um./1000) ) %>%
dplyr::mutate(Time_period = paste((as.numeric(substr(Time._min,1,1)) -1), "0-", Time._min, sep =''))
dat2OM <- dat2 %>% dplyr::filter(!Time._min == 0)
if (nrow(dat2OM) > 0) {
ClearRate.table           <- data.frame(matrix(nrow = nrow(dat2OM), ncol = 9)) # create dataframe to save cumunalitively during for loop
colnames(ClearRate.table) <- c('Date', 'ID', 'pH', 'Replicate', 'Num','Run','Time_period', 'AlgaeLossRatio', 'ClearanceRate_L_hour_mm') # names for comuns in the for loop
ClearRate.table$Date                       <- dat2OM$Date
ClearRate.table$ID                         <- loop_914[i,]
ClearRate.table$pH                         <- gsub("_.*", "\\1", ClearRate.table$ID)
ClearRate.table$Replicate                  <- gsub("^(?:[^_]+_){4}([^_]+).*", "\\1", ClearRate.table$ID)
ClearRate.table$Num                        <- gsub("^(?:[^_]+_){6}([^_]+).*", "\\1", ClearRate.table$ID)
ClearRate.table$Run                        <- gsub("^(?:[^_]+_){2}([^_]+).*", "\\1", ClearRate.table$ID)
ClearRate.table$Time_period                <- paste((as.numeric(substr(dat2OM$Time._min,1,1)) -1), "0-", dat2OM$Time._min, sep ='')
ClearRate.table$AlgaeLossRatio             <- dat2OM$AlgaeLossRatio
ClearRate.table$ClearanceRate_L_hour_mm <- dat2OM$ClearanceRate_L_hour_mm
df       <- data.frame(ClearRate.table) # name dataframe for this single row
df_total.914 <- rbind(df_total.914,df) #bind to a cumulative list dataframe
print(df_total.914) # print to monitor progress
}
else {}
}
ClearRates_914_Means <- df_total.914 %>%
#dplyr::filter(!ClearanceRate_L_hour_meter %in% '-Inf') %>%
dplyr::group_by(pH) %>%
dplyr::summarise(
meanCR = mean(ClearanceRate_L_hour_mm),
sdCR   = sd(ClearanceRate_L_hour_mm),
seCR   = sd(ClearanceRate_L_hour_mm) / sqrt(length(ClearanceRate_L_hour_mm)),
n = n()) %>%
na.omit()
ClearRates_914_Means
print(ClearRates_914_Means)
library(kableExtra)
library(latex2exp)
library(pander)
library(performance)
mod914CR <- aov(lm(ClearanceRate_L_hour_mm~ pH , data = (df_total.914 %>%  dplyr::filter(!ClearanceRate_L_hour_mm  < 0)) ) )
pander(summary(mod914CR), style='rmarkdown')
check_model(mod914CR) # observe the diagnostics of the model
shapiro.test(residuals(mod914CR)) # non normal
leveneTest(mod914CR) # good
ClearRates_914_Means %>%
#dplyr::filter(!Time_period %in% c('40-50', '50-60')) %>%
ggplot(aes(x=pH , y=meanCR, fill = pH)) +
geom_bar(position=position_dodge(), aes(y=meanCR), stat="identity", alpha=0.5) +
scale_fill_manual("Treatment", values = c("8" = "grey50", "7.5" = "black")) +
geom_errorbar(position=position_dodge(width=0.9), aes(ymin=meanCR+seCR, ymax=meanCR+seCR), width=0.2, colour="black", alpha=0.9, size=0.2) +
geom_linerange(aes(ymin = meanCR, ymax = meanCR+seCR)) +
geom_point(position=position_dodge(width=0.9), aes(y=meanCR)) +
theme_classic() +
ggtitle("Clearance Rate F1 Scallops 20210914 (90-minute trial)") # +
ClearRates_914_Means %>%
#dplyr::filter(!Time_period %in% c('40-50', '50-60')) %>%
ggplot(aes(x=pH , y=meanCR, fill = pH)) +
geom_bar(position=position_dodge(), aes(y=meanCR), stat="identity", alpha=0.5) +
scale_fill_manual("Treatment", values = c("8" = "grey50", "7.5" = "black")) +
geom_errorbar(position=position_dodge(width=0.9), aes(ymin=meanCR+seCR, ymax=meanCR+seCR), width=0.2, colour="black", alpha=0.9, size=0.2) +
geom_linerange(aes(ymin = meanCR, ymax = meanCR+seCR)) +
geom_point(position=position_dodge(width=0.9), aes(y=meanCR)) +
theme_classic() +
ggtitle("Clearance Rate F1 Scallops 20210914 (0-90-minutes)") # +
df_total.914 %>%
#dplyr::filter(!ClearanceRate_L_hour_mm %in% '-Inf') %>%
#dplyr::filter(!Time_period %in% c('40-50', '50-60')) %>%
ggplot(aes(pH , ClearanceRate_L_hour_mm , fill = pH)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pH)) +
scale_fill_manual(values=c("black", "grey50")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
# labs(title = "F1 Scallops: Slope algae cells/time - feeding rate trials 20210930",
#      y = expression(Slope~"="~absolute~value~"("~Live~algae~cells~mL^{-1}~hour^{-1}~")"),
#      x = expression(italic(p)*CO[2]~Treatment~"("~mu*atm~")")) +
ggtitle("Clearance Rate, F1 Scallops 20210914 (0-90-minutes)")
df_total.930              <- data.frame() # start dataframe
for (i in 1:nrow(loop_930)) {
dat <- ClearRate_Master.930 %>%
dplyr::filter(uniq_Identifier == loop_930[i,]) %>%
dplyr::arrange(Time._min)
C0 <- (dat %>% dplyr::filter(Time._min == 0))$Cells_ml[1]
dat2 <- dat %>%
#dplyr::mutate(diff = as.numeric(Time._min) - lag(as.numeric(Time._min), default = first(as.numeric(Time._min)))) %>%
dplyr::filter(Time._min %in% 60) %>%
dplyr::mutate(Blank = if(pH == 7.5) Blank_930_pH7.5 else Blank_930_pH8.0 ) %>%
dplyr::mutate(AlgaeLossRatio = C0 / as.numeric(Cells_ml) ) %>%
dplyr::filter(!AlgaeLossRatio < 1) %>%
dplyr::mutate(ln_AlgaeLossRatio = ln(AlgaeLossRatio)) %>%
# dplyr::mutate(ClearanceRate =  ( (25/1000) / (diff/60)  * # V / t == Volume of the vessel (in Liters as 25 ml / 1000 ml L-1) and t = time in hours as the diff between the interval sin minutes / 60 mins hour-1
#                                   ( ln_AlgaeLossRatio ) / Length.um. ) ) %>%
dplyr::mutate(ClearanceRate_L_hour_mm = ( (25/1000) * # V / t == Volume of the vessel (in Liters as 25 ml / 1000 ml L-1) and t = time in hours as the diff between the interval sin minutes / 60 mins hour-1
(( ln_AlgaeLossRatio /  (as.numeric(Time._min)/60) - Blank))) / (Length.um./1000) ) %>%
dplyr::mutate(Time_period = paste((as.numeric(substr(Time._min,1,1)) -1), "0-", Time._min, sep =''))
# dat2OM <- dat2 %>% dplyr::filter(!Time._min == 0)
if (nrow(dat2) > 0) {
ClearRate.table           <- data.frame(matrix(nrow = nrow(dat2), ncol = 10)) # create dataframe to save cumunalitively during for loop
colnames(ClearRate.table) <- c('Date', 'ID', 'pH', 'Fed_Unfed', 'Replicate', 'Num','Run','Time_period', 'AlgaeLossRatio', 'ClearanceRate_L_hour_mm') # names for comuns in the for loop
ClearRate.table$Date                       <- dat2$Date
ClearRate.table$ID                         <- loop_930[i,]
ClearRate.table$pH                         <- gsub("_.*", "\\1", ClearRate.table$ID)
ClearRate.table$Fed_Unfed                  <- gsub("^(?:[^_]+_){1}([^_]+).*", "\\1", ClearRate.table$ID)
ClearRate.table$Replicate                  <- gsub("^(?:[^_]+_){5}([^_]+).*", "\\1", ClearRate.table$ID)
ClearRate.table$Num                        <- gsub("^(?:[^_]+_){7}([^_]+).*", "\\1", ClearRate.table$ID)
ClearRate.table$Run                        <- gsub("^(?:[^_]+_){3}([^_]+).*", "\\1", ClearRate.table$ID)
ClearRate.table$Time_period                <- paste((as.numeric(substr(dat2$Time._min,1,1)) -1), "0-", dat2$Time._min, sep ='')
ClearRate.table$AlgaeLossRatio             <- dat2$AlgaeLossRatio
ClearRate.table$ClearanceRate_L_hour_mm    <- dat2$ClearanceRate_L_hour_mm
df       <- data.frame(ClearRate.table) # name dataframe for this single row
df_total.930 <- rbind(df_total.930,df) #bind to a cumulative list dataframe
print(df_total.930) # print to monitor progress
}
else {}
}
ClearRates_930_Means <- df_total.930 %>%
dplyr::filter(!ClearanceRate_L_hour_mm  < 0) %>%
dplyr::group_by(pH, Fed_Unfed, Time_period) %>%
dplyr::summarise(
meanCR = mean(ClearanceRate_L_hour_mm),
sdCR   = sd(ClearanceRate_L_hour_mm),
seCR   = sd(ClearanceRate_L_hour_mm) / sqrt(length(ClearanceRate_L_hour_mm)),
n = n()) %>%
na.omit()
ClearRates_930_Means
mod930CR <- aov(lm(ClearanceRate_L_hour_mm~ pH * Fed_Unfed, data = (df_total.930 %>%  dplyr::filter(!ClearanceRate_L_hour_mm  < 0)) ) )
pander(summary(mod930CR), style='rmarkdown')
check_model(mod930CR) # observe the diagnostics of the model
shapiro.test(residuals(mod930CR)) # non normal
leveneTest(mod930CR) # good
summary(lmer(ClearanceRate_L_hour_mm~ pH * Fed_Unfed + (1|Replicate), data = (df_total.930 %>%  dplyr::filter(!ClearanceRate_L_hour_mm  < 0)) ) )
ClearRates_930_Means$pH_feed <- paste(ClearRates_930_Means$pH, ClearRates_930_Means$Fed_Unfed, sep='_')
ClearRates_930_Means %>%
#dplyr::filter(!Time_period %in% c('40-50', '50-60')) %>%
ggplot(aes(x=pH , y=meanCR, fill = pH)) +
geom_bar(position=position_dodge(), aes(y=meanCR), stat="identity", alpha=0.5) +
scale_fill_manual(values=c("black", "grey50")) +
geom_errorbar(position=position_dodge(width=0.9), aes(ymin=meanCR+seCR, ymax=meanCR+seCR), width=0.2, colour="black", alpha=0.9, size=0.2) +
geom_linerange(aes(ymin = meanCR, ymax = meanCR+seCR)) +
geom_point(position=position_dodge(width=0.9), aes(y=meanCR)) +
theme_classic() +
ggtitle("Clearance Rate F1 Scallops 20210930") +
facet_wrap(~ Fed_Unfed)
df_total.930 %>%
dplyr::filter(!ClearanceRate_L_hour_mm  < 0) %>%
#dplyr::filter(!ClearanceRate_L_hour_mm %in% '-Inf') %>%
#dplyr::filter(!Time_period %in% c('40-50', '50-60')) %>%
ggplot(aes(pH , ClearanceRate_L_hour_mm , fill = pH)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pH)) +
scale_fill_manual(values=c("black", "grey50")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
# labs(title = "F1 Scallops: Slope algae cells/time - feeding rate trials 20210930",
#      y = expression(Slope~"="~absolute~value~"("~Live~algae~cells~mL^{-1}~hour^{-1}~")"),
#      x = expression(italic(p)*CO[2]~Treatment~"("~mu*atm~")")) +
ggtitle("Clearance Rate F1 Scallops 20210930") +
facet_wrap(~ Fed_Unfed)
